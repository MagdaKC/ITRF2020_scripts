#  RUN_SERIES_DAILY2005

#

SCR_NAME=RUN_DATA_CRD2TDF_MLTSAT_EDC_PS_CRD2
+ SCR_NAME=RUN_DATA_CRD2TDF_MLTSAT_EDC_PS_CRD2
SCR_PARM=0
+ SCR_PARM=0
SCR_LIST="CASE ETA_IN GROUP JOB_FILE"
+ SCR_LIST='CASE ETA_IN GROUP JOB_FILE'
SCR_VERS=220711.0

+ SCR_VERS=220711.0
SCR_DBG="#"
+ SCR_DBG='#'
export SCR_DBG

+ export SCR_DBG
if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi

expr $#
+ expr 0
+ [ 0 -lt 0 ]
Date=`date +%y%m%d`

date +%y%m%d
+ date +%y%m%d
+ Date=240330
DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`

date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:45:38'
echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  RUN_DATA_CRD2TDF_MLTSAT_EDC_PS_CRD2  '
 #  RUN_DATA_CRD2TDF_MLTSAT_EDC_PS_CRD2  
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 220711.0 '
 #  Version 220711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:45:38 '
 #  Run Date DATE: 03/30/24  TIME: 13:45:38 
echo " # "


+ echo ' # '
 # 
CASE=CRD2TDF

+ CASE=CRD2TDF
#exec > /umbc/epavlis/data01/LOCAL/magdak/tmp/magda/RUN_SERIES_IERS_OPS2005.${CASE}.$Date.$$.log 2>&1

MAIN_PATH=/umbc/epavlis/data01/LOCAL/magdak
+ MAIN_PATH=/umbc/epavlis/data01/LOCAL/magdak
SCRIPTS=/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT
+ SCRIPTS=/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT
DISK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS

+ DISK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
TDF2GDYN=tdf0901p0_i64_sun_RM=8.x

+ TDF2GDYN=tdf0901p0_i64_sun_RM=8.x
export TDF2GDYN DISK SCRIPTS MAIN_PATH


+ export TDF2GDYN DISK SCRIPTS MAIN_PATH
cd /umbc/epavlis/data01/LOCAL/magdak/tmp/magda
+ cd /umbc/epavlis/data01/LOCAL/magdak/tmp/magda
wkTmp=$$
+ wkTmp=17778
mkdir ${CASE}${wkTmp}
+ mkdir CRD2TDF17778
cd ${CASE}${wkTmp}
+ cd CRD2TDF17778
CDIR=/umbc/epavlis/data01/LOCAL/magdak/tmp/magda/${CASE}${wkTmp}
+ CDIR=/umbc/epavlis/data01/LOCAL/magdak/tmp/magda/CRD2TDF17778
echo ${CASE}${wkTmp} > /umbc/epavlis/data01/LOCAL/magdak/tmp/magda/${CASE}_wDIR_$Date

+ echo CRD2TDF17778
+ 1> /umbc/epavlis/data01/LOCAL/magdak/tmp/magda/CRD2TDF_wDIR_240330
DIR_2_TAR=${CASE}_wDIR_$Date

+ DIR_2_TAR=CRD2TDF_wDIR_240330
export DIR_2_TAR CDIR


+ export DIR_2_TAR CDIR
export CDIR CASE 


+ export CDIR CASE
#--------------------------------------
#  Start the process
#--------------------------------------

CASED=DAILY_v180

+ CASED=DAILY_v180
#
#  Read year, doy, date and arc-name for the old, current and future arcs:
#

read OYEAR ODOY Date_OLD_ARC OLD < $MAIN_PATH/INFILES/INF_OPS_ITRF2020/ARC_SETUP_OLD.$CASED
+ read OYEAR ODOY Date_OLD_ARC OLD
+ 0< /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_ITRF2020/ARC_SETUP_OLD.DAILY_v180
read NYEAR NDOY Date_NEW_ARC ARC < $MAIN_PATH/INFILES/INF_OPS_ITRF2020/ARC_SETUP_NEW.$CASED
+ read NYEAR NDOY Date_NEW_ARC ARC
+ 0< /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_ITRF2020/ARC_SETUP_NEW.DAILY_v180
read XYEAR XDOY Date_NXT_ARC NXT < $MAIN_PATH/INFILES/INF_OPS_ITRF2020/ARC_SETUP_NXT.$CASED


+ read XYEAR XDOY Date_NXT_ARC NXT
+ 0< /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_ITRF2020/ARC_SETUP_NXT.DAILY_v180
export NYEAR Date_NEW_ARC  Date_OLD_ARC

+ export NYEAR Date_NEW_ARC Date_OLD_ARC
#--------------------------------------
#  Get the SLR CRD data from CDDIS or EDC:
#--------------------------------------
#

YY=`echo $NYEAR | cut -c3-4`
echo $NYEAR | cut -c3-4
+ echo 2024
+ cut -c3-4
+ YY=24
#
##  For analyzing past arcs, do not need to re-get the QL data! But we will need this for the operational script!!!
#

year=$NYEAR
+ year=2024
OLD_ARC=${OYEAR}${Date_OLD_ARC}
+ OLD_ARC=2024240322
NEW_ARC=${NYEAR}${Date_NEW_ARC}


+ NEW_ARC=2024240323
mkdir /tmp/getSLR$$
+ mkdir /tmp/getSLR17778
cd  /tmp/getSLR$$

+ cd /tmp/getSLR17778
#IF DF for 9 will be ready
#20180920
###210122 
#########
$SCRIPTS/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2 $year MLTSAT MLTSAT MLTSAT $YY 9 $MAIN_PATH/MISSIONS $OLD_ARC $NEW_ARC
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2 2024 MLTSAT MLTSAT MLTSAT 24 9 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS 2024240322 2024240323

#     QL_2_TDF_ARC 
  

SCR_NAME=MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2
+ SCR_NAME=MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2
SCR_PARM=9
+ SCR_PARM=9
SCR_LIST="Year sat SAT_DIR SUFX YY TYP disk OLD_ARC NEW_ARC"
+ SCR_LIST='Year sat SAT_DIR SUFX YY TYP disk OLD_ARC NEW_ARC'
SCR_VERS=220711.0
+ SCR_VERS=220711.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi
expr $#
++ expr 9
+ '[' 9 -lt 9 ']'

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:45:38'
YYYY=`date '+%Y'`
date '+%Y'
++ date +%Y
+ YYYY=2024
MM=`date '+%m'`
date '+%m'
++ date +%m
+ MM=03

echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2 2024 MLTSAT MLTSAT MLTSAT 24 9 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS 2024240322 2024240323 '
 #  MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2 2024 MLTSAT MLTSAT MLTSAT 24 9 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS 2024240322 2024240323 
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 220711.0 '
 #  Version 220711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:45:38 '
 #  Run Date DATE: 03/30/24  TIME: 13:45:38 
echo " # "
+ echo ' # '
 # 


Year=${1:-2002}		#Year of Sat data
+ Year=2024
sat=${2:-lageos1}	#name of satelite
+ sat=MLTSAT
SAT_DIR=${3:-GISL1}	#name of satelite
+ SAT_DIR=MLTSAT
SUFX=${4:-lag}
+ SUFX=MLTSAT
YY=${5:-02}
+ YY=24
TYP=${6:-2}
+ TYP=9
disk=${7:-DISK}      #Hard disk for storage of files
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS
OLD_ARC=${8:-}
+ OLD_ARC=2024240322
NEW_ARC=${9:-}
+ NEW_ARC=2024240323

Date=`date +%y%m%d`
date +%y%m%d
++ date +%y%m%d
+ Date=240330


#######
#      Get the CRD data from CDDIS
#

#cd $disk/$SAT_DIR/d_base/data/CRD

#mkdir temp$$
#cd temp$$

PYear=` expr $Year - 1 `
 expr $Year - 1 
++ expr 2024 - 1
+ PYear=2023
NYear=` expr $Year + 1 `
 expr $Year + 1 
++ expr 2024 + 1
+ NYear=2025

# Year before year of request

echo $PYear > tmpPY
+ echo 2023
PY2=` cut -c3-4 tmpPY `
 cut -c3-4 tmpPY 
++ cut -c3-4 tmpPY
+ PY2=23

# Year of request

echo $Year > tmpCY
+ echo 2024
CY2=` cut -c3-4 tmpCY `
 cut -c3-4 tmpCY 
++ cut -c3-4 tmpCY
+ CY2=24

# Year after year of request

echo $NYear > tmpNY
+ echo 2025
NY2=` cut -c3-4 tmpNY `
 cut -c3-4 tmpNY 
++ cut -c3-4 tmpNY
+ NY2=25

# True year when request is made 

echo $Date > tmpDate
+ echo 240330
NY3=` cut -c1-2 tmpDate `
 cut -c1-2 tmpDate 
++ cut -c1-2 tmpDate
+ NY3=24

if [ "$NY3" -lt "50" ]; then

   CURyear=20${NY3}

elif [ "$NY3" -gt "50" ]; then

   CURyear=19${NY3}

fi
+ '[' 24 -lt 50 ']'
+ CURyear=2024

\rm addNEXTyear
+ rm addNEXTyear
rm: cannot remove ‘addNEXTyear’: No such file or directory






#ftp 128.183.103.97       < /tmp/input2

#ftp -p cddis.gsfc.nasa.gov < input2 > output2
#/usr/bin/ftp -p cddis.gsfc.nasa.gov < input2 > output2
#/usr/bin/ftp -p cddis.nasa.gov < input2 > output2



YEARC=$(date +'%Y')
++ date +%Y
+ YEARC=2024
MONTHC=$(date +'%m')
++ date +%m
+ MONTHC=03

while read  sat SAT_DIR_S
do
cd $disk/$SAT_DIR/d_base/data/CRD
mkdir temp$$
mkdir $disk/$SAT_DIR/d_base/data/CRD/temp$$/$SAT_DIR_S
cd  $disk/$SAT_DIR/d_base/data/CRD/temp$$/$SAT_DIR_S

cat >> input1 <<EOF 
bin
 

cd /pub/slr/data/npt_crd_v2/SAT

prompt

cd pppp
mget SAT_pppp12.np2

cd /pub/slr/data/npt_crd_v2/SAT/zzzz
mget SAT_zzzz01.np2

cd /pub/slr/data/npt_crd_v2/SAT/yyyy
mget SAT_yyyy01.np2
mget SAT_yyyy02.np2
mget SAT_yyyy03.np2
mget SAT_yyyy04.np2
mget SAT_yyyy05.np2
mget SAT_yyyy06.np2
mget SAT_yyyy07.np2
mget SAT_yyyy08.np2
mget SAT_yyyy09.np2
mget SAT_yyyy10.np2
mget SAT_yyyy12.np2
mget SAT_yyyy11.np2
mget SAT_yyyyMONTHC??.np2


EOF


sed -e "1,\$s/PP/$PY2/g" -e "1,\$s/pppp/$PYear/g" -e "1,\$s/yyyy/$Year/g"  -e "1,\$s/zzzz/$NYear/g" -e "1,\$s/SAT/$sat/g" -e "1,\$s/MONTHC/$MONTHC/g" input1 > input2
cp /umbc/research/magdak/.netrc_NO_EDC_LOG /umbc/research/magdak/.netrc
/usr/bin/ftp -p edc.dgfi.tum.de  < input2 > output2
cp /umbc/research/magdak/.netrc_EDC_LOG  /umbc/research/magdak/.netrc


rm ${sat}_${Year}${MONTHC}.np2
cat ${sat}_${Year}${MONTHC}??.np2 > year.M1
cat ${sat}_${Year}??.np2 >> year.M1
cat ${sat}_${PYear}12.np2 >> year.M1
cat ${sat}_${NYear}01.np2 >> year.M1
cp  year.M1 ../.
#done < /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/MLTSAT

cd $disk/$SAT_DIR/d_base/data/CRD/temp$$

#exit 200201
sed "s/^H/h/g"  year.M1 >  year.M1A
sed "s/h9H1/h1/" year.M1A > year.M1C

grep -v -e "h9" -e "^30" year.M1C > year.M1B
grep -v -e "h9" -e "^30"  year.00C >year.00B

cat year.M1B year.00B  > year.ALL2
sed "s/^C/c/" year.ALL2 > year.ALL

grep "^h2" year.ALL |cut -c1-18|sort -u  -o strng1

cp year.ALL  crddata.$NEW_ARC.$SAT_DIR_S

#####
printf "h9" > H9
cat H9 >>  crddata.$NEW_ARC.$SAT_DIR_S

#exit 0
FILE="crddata.$NEW_ARC.$SAT_DIR_S"
#compress -f crddata.$NEW_ARC.$SAT_DIR
 gzip -9  -f crddata.$NEW_ARC.$SAT_DIR_S

#mv crddata.$NEW_ARC.${SAT_DIR}.Z ../crddata.$NEW_ARC.${SAT_DIR}.Z
rm ../crddata.$NEW_ARC.${SAT_DIR_S}.gz
cp crddata.$NEW_ARC.${SAT_DIR_S}.gz  ../crddata.$NEW_ARC.${SAT_DIR_S}.gz 
cp year.ALL0 year.ALL ../.
chmod 777 ../crddata.$NEW_ARC.${SAT_DIR_S}.gz 
cd ..
pwd
OLD_FILE="crddata.$OLD_ARC.$SAT_DIR_S"

#printf "rm $disk/$SAT_DIR/d_base/data/CRD/crddata.${OLD_ARC}.${SAT_DIR}.gz  \n" >> $CDIR/clean_list
#printf "rm $disk/$SAT_DIR/d_base/data/MRT2/crddata.${OLD_ARC}.${SAT_DIR}.mr2.gz  \n" >> $CDIR/clean_list
#printf "rm $disk/$SAT_DIR/d_base/data/TDF/crddata.${OLD_ARC}.${SAT_DIR}*.tdf.gz  \n" >> $CDIR/clean_list


FLAG=NO

#sum $FILE.Z > new_sum
sum $FILE.gz  > new_sum_mkc
#sum $OLD_FILE.Z > old_sum
sum $OLD_FILE.gz  > old_sum_mkc

#read nbts nblks nfl < new_sum
read nbts nblks nfl < new_sum_mkc
#read obts oblks ofl < old_sum
read obts oblks ofl < old_sum_mkc

if ["$nblks" > "$oblks" ]; then

   \rm $OLD_FILE.gz 
   FLAG=OK

else

   echo " OLD QL file: " > 2mail
   #cat old_sum >> 2mail
   cat old_sum_mkc >> 2mail

   echo "  "
   echo " NEW QL file: " >> 2mail
   #cat new_sum >> 2mail
   cat new_sum_mkc >> 2mail

#   mail -m URGENT_from_QL_2_TDF_ARC -t epavlis@umbc.edu < 2mail

   \rm 2mail

fi

####20180728 
\rm -r temp$$

export FLAG OLD_FILE

echo ${FILE}
echo ${SAT_DIR}

##exit 222

#######
#      QLB
#

pwd
#uncompress -f  $disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR}.gz  >  /$disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR}
gzip -d -f  $disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR_S}.gz  >  /$disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR_S}
sed -e "s/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 0 2 0/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 2 2 0/" /$disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR_S}  > /$disk/$SAT_DIR/d_base/data/CRD/t0
cp /$disk/$SAT_DIR/d_base/data/CRD/t0 /$disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR_S}
#$MAIN_PATH/EXECUTABLES/CRD2MRT_090803.x -i /$disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR} -o /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR}.mr2 
rm /$disk/$SAT_DIR/d_base/data/MRT2/crddata
### (before 150914) $MAIN_PATH/EXECUTABLES/CRD2MRT_090806.x -i /$disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR} -o /$disk/$SAT_DIR/d_base/data/MRT2/crddata
#CRD1
#$MAIN_PATH/EXECUTABLES/CRD2MRT_150914.x -i /$disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR_S} -o /$disk/$SAT_DIR/d_base/data/MRT2/crddata 
####221203 /umbc/epavlis/data01/LOCAL/magdak/source/CRD2MRT_v2.00_mkc_210107/CRD_v2.0_210111/CRD2MRT_X_210111_2.x -i /$disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR_S} -o /$disk/$SAT_DIR/d_base/data/MRT2/crddata 
#NEW 221204
/umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/CRD2_2_MRT_X_221204.x -i /$disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR_S} -o /$disk/$SAT_DIR/d_base/data/MRT2/crddata
###NEW mkc 150915
#grep -v -e "Convert CRD" -e "crd_in" -e "cstg_out" o.CRD2MRT_150914_$sat > o.CRD2MRT_150914_SCALE_$sat
#_file=o.CRD2MRT_150914_SCALE_$sat
###### 
if [ "$SAT_DIR_S" = "GISL1" ]; then
   no=7603901
#grep -v "241111-20030" /$disk/$SAT_DIR/d_base/data/MRT2/crddata > /$disk/$SAT_DIR/d_base/data/MRT2/tt
#   cp /$disk/$SAT_DIR/d_base/data/MRT2/tt /$disk/$SAT_DIR/d_base/data/MRT2/crddata
elif [ "$SAT_DIR_S" = "GISL2" ]; then
   no=9207002
grep -v "25230" /$disk/$SAT_DIR/d_base/data/MRT2/crddata > /$disk/$SAT_DIR/d_base/data/MRT2/tt
cp /$disk/$SAT_DIR/d_base/data/MRT2/tt /$disk/$SAT_DIR/d_base/data/MRT2/crddata
elif [ "$SAT_DIR_S" = "ETA1" ]; then
   no=8900103
elif [ "$SAT_DIR_S" = "ETA2" ]; then
   no=8903903
elif [ "$SAT_DIR_S" = "STARL" ]; then
   no=7501001
elif [ "$SAT_DIR_S" = "AJISI" ]; then
   no=8606101
elif [ "$SAT_DIR_S" = "LARES" ]; then
    no=1200601
     elif [ "$SAT_DIR_S" = "LARES2" ]; then
              no=2208001
elif [ "$SAT_DIR_S" = "BLITS" ]; then
	       no=0904907
elif [ "$SAT_DIR_S" = "STELLA" ]; then
	       no=9306102
#   no=1904907
fi
gzip -9  -f  $disk/$SAT_DIR/d_base/data/CRD/crddata.$NEW_ARC.${SAT_DIR_S}.gz 
if [ "$SAT_DIR" = "BLITS" ]; then
sed -e "s/ 9/09/"  /$disk/$SAT_DIR/d_base/data/MRT2/crddata > /$disk/$SAT_DIR/d_base/data/MRT2/crddata9
cp /$disk/$SAT_DIR/d_base/data/MRT2/crddata9 /$disk/$SAT_DIR/d_base/data/MRT2/crddata
fi
grep "^$no" /$disk/$SAT_DIR/d_base/data/MRT2/crddata > /$disk/$SAT_DIR/d_base/data/MRT2/crddata2

#exit 222
#sort -u /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR}.mr2 > /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR}.mr2S

sort -u /$disk/$SAT_DIR/d_base/data/MRT2/crddata2 > /$disk/$SAT_DIR/d_base/data/MRT2/crddata2S
#uniq  -w43  /$disk/$SAT_DIR/d_base/data/MRT2/crddata2 > /$disk/$SAT_DIR/d_base/data/MRT2/crddata2S
#cp /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR}.mr2S /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR}.mr2
#cp /$disk/$SAT_DIR/d_base/data/MRT2/crddata2S /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR}.mr2

#compress -f /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR}.mr2 

#######
#      QLB
#

#$SCRIPTS/QLNP_2_TDFINP_CRD  $SAT_DIR_S $disk > o.QLNP_2_TDFINP 2>&1
$SCRIPTS/QLNP_2_TDFINP_CRD  MLTSAT $disk > o.QLNP_2_TDFINP 2>&1
cp o.QLNP_2_TDFINP /tmp/magdak/o.QLNP_2_TDFINP_$SAT
sort -u /$disk/$SAT_DIR/d_base/data/MRT2/crddata2S > /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS
#$SCRIPTS/SORT_DATA_BY_RELEASE_FLAG_P2 $disk $SAT_DIR
$SCRIPTS/SORT_DATA_BY_RELEASE_FLAG_P2 $disk MLTSAT
uniq -w43 /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS > /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SSA
uniq -w43 /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SSA > /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SSS

cp /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SSS /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR_S}.mr2
grep -v "\-10030" /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR_S}.mr2 > t10
grep -v "\-1\-130" t10 > t0
cp t0 /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR_S}.mr2
rm -f /$disk/$SAT_DIR/d_base/data/MRT2/crddata2S*
#compress -f $disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR}.mr2 
gzip -9  -f $disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR_S}.mr2 

#rm /$disk/$SAT_DIR/d_base/data/MRT2/${YY}.${SAT_DIR_S}.mr2.Z
#ln -s /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR_S}.mr2.Z  /$disk/$SAT_DIR/d_base/data/MRT2/${YY}.${SAT_DIR_S}.mr2.Z
#rm /$disk/$SAT_DIR/d_base/data/MRT2/${YY}.${SAT_DIR_S}_MERITX.mr2.Z
#ln -s /$disk/$SAT_DIR/d_base/data/MRT2/crddata.$NEW_ARC.${SAT_DIR_S}.mr2.Z  /$disk/$SAT_DIR/d_base/data/MRT2/${YY}.${SAT_DIR_S}_MERITX.mr2.Z
#######
#      TDF
#

if [ "$SAT_DIR_S" = "GISL1" ]; then

   #DSK=$DISK/MISSIONS
   DSK=$DISK

   SV=L1

elif [ "$SAT_DIR_S" = "GISL2" ]; then

   #DSK=$DISK/MISSIONS
   DSK=$DISK

   SV=L2

elif [ "$SAT_DIR_S" = "ETA1" ]; then

   DSK=$DISK

   SV=E1

elif [ "$SAT_DIR_S" = "ETA2" ]; then

   DSK=$DISK

   SV=E2

elif [ "$SAT_DIR_S" = "CHAMP" ]; then

   DSK=$DISK/MISSIONS

   SV=CH

elif [ "$SAT_DIR_S" = "ERS1" ]; then

   DSK=$DISK/MISSIONS

   SV=ERS

elif [ "$SAT_DIR_S" = "AJISI" ]; then

   DSK=$DISK

   SV=AJI

elif [ "$SAT_DIR_S" = "STARL" ]; then

   DSK=$DISK

   SV=STR

elif [ "$SAT_DIR_S" = "BLITS" ]; then

   DSK=$DISK

   SV=BLITS
      elif [ "$SAT_DIR_S" = "LARES" ]; then
       DSK=$DISK
       SV=LARES
      elif [ "$SAT_DIR_S" = "LARES2" ]; then
       DSK=$DISK
       SV=LARES2
      elif [ "$SAT_DIR_S" = "STELLA" ]; then
       DSK=$DISK
       SV=STELLA
elif [ "$SAT_DIR_S" = "TP" ]; then

   DSK=$DISK/MISSIONS

   SV=TOP

fi
TAG=$SV


FILEQL="qldata.$NEW_ARC.${SAT_DIR_S}_$YY.tdf"
export YY SV FILEQL SAT_DIR_S

#$SCRIPTS/TDF_2_GDNBIN_CRD_P2_MLTSAT_EDC $TYP $DSK MLTSAT $FILE.mr2 ${FILE}_$YY.tdf
$SCRIPTS/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2 $TYP $DSK MLTSAT $FILE.mr2 ${FILE}_$YY.tdf
#exit 20200212
done < /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/MLTSAT
+ read sat SAT_DIR_S
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ mkdir temp17794
+ mkdir /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/GISL1
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/GISL1
+ cat
+ sed -e '1,$s/PP/23/g' -e '1,$s/pppp/2023/g' -e '1,$s/yyyy/2024/g' -e '1,$s/zzzz/2025/g' -e '1,$s/SAT/lageos1/g' -e '1,$s/MONTHC/03/g' input1
+ cp /umbc/research/magdak/.netrc_NO_EDC_LOG /umbc/research/magdak/.netrc
+ /usr/bin/ftp -p edc.dgfi.tum.de
+ cp /umbc/research/magdak/.netrc_EDC_LOG /umbc/research/magdak/.netrc
+ rm lageos1_202403.np2
rm: cannot remove ‘lageos1_202403.np2’: No such file or directory
+ cat 'lageos1_202403??.np2'
cat: lageos1_202403??.np2: No such file or directory
+ cat 'lageos1_2024??.np2'
cat: lageos1_2024??.np2: No such file or directory
+ cat lageos1_202312.np2
cat: lageos1_202312.np2: No such file or directory
+ cat lageos1_202501.np2
cat: lageos1_202501.np2: No such file or directory
+ cp year.M1 ../.
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794
+ sed 's/^H/h/g' year.M1
+ sed s/h9H1/h1/ year.M1A
+ grep -v -e h9 -e '^30' year.M1C
+ grep -v -e h9 -e '^30' year.00C
grep: year.00C: No such file or directory
+ cat year.M1B year.00B
+ sed 's/^C/c/' year.ALL2
+ grep '^h2' year.ALL
+ sort -u -o strng1
+ cut -c1-18
+ cp year.ALL crddata.2024240323.GISL1
+ printf h9
+ cat H9
+ FILE=crddata.2024240323.GISL1
+ gzip -9 -f crddata.2024240323.GISL1
+ rm ../crddata.2024240323.GISL1.gz
rm: cannot remove ‘../crddata.2024240323.GISL1.gz’: No such file or directory
+ cp crddata.2024240323.GISL1.gz ../crddata.2024240323.GISL1.gz
+ cp year.ALL0 year.ALL ../.
cp: cannot stat ‘year.ALL0’: No such file or directory
+ chmod 777 ../crddata.2024240323.GISL1.gz
+ cd ..
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ OLD_FILE=crddata.2024240322.GISL1
+ FLAG=NO
+ sum crddata.2024240323.GISL1.gz
+ sum crddata.2024240322.GISL1.gz
sum: crddata.2024240322.GISL1.gz: No such file or directory
+ read nbts nblks nfl
+ read obts oblks ofl
+ '[1' ']'
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2: line 212: : No such file or directory
+ echo ' OLD QL file: '
+ cat old_sum_mkc
+ echo '  '
  
+ echo ' NEW QL file: '
+ cat new_sum_mkc
+ rm 2mail
+ rm -r temp17794
+ export FLAG OLD_FILE
+ echo crddata.2024240323.GISL1
crddata.2024240323.GISL1
+ echo MLTSAT
MLTSAT
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ gzip -d -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL1.gz
+ sed -e 's/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 0 2 0/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 2 2 0/' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL1
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL1
+ rm //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ /umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/CRD2_2_MRT_X_221204.x -i //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL1 -o //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
Convert CRD Fullrate to Merit II Format: version 2.01b 12/23/2028
crd_in = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL1]
cstg_out = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata]
+ '[' GISL1 = GISL1 ']'
+ no=7603901
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL1.gz
gzip: /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL1.gz: No such file or directory
+ '[' MLTSAT = BLITS ']'
+ grep '^7603901' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/QLNP_2_TDFINP_CRD MLTSAT /umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ cp o.QLNP_2_TDFINP /tmp/magdak/o.QLNP_2_TDFINP_
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/SORT_DATA_BY_RELEASE_FLAG_P2 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT

#     SORT_DATA_BY_RELEASE_FLAG


SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
+ SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
SCR_PARM=2
+ SCR_PARM=2
SCR_LIST="disk"
+ SCR_LIST=disk
SCR_VERS=120711.0
+ SCR_VERS=120711.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi
expr $#
++ expr 2
+ '[' 2 -lt 2 ']'

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:45:40'

echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT '
 #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT 
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 120711.0 '
 #  Version 120711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:45:40 '
 #  Run Date DATE: 03/30/24  TIME: 13:45:40 
echo " # "
+ echo ' # '
 # 
disk=$1
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS
SAT_DIR=$2
+ SAT_DIR=MLTSAT
cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS TESTs
+ cp /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS TESTs
#cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS $disk/$SAT_DIR/d_base/data/MRT2/ALL_q
#COLLECT in separately file different release data
grep '41$' TESTs > 41
+ grep '41$' TESTs
grep '42$' TESTs > 42
+ grep '42$' TESTs
grep '43$' TESTs > 43
+ grep '43$' TESTs
grep '44$' TESTs > 44
+ grep '44$' TESTs

#remove name of the file from files
sed -e "s/TESTs://" 41 > 41a
+ sed -e s/TESTs:// 41
sed -e "s/TESTs://" 42 > 42a
+ sed -e s/TESTs:// 42
sed -e "s/TESTs://" 43 > 43a
+ sed -e s/TESTs:// 43
sed -e "s/TESTs://" 44 > 44a
+ sed -e s/TESTs:// 44

#cut files column 1-43
cut -c1-43 41a > 41aa
+ cut -c1-43 41a
cut -c1-43 42a > 42aa
+ cut -c1-43 42a
cut -c1-43 43a > 43aa
+ cut -c1-43 43a
cut -c1-43 44a > 44aa
+ cut -c1-43 44a

sed -e "s/ /0/g"  41aa > 41b
+ sed -e 's/ /0/g' 41aa
sed -e "s/ /0/g"  42aa > 42b
+ sed -e 's/ /0/g' 42aa
sed -e "s/ /0/g"  43aa > 43b
+ sed -e 's/ /0/g' 43aa
sed -e "s/ /0/g"  44aa > 44b
+ sed -e 's/ /0/g' 44aa

rm 41c 42c 43c  41d 42d 41e 4?_0
+ rm 41c 42c 43c 41d 42d 41e '4?_0'
rm: cannot remove ‘4?_0’: No such file or directory
#Check that data  and keep data only the higher release flag

if [ -s 44b  ]
then
while read line4
do
grep -v $line4 41b > 41c
cp 41c 41b
grep -v $line4 42b > 42c
cp 42c 42b
grep -v $line4 43b > 43c
cp 43c 43b
grep  $line4 44a >> 44_0

done < 44b
else
cp 41b 41c
cp 42b 42c
cp 43b 43c
fi
+ '[' -s 44b ']'
+ cp 41b 41c
+ cp 42b 42c
+ cp 43b 43c
#exit 2
if [ -s 43c  ]
then
while read line3
do
grep -v $line3 41c > 41d
cp 41d 41c
grep -v $line3 42c > 42d
cp 42d 42c
grep  $line3 43a >> 43_0
done < 43c
else
cp 41c 41d
cp 42c 42d
fi
+ '[' -s 43c ']'
+ cp 41c 41d
+ cp 42c 42d

if [ -s 42d  ]
then
while read line2
do
grep -v $line2 41d > 41e
cp 41e 41d
grep  $line2 42a >> 42_0
done < 42d
else
cp 41d 41e
fi
+ '[' -s 42d ']'
+ cp 41d 41e

if [ -s 41e  ]
then
while read line1
do
grep  $line1 41a >> 41_0
done < 41e
fi
+ '[' -s 41e ']'

#Remove from data file data which has reles flag bigger than "0"
cat 4?_0 > TD
+ cat '4?_0'
cat: 4?_0: No such file or directory
cut -c1-43 TD > TDD
+ cut -c1-43 TD
sort -u TDD > TS
+ sort -u TDD

cp TESTs T0
+ cp TESTs T0
if [ -s TS  ]
then
while read line0
do
grep -v $line0 T0 > T1
cp T1  T0
done < TS
fi
+ '[' -s TS ']'

#Add to data file data with the higer release flag and sort by time

cat TD >> T0
+ cat TD
sort -k1,43 T0 > TSS
+ sort -k1,43 T0


cp TSS /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS
+ cp TSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS


exit 0
+ exit 0
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.GISL1.mr2
+ grep -v '\-10030' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.GISL1.mr2
+ grep -v '\-1\-130' t10
+ cp t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.GISL1.mr2
+ rm -f //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.GISL1.mr2
+ '[' GISL1 = GISL1 ']'
+ DSK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ SV=L1
+ TAG=L1
+ FILEQL=qldata.2024240323.GISL1_24.tdf
+ export YY SV FILEQL SAT_DIR_S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.GISL1.mr2 crddata.2024240323.GISL1_24.tdf
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 1: !/bin/ksh: No such file or directory
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 4: #set: command not found

#  TDF_2_GDNBIN
#                                                               ecp       020318
#                                                               ecp       940310
#                                                               rob olson 950525
#
# Usage: TDF_2_GDNBIN data_format disk sat infile outfile [concar] 2> script_out &
#
# this shell script runs the TDF on various data formats.  if concar
# has ANY value (ie if there are 6 command line arguments), then
# this script ftp's the "CONOGBed" members listed in memlist from the
# IBM PDS given by infile, and first runs CONCAR on them
# before running the TDF.  otherwise, the
# location of infile on $disk depends on the data format selected.
# output from this script is netpushed to Unitree.
#
# NOTE:  1) the first command line argument is the GEODYN II
#           data format indicator
#        2) lines 161,177: if concar is to be run, verify path to memlist,
#           and note that the order of member names in memlist is the order
#           in which the files will be concatenated for concar input
#        3) line 225: use the polar motion tables you plan to use
#           when running GEODYN II
#        4) line 232: verify version of tdf executable
#        5) unit 90 output is placed in
#           /$disk/$sat/output/TDFout/$outfile
#        6) tdf binary output is placed in /$disk/$sat/d_base/data/TDF/$outfile
#  ecp   7) this new version allows for a "SAT" dependence in the dir path,
#           e.g. IGS92, IGS93, tp, lre, L1, etc.. It also picks the proper
#           "metric99" and "concarnm" control files depending on what
#           data format you specify with "data_format".
#        8) It seems that the "memlist" option has been disabled in this
#           version, but the member names are assumed to have the following
#           format depending again on the "data_format":
#               GPS (metric fmt) and PCE:  Dddd
#               Binary (e.g. SLR data) :   the entire name is specified in "doy"
#                                          the input in file "infile" of the
#                                          subtdf script.
#
#QSUB -s /bin/sh
#QSUB -r tdf_it!
#QSUB -q medium -eo
#QSUB -lM 15.0MW -lm 15.0MW
#QSUB -lT 2400 -lt 202395
#QSUB -A g926d
#QSUB -me

LOCALDSK=tmp
++ LOCALDSK=tmp

#
# interactive or batch ?
#
if [ $ENVIRONMENT ]; then
   if [ $ENVIRONMENT = "BATCH" ]; then
      if [ $wrapper ]; then
         read data_format disk sat infile outfile concar < /tmp/$USER/tdf.batch.$doy
      else
         read data_format disk sat infile outfile concar < $MAIN_PATH/INFILES/INF_OPS_D_CRD/tdf.batch
      fi
   else
      echo ENVIRONMENT = $ENVIRONMENT ?
      exit 99
   fi
else
 
SCR_NAME=TDF_2_GDNBIN
SCR_PARM=5
SCR_LIST="data_format disk sat infile outfile"
SCR_VERS=040220.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`

echo " # "
echo " #  $SCR_NAME $* "
echo " # "
echo " #  Version $SCR_VERS "
echo " # "
echo " #  Run Date $DateTime "
echo " # "

#  if [ `expr $#` -lt 5 -o `expr $#` -gt 6 ]; then
#     echo "Usage: tdf data_format disk sat infile outfile [concar] 2> script_out &\007"
#     exit 1
#  fi

   data_format=$1
   disk=$2
   sat=$3
   infile=$4
   outfile=$5
   concar=$6
fi
++ '[' ']'
++ SCR_NAME=TDF_2_GDNBIN
++ SCR_PARM=5
++ SCR_LIST='data_format disk sat infile outfile'
++ SCR_VERS=040220.0
expr $#
+++ expr 5
++ '[' 5 -lt 5 ']'
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ DateTime='DATE: 03/30/24  TIME: 13:45:40'
++ echo ' # '
 # 
++ echo ' #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.GISL1.mr2 crddata.2024240323.GISL1_24.tdf '
 #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.GISL1.mr2 crddata.2024240323.GISL1_24.tdf 
++ echo ' # '
 # 
++ echo ' #  Version 040220.0 '
 #  Version 040220.0 
++ echo ' # '
 # 
++ echo ' #  Run Date DATE: 03/30/24  TIME: 13:45:40 '
 #  Run Date DATE: 03/30/24  TIME: 13:45:40 
++ echo ' # '
 # 
++ data_format=9
++ disk=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
++ sat=MLTSAT
++ infile=crddata.2024240323.GISL1.mr2
++ outfile=crddata.2024240323.GISL1_24.tdf
++ concar=

dir=`dirname $outfile`
dirname $outfile
+++ dirname crddata.2024240323.GISL1_24.tdf
++ dir=.

#
# determine the data format to be used
#
case $data_format in
   0) unit=22 ;;       #  Geodyn Binary
   2) unit=24 ;;       #  MERIT II SLR data
   3) unit=26 ;;       #  GEOS-3 Card image - 80 byte fmt
   4) unit=28 ;;       #  Extended Geodyn Binary (Altimetry)
   5) unit=30 ;;       #  PCE
   6) unit=32 ;;       #  Extended GEOS-3 Card image - 120 byte fmt
   7) unit=34 ;;       #  GPS Metric type fmt
   8) unit=36 ;;       #  VLBI Binary fmt
  10) unit=38 ;;
   9) unit=24 ;; ### mkc???  Merit-X SLR Data from CRD reformatter
   *) echo "tdf: Invalid Data Format Indicator: use 0-10 !!\007"; exit 1 ;;
esac
++ case $data_format in
++ unit=24

if   [ "$data_format" = "7" ]; then

   tdfcards=metric99.mtr
   concarnm=concarnm.mtr
   files=$infile

elif [ "$data_format" = "5" ]; then

   tdfcards=metric99.pce
   files=D$doy

elif [ "$data_format" = "0" ]; then

   tdfcards=metric99.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "2" ]; then

   tdfcards=merit2.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "9" ]; then

if [ "$SAT_DIR_S" = "ETA1" -o "$SAT_DIR_S" = "ETA2" ]; then
   tdfcards=merit9_E12.$YY
elif [ "$SAT_DIR_S" = "GISL1" -o "$SAT_DIR_S" = "GISL2" ]; then
   tdfcards=merit9_L12.$YY
elif [ "$SAT_DIR_S" = "LARES" -o "$SAT_DIR_S" = "STARL" -o "$SAT_DIR_S" = "AJISI" -o "$SAT_DIR_S" = "STELLA" ]; then
   tdfcards=merit9_AS.$YY
else
tdfcards=merit9.$YY
fi
 ### orginal independet fro any satellites  tdfcards=merit9.$YY
   concarnm=concarnm.bin
   files=$infile
fi
++ '[' 9 = 7 ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ '[' GISL1 = ETA1 -o GISL1 = ETA2 ']'
++ '[' GISL1 = GISL1 -o GISL1 = GISL2 ']'
++ tdfcards=merit9_L12.24
++ concarnm=concarnm.bin
++ files=crddata.2024240323.GISL1.mr2

#
# make sure you have everything you need
#
if [ ! -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current ]; then
   echo $MAIN_PATH/MISSIONS/d_base/tabs/iers.current doesn\'t exist !
   exit 99
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current ']'
if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ]; then
   echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards doesn\'t exist !
   exit 98
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_L12.24 ']'
if [ $concar ]; then

   if [ ! -f $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ]; then
      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm doesn\'t exist !
      exit 97
   fi


#   if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist ]; then
#      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist doesn\'t exist !
#      exit 96
#   fi

elif [ "$data_format" = "7" -a ! -s /$disk/$sat/d_base/data/tdfphase.$infile.Z ]; then
   echo /$disk/$sat/d_base/data/tdfphase.$infile.Z doesn\'t exist !
   exit 99
fi
++ '[' ']'
++ '[' 9 = 7 -a '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/tdfphase.crddata.2024240323.GISL1.mr2.Z ']'

###if [ ! -d /$disk/$sat ]; then
###   mkdir /$disk/$sat
###fi
###
###if [ ! -d /$disk/$sat/d_base ]; then
###   mkdir /$disk/$sat/d_base
###fi
###
###if [ ! -d /$disk/$sat/d_base/data ]; the/\$MAIN_PATH/$MAIN_PATH
###   mkdir /$disk/$sat/d_base/data
###fi
###
###if [ ! -d /$disk/$sat/d_base/data/TDF ]; then
###   mkdir /$disk/$sat/d_base/data/TDF
###fi
###
###if [ ! -d /$disk/$sat/output/TDFout ]; then
###   mkdir /$disk/$sat/output/TDFout
###fi
###
###if [ "$dir" != "." ]; then
###   if [ ! -d /$disk/$sat/d_base/data/$dir ]; then
###      mkdir /$disk/$sat/d_base/data/$dir
###   fi
###fi

mkdir /$LOCALDSK/tdf$$
++ mkdir /tmp/tdf18443
cd /$LOCALDSK/tdf$$
++ cd /tmp/tdf18443

if [ $concar ]; then

   #
   # netpull the CONOGBed files from gibbs
   #
   files=`awk '{printf("%s "),$1 }' $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist `

ftp gibbs << EOF!!
prompt
case
ascii
cd \'$infile\'
mget $files
EOF!!

   #
   # cat the files in the order specified in memlist.  if only
   # one file, just link to it
   #
   numfiles=`wc -l $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist | awk ' {print $1} ' `
   if [ "$numfiles" = "1" ]; then
      ln -s /tmp/tdf$$/$files ftn10
   else
      cat $files > ftn10
   fi

   #
   # get concar control card and run it
   #
   ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ftn04
   echo "***"
   echo "***           RUN CONCAR"
   echo "***"
   /space/users/epavlis/EXECUTABLES/concar 1>tmpcon6 2>tmpcone
   \rm ftn10 ftn04
fi
++ '[' ']'
#
#  get tdf supporting data files and run it
#
if [ $concar ]; then
   if [ -s ftn11 ]; then               # use concar output if run
      mv ftn11 fort.$unit
   else
      echo CONCAR TERMINATED ABNORMALLY - EXITING
      exit 95
   fi
elif [ "$data_format" = "5" ]; then   # cat together PCE data
   count=1
   while [ $count -le 32 ]
   do
      prn=$count
      if [ $count -lt 10 ]; then
         prn=0$count
      fi
      if [ -f /$disk/$sat/PCEC/PRN${prn}/$infile.Z ]; then
         zcat /$disk/$sat/PCEC/PRN${prn}/$infile.Z >> fort.$unit
      fi
      count=`expr $count + 1`
   done
#
elif [ "$data_format" = "7" ]; then   # cp Metric data

   zcat /$disk/$sat/d_base/data/tdfphase.$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "0" ]; then   # Binary data   (e.g. SLR)

   zcat /$disk/$sat/d_base/data/G2B/$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "2" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!

elif [ "$data_format" = "9" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!
fi
++ '[' ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 7 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ zcat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.GISL1.mr2.gz

ln -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current     fort.2
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current fort.2
#
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ftn05
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_L12.24 ftn05
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF

echo "***"
++ echo '***'
***
echo "***           RUN TDF"
++ echo '***           RUN TDF'
***           RUN TDF
echo "***"
++ echo '***'
***
#exit 20181220

#NEW TDF for CRD_2_MERIT long np data
#/umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/${TDF2GDN} 1>tmptdf6 2>tmptdfe
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST_100525.x
TDF2GDYN=tdf1006p0_i64_gFORT.x
++ TDF2GDYN=tdf1006p0_i64_gFORT.x
TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
++ TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
++ TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
TDF2GDYN=tdf1006p1_i64.x
++ TDF2GDYN=tdf1006p1_i64.x
TDF2GDYN=tdf1006p2_i64M_180927.x  ## for P2 version
++ TDF2GDYN=tdf1006p2_i64M_180927.x
#/umbc/research/epavlis/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
#
#$MAIN_PATH/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
/umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
++ /umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdf1006p2_i64M_180927.x




echo
++ echo

echo
++ echo


ls -al
++ ls -al
total 72
drwxrwxr-x    2 magdak research  4096 Mar 30 13:45 .
drwxrwxrwt. 135 root   root     28672 Mar 30 13:45 ..
lrwxrwxrwx    1 magdak research    65 Mar 30 13:45 FILIST.DF -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF
lrwxrwxrwx    1 magdak research    67 Mar 30 13:45 fort.2 -> /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current
-rw-rw-r--    1 magdak research     0 Mar 30 13:45 fort.24
-rw-rw-r--    1 magdak research 16016 Mar 30 13:45 fort.41
-rw-rw-r--    1 magdak research    26 Mar 30 13:45 fort.90
lrwxrwxrwx    1 magdak research    69 Mar 30 13:45 ftn05 -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_L12.24
-rw-rw-r--    1 magdak research  1866 Mar 30 13:45 tmptdf6
-rw-rw-r--    1 magdak research     0 Mar 30 13:45 tmptdfe
pwd
++ pwd
/tmp/tdf18443


#
# append fort.90 tdf output to unit 5 output
#
#exit 20180920
cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90 > /$disk/$sat/output/TDFout/$outfile
++ cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90
cat: tmpcon6: No such file or directory
cat: tmpcone: No such file or directory
chmod 777 /$disk/$sat/output/TDFout/$outfile
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.GISL1_24.tdf
#rm -f $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${outfile}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${FILEQL}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "qldata.2012120501.${sat}_12.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
######printf "${SV}_${YY}.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
gzip -9 -f /$disk/$sat/output/TDFout/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.GISL1_24.tdf

#
# move tdf output to $disk and Unitree
#

mv fort.41 /$disk/$sat/d_base/data/TDF/${outfile}
++ mv fort.41 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.GISL1_24.tdf
chmod 777 /$disk/$sat/d_base/data/TDF/${outfile}
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.GISL1_24.tdf
gzip -9  -f /$disk/$sat/d_base/data/TDF/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.GISL1_24.tdf

#markd because was conflict with link for qldata-merit data
#cd /$disk/$sat/d_base/data/MRT2/
#rm ${YY}.${sat}.mr2.Z
#ln -s $infile.Z  ${sat}_${YY}.mrt2.Z
#ln -s $infile.Z  ${YY}.${sat}.mr2.Z
#chmod 777 ${YY}.${sat}.mr2.Z

cd /$disk/$sat/d_base/data/TDF
++ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF

#gzip -S .Z -f $outfile

#if [ "$data_format" = "0" -o "$data_format" = "2" -o "$data_format" = "9"  ]; then

echo $SV $YY
++ echo L1 24
L1 24
Date=`date +%y%m%d`
date +%y%m%d
+++ date +%y%m%d
++ Date=240330

####to be changed
#rm ${SV}_$YY.tdf_crd.Z
#rm ${SV}_$YY.tdf.Z
#ln -s $outfile.Z ${SV}_$YY.tdf_crd.Z
#ln -s $outfile.Z ${SV}_$YY.tdf.Z
#chmod 777 ${SV}_$YY.tdf_crd.Z

#fi


cd ..
++ cd ..
\rm -r /$LOCALDSK/tdf$$
++ rm -r /tmp/tdf18443
+ read sat SAT_DIR_S
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ mkdir temp17794
+ mkdir /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/GISL2
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/GISL2
+ cat
+ sed -e '1,$s/PP/23/g' -e '1,$s/pppp/2023/g' -e '1,$s/yyyy/2024/g' -e '1,$s/zzzz/2025/g' -e '1,$s/SAT/lageos2/g' -e '1,$s/MONTHC/03/g' input1
+ cp /umbc/research/magdak/.netrc_NO_EDC_LOG /umbc/research/magdak/.netrc
+ /usr/bin/ftp -p edc.dgfi.tum.de
+ cp /umbc/research/magdak/.netrc_EDC_LOG /umbc/research/magdak/.netrc
+ rm lageos2_202403.np2
rm: cannot remove ‘lageos2_202403.np2’: No such file or directory
+ cat 'lageos2_202403??.np2'
cat: lageos2_202403??.np2: No such file or directory
+ cat lageos2_202401.np2 lageos2_202402.np2
+ cat lageos2_202312.np2
+ cat lageos2_202501.np2
cat: lageos2_202501.np2: No such file or directory
+ cp year.M1 ../.
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794
+ sed 's/^H/h/g' year.M1
+ sed s/h9H1/h1/ year.M1A
+ grep -v -e h9 -e '^30' year.M1C
+ grep -v -e h9 -e '^30' year.00C
grep: year.00C: No such file or directory
+ cat year.M1B year.00B
+ sed 's/^C/c/' year.ALL2
+ grep '^h2' year.ALL
+ sort -u -o strng1
+ cut -c1-18
+ cp year.ALL crddata.2024240323.GISL2
+ printf h9
+ cat H9
+ FILE=crddata.2024240323.GISL2
+ gzip -9 -f crddata.2024240323.GISL2
+ rm ../crddata.2024240323.GISL2.gz
rm: cannot remove ‘../crddata.2024240323.GISL2.gz’: No such file or directory
+ cp crddata.2024240323.GISL2.gz ../crddata.2024240323.GISL2.gz
+ cp year.ALL0 year.ALL ../.
cp: cannot stat ‘year.ALL0’: No such file or directory
+ chmod 777 ../crddata.2024240323.GISL2.gz
+ cd ..
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ OLD_FILE=crddata.2024240322.GISL2
+ FLAG=NO
+ sum crddata.2024240323.GISL2.gz
+ sum crddata.2024240322.GISL2.gz
sum: crddata.2024240322.GISL2.gz: No such file or directory
+ read nbts nblks nfl
+ read obts oblks ofl
+ '[714' ']'
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2: line 212: : No such file or directory
+ echo ' OLD QL file: '
+ cat old_sum_mkc
+ echo '  '
  
+ echo ' NEW QL file: '
+ cat new_sum_mkc
+ rm 2mail
+ rm -r temp17794
+ export FLAG OLD_FILE
+ echo crddata.2024240323.GISL2
crddata.2024240323.GISL2
+ echo MLTSAT
MLTSAT
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ gzip -d -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL2.gz
+ sed -e 's/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 0 2 0/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 2 2 0/' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL2
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL2
+ rm //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ /umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/CRD2_2_MRT_X_221204.x -i //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL2 -o //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
Convert CRD Fullrate to Merit II Format: version 2.01b 12/23/2028
crd_in = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL2]
cstg_out = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata]
+ '[' GISL2 = GISL1 ']'
+ '[' GISL2 = GISL2 ']'
+ no=9207002
+ grep -v 25230 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/tt //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL2.gz
gzip: /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.GISL2.gz: No such file or directory
+ '[' MLTSAT = BLITS ']'
+ grep '^9207002' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/QLNP_2_TDFINP_CRD MLTSAT /umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ cp o.QLNP_2_TDFINP /tmp/magdak/o.QLNP_2_TDFINP_
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/SORT_DATA_BY_RELEASE_FLAG_P2 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT

#     SORT_DATA_BY_RELEASE_FLAG


SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
+ SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
SCR_PARM=2
+ SCR_PARM=2
SCR_LIST="disk"
+ SCR_LIST=disk
SCR_VERS=120711.0
+ SCR_VERS=120711.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi
expr $#
++ expr 2
+ '[' 2 -lt 2 ']'

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:45:50'

echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT '
 #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT 
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 120711.0 '
 #  Version 120711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:45:50 '
 #  Run Date DATE: 03/30/24  TIME: 13:45:50 
echo " # "
+ echo ' # '
 # 
disk=$1
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS
SAT_DIR=$2
+ SAT_DIR=MLTSAT
cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS TESTs
+ cp /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS TESTs
#cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS $disk/$SAT_DIR/d_base/data/MRT2/ALL_q
#COLLECT in separately file different release data
grep '41$' TESTs > 41
+ grep '41$' TESTs
grep '42$' TESTs > 42
+ grep '42$' TESTs
grep '43$' TESTs > 43
+ grep '43$' TESTs
grep '44$' TESTs > 44
+ grep '44$' TESTs

#remove name of the file from files
sed -e "s/TESTs://" 41 > 41a
+ sed -e s/TESTs:// 41
sed -e "s/TESTs://" 42 > 42a
+ sed -e s/TESTs:// 42
sed -e "s/TESTs://" 43 > 43a
+ sed -e s/TESTs:// 43
sed -e "s/TESTs://" 44 > 44a
+ sed -e s/TESTs:// 44

#cut files column 1-43
cut -c1-43 41a > 41aa
+ cut -c1-43 41a
cut -c1-43 42a > 42aa
+ cut -c1-43 42a
cut -c1-43 43a > 43aa
+ cut -c1-43 43a
cut -c1-43 44a > 44aa
+ cut -c1-43 44a

sed -e "s/ /0/g"  41aa > 41b
+ sed -e 's/ /0/g' 41aa
sed -e "s/ /0/g"  42aa > 42b
+ sed -e 's/ /0/g' 42aa
sed -e "s/ /0/g"  43aa > 43b
+ sed -e 's/ /0/g' 43aa
sed -e "s/ /0/g"  44aa > 44b
+ sed -e 's/ /0/g' 44aa

rm 41c 42c 43c  41d 42d 41e 4?_0
+ rm 41c 42c 43c 41d 42d 41e '4?_0'
rm: cannot remove ‘4?_0’: No such file or directory
#Check that data  and keep data only the higher release flag

if [ -s 44b  ]
then
while read line4
do
grep -v $line4 41b > 41c
cp 41c 41b
grep -v $line4 42b > 42c
cp 42c 42b
grep -v $line4 43b > 43c
cp 43c 43b
grep  $line4 44a >> 44_0

done < 44b
else
cp 41b 41c
cp 42b 42c
cp 43b 43c
fi
+ '[' -s 44b ']'
+ cp 41b 41c
+ cp 42b 42c
+ cp 43b 43c
#exit 2
if [ -s 43c  ]
then
while read line3
do
grep -v $line3 41c > 41d
cp 41d 41c
grep -v $line3 42c > 42d
cp 42d 42c
grep  $line3 43a >> 43_0
done < 43c
else
cp 41c 41d
cp 42c 42d
fi
+ '[' -s 43c ']'
+ cp 41c 41d
+ cp 42c 42d

if [ -s 42d  ]
then
while read line2
do
grep -v $line2 41d > 41e
cp 41e 41d
grep  $line2 42a >> 42_0
done < 42d
else
cp 41d 41e
fi
+ '[' -s 42d ']'
+ cp 41d 41e

if [ -s 41e  ]
then
while read line1
do
grep  $line1 41a >> 41_0
done < 41e
fi
+ '[' -s 41e ']'

#Remove from data file data which has reles flag bigger than "0"
cat 4?_0 > TD
+ cat '4?_0'
cat: 4?_0: No such file or directory
cut -c1-43 TD > TDD
+ cut -c1-43 TD
sort -u TDD > TS
+ sort -u TDD

cp TESTs T0
+ cp TESTs T0
if [ -s TS  ]
then
while read line0
do
grep -v $line0 T0 > T1
cp T1  T0
done < TS
fi
+ '[' -s TS ']'

#Add to data file data with the higer release flag and sort by time

cat TD >> T0
+ cat TD
sort -k1,43 T0 > TSS
+ sort -k1,43 T0


cp TSS /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS
+ cp TSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS


exit 0
+ exit 0
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.GISL2.mr2
+ grep -v '\-10030' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.GISL2.mr2
+ grep -v '\-1\-130' t10
+ cp t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.GISL2.mr2
+ rm -f //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.GISL2.mr2
+ '[' GISL2 = GISL1 ']'
+ '[' GISL2 = GISL2 ']'
+ DSK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ SV=L2
+ TAG=L2
+ FILEQL=qldata.2024240323.GISL2_24.tdf
+ export YY SV FILEQL SAT_DIR_S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.GISL2.mr2 crddata.2024240323.GISL2_24.tdf
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 1: !/bin/ksh: No such file or directory
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 4: #set: command not found

#  TDF_2_GDNBIN
#                                                               ecp       020318
#                                                               ecp       940310
#                                                               rob olson 950525
#
# Usage: TDF_2_GDNBIN data_format disk sat infile outfile [concar] 2> script_out &
#
# this shell script runs the TDF on various data formats.  if concar
# has ANY value (ie if there are 6 command line arguments), then
# this script ftp's the "CONOGBed" members listed in memlist from the
# IBM PDS given by infile, and first runs CONCAR on them
# before running the TDF.  otherwise, the
# location of infile on $disk depends on the data format selected.
# output from this script is netpushed to Unitree.
#
# NOTE:  1) the first command line argument is the GEODYN II
#           data format indicator
#        2) lines 161,177: if concar is to be run, verify path to memlist,
#           and note that the order of member names in memlist is the order
#           in which the files will be concatenated for concar input
#        3) line 225: use the polar motion tables you plan to use
#           when running GEODYN II
#        4) line 232: verify version of tdf executable
#        5) unit 90 output is placed in
#           /$disk/$sat/output/TDFout/$outfile
#        6) tdf binary output is placed in /$disk/$sat/d_base/data/TDF/$outfile
#  ecp   7) this new version allows for a "SAT" dependence in the dir path,
#           e.g. IGS92, IGS93, tp, lre, L1, etc.. It also picks the proper
#           "metric99" and "concarnm" control files depending on what
#           data format you specify with "data_format".
#        8) It seems that the "memlist" option has been disabled in this
#           version, but the member names are assumed to have the following
#           format depending again on the "data_format":
#               GPS (metric fmt) and PCE:  Dddd
#               Binary (e.g. SLR data) :   the entire name is specified in "doy"
#                                          the input in file "infile" of the
#                                          subtdf script.
#
#QSUB -s /bin/sh
#QSUB -r tdf_it!
#QSUB -q medium -eo
#QSUB -lM 15.0MW -lm 15.0MW
#QSUB -lT 2400 -lt 202395
#QSUB -A g926d
#QSUB -me

LOCALDSK=tmp
++ LOCALDSK=tmp

#
# interactive or batch ?
#
if [ $ENVIRONMENT ]; then
   if [ $ENVIRONMENT = "BATCH" ]; then
      if [ $wrapper ]; then
         read data_format disk sat infile outfile concar < /tmp/$USER/tdf.batch.$doy
      else
         read data_format disk sat infile outfile concar < $MAIN_PATH/INFILES/INF_OPS_D_CRD/tdf.batch
      fi
   else
      echo ENVIRONMENT = $ENVIRONMENT ?
      exit 99
   fi
else
 
SCR_NAME=TDF_2_GDNBIN
SCR_PARM=5
SCR_LIST="data_format disk sat infile outfile"
SCR_VERS=040220.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`

echo " # "
echo " #  $SCR_NAME $* "
echo " # "
echo " #  Version $SCR_VERS "
echo " # "
echo " #  Run Date $DateTime "
echo " # "

#  if [ `expr $#` -lt 5 -o `expr $#` -gt 6 ]; then
#     echo "Usage: tdf data_format disk sat infile outfile [concar] 2> script_out &\007"
#     exit 1
#  fi

   data_format=$1
   disk=$2
   sat=$3
   infile=$4
   outfile=$5
   concar=$6
fi
++ '[' ']'
++ SCR_NAME=TDF_2_GDNBIN
++ SCR_PARM=5
++ SCR_LIST='data_format disk sat infile outfile'
++ SCR_VERS=040220.0
expr $#
+++ expr 5
++ '[' 5 -lt 5 ']'
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ DateTime='DATE: 03/30/24  TIME: 13:45:51'
++ echo ' # '
 # 
++ echo ' #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.GISL2.mr2 crddata.2024240323.GISL2_24.tdf '
 #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.GISL2.mr2 crddata.2024240323.GISL2_24.tdf 
++ echo ' # '
 # 
++ echo ' #  Version 040220.0 '
 #  Version 040220.0 
++ echo ' # '
 # 
++ echo ' #  Run Date DATE: 03/30/24  TIME: 13:45:51 '
 #  Run Date DATE: 03/30/24  TIME: 13:45:51 
++ echo ' # '
 # 
++ data_format=9
++ disk=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
++ sat=MLTSAT
++ infile=crddata.2024240323.GISL2.mr2
++ outfile=crddata.2024240323.GISL2_24.tdf
++ concar=

dir=`dirname $outfile`
dirname $outfile
+++ dirname crddata.2024240323.GISL2_24.tdf
++ dir=.

#
# determine the data format to be used
#
case $data_format in
   0) unit=22 ;;       #  Geodyn Binary
   2) unit=24 ;;       #  MERIT II SLR data
   3) unit=26 ;;       #  GEOS-3 Card image - 80 byte fmt
   4) unit=28 ;;       #  Extended Geodyn Binary (Altimetry)
   5) unit=30 ;;       #  PCE
   6) unit=32 ;;       #  Extended GEOS-3 Card image - 120 byte fmt
   7) unit=34 ;;       #  GPS Metric type fmt
   8) unit=36 ;;       #  VLBI Binary fmt
  10) unit=38 ;;
   9) unit=24 ;; ### mkc???  Merit-X SLR Data from CRD reformatter
   *) echo "tdf: Invalid Data Format Indicator: use 0-10 !!\007"; exit 1 ;;
esac
++ case $data_format in
++ unit=24

if   [ "$data_format" = "7" ]; then

   tdfcards=metric99.mtr
   concarnm=concarnm.mtr
   files=$infile

elif [ "$data_format" = "5" ]; then

   tdfcards=metric99.pce
   files=D$doy

elif [ "$data_format" = "0" ]; then

   tdfcards=metric99.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "2" ]; then

   tdfcards=merit2.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "9" ]; then

if [ "$SAT_DIR_S" = "ETA1" -o "$SAT_DIR_S" = "ETA2" ]; then
   tdfcards=merit9_E12.$YY
elif [ "$SAT_DIR_S" = "GISL1" -o "$SAT_DIR_S" = "GISL2" ]; then
   tdfcards=merit9_L12.$YY
elif [ "$SAT_DIR_S" = "LARES" -o "$SAT_DIR_S" = "STARL" -o "$SAT_DIR_S" = "AJISI" -o "$SAT_DIR_S" = "STELLA" ]; then
   tdfcards=merit9_AS.$YY
else
tdfcards=merit9.$YY
fi
 ### orginal independet fro any satellites  tdfcards=merit9.$YY
   concarnm=concarnm.bin
   files=$infile
fi
++ '[' 9 = 7 ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ '[' GISL2 = ETA1 -o GISL2 = ETA2 ']'
++ '[' GISL2 = GISL1 -o GISL2 = GISL2 ']'
++ tdfcards=merit9_L12.24
++ concarnm=concarnm.bin
++ files=crddata.2024240323.GISL2.mr2

#
# make sure you have everything you need
#
if [ ! -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current ]; then
   echo $MAIN_PATH/MISSIONS/d_base/tabs/iers.current doesn\'t exist !
   exit 99
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current ']'
if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ]; then
   echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards doesn\'t exist !
   exit 98
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_L12.24 ']'
if [ $concar ]; then

   if [ ! -f $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ]; then
      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm doesn\'t exist !
      exit 97
   fi


#   if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist ]; then
#      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist doesn\'t exist !
#      exit 96
#   fi

elif [ "$data_format" = "7" -a ! -s /$disk/$sat/d_base/data/tdfphase.$infile.Z ]; then
   echo /$disk/$sat/d_base/data/tdfphase.$infile.Z doesn\'t exist !
   exit 99
fi
++ '[' ']'
++ '[' 9 = 7 -a '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/tdfphase.crddata.2024240323.GISL2.mr2.Z ']'

###if [ ! -d /$disk/$sat ]; then
###   mkdir /$disk/$sat
###fi
###
###if [ ! -d /$disk/$sat/d_base ]; then
###   mkdir /$disk/$sat/d_base
###fi
###
###if [ ! -d /$disk/$sat/d_base/data ]; the/\$MAIN_PATH/$MAIN_PATH
###   mkdir /$disk/$sat/d_base/data
###fi
###
###if [ ! -d /$disk/$sat/d_base/data/TDF ]; then
###   mkdir /$disk/$sat/d_base/data/TDF
###fi
###
###if [ ! -d /$disk/$sat/output/TDFout ]; then
###   mkdir /$disk/$sat/output/TDFout
###fi
###
###if [ "$dir" != "." ]; then
###   if [ ! -d /$disk/$sat/d_base/data/$dir ]; then
###      mkdir /$disk/$sat/d_base/data/$dir
###   fi
###fi

mkdir /$LOCALDSK/tdf$$
++ mkdir /tmp/tdf21312
cd /$LOCALDSK/tdf$$
++ cd /tmp/tdf21312

if [ $concar ]; then

   #
   # netpull the CONOGBed files from gibbs
   #
   files=`awk '{printf("%s "),$1 }' $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist `

ftp gibbs << EOF!!
prompt
case
ascii
cd \'$infile\'
mget $files
EOF!!

   #
   # cat the files in the order specified in memlist.  if only
   # one file, just link to it
   #
   numfiles=`wc -l $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist | awk ' {print $1} ' `
   if [ "$numfiles" = "1" ]; then
      ln -s /tmp/tdf$$/$files ftn10
   else
      cat $files > ftn10
   fi

   #
   # get concar control card and run it
   #
   ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ftn04
   echo "***"
   echo "***           RUN CONCAR"
   echo "***"
   /space/users/epavlis/EXECUTABLES/concar 1>tmpcon6 2>tmpcone
   \rm ftn10 ftn04
fi
++ '[' ']'
#
#  get tdf supporting data files and run it
#
if [ $concar ]; then
   if [ -s ftn11 ]; then               # use concar output if run
      mv ftn11 fort.$unit
   else
      echo CONCAR TERMINATED ABNORMALLY - EXITING
      exit 95
   fi
elif [ "$data_format" = "5" ]; then   # cat together PCE data
   count=1
   while [ $count -le 32 ]
   do
      prn=$count
      if [ $count -lt 10 ]; then
         prn=0$count
      fi
      if [ -f /$disk/$sat/PCEC/PRN${prn}/$infile.Z ]; then
         zcat /$disk/$sat/PCEC/PRN${prn}/$infile.Z >> fort.$unit
      fi
      count=`expr $count + 1`
   done
#
elif [ "$data_format" = "7" ]; then   # cp Metric data

   zcat /$disk/$sat/d_base/data/tdfphase.$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "0" ]; then   # Binary data   (e.g. SLR)

   zcat /$disk/$sat/d_base/data/G2B/$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "2" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!

elif [ "$data_format" = "9" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!
fi
++ '[' ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 7 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ zcat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.GISL2.mr2.gz

ln -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current     fort.2
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current fort.2
#
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ftn05
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_L12.24 ftn05
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF

echo "***"
++ echo '***'
***
echo "***           RUN TDF"
++ echo '***           RUN TDF'
***           RUN TDF
echo "***"
++ echo '***'
***
#exit 20181220

#NEW TDF for CRD_2_MERIT long np data
#/umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/${TDF2GDN} 1>tmptdf6 2>tmptdfe
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST_100525.x
TDF2GDYN=tdf1006p0_i64_gFORT.x
++ TDF2GDYN=tdf1006p0_i64_gFORT.x
TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
++ TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
++ TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
TDF2GDYN=tdf1006p1_i64.x
++ TDF2GDYN=tdf1006p1_i64.x
TDF2GDYN=tdf1006p2_i64M_180927.x  ## for P2 version
++ TDF2GDYN=tdf1006p2_i64M_180927.x
#/umbc/research/epavlis/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
#
#$MAIN_PATH/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
/umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
++ /umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdf1006p2_i64M_180927.x




echo
++ echo

echo
++ echo


ls -al
++ ls -al
total 3936
drwxrwxr-x    2 magdak research    4096 Mar 30 13:45 .
drwxrwxrwt. 135 root   root       28672 Mar 30 13:45 ..
lrwxrwxrwx    1 magdak research      65 Mar 30 13:45 FILIST.DF -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF
lrwxrwxrwx    1 magdak research      67 Mar 30 13:45 fort.2 -> /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current
-rw-rw-r--    1 magdak research 1729304 Mar 30 13:45 fort.24
-rw-rw-r--    1 magdak research 2050048 Mar 30 13:45 fort.41
-rw-rw-r--    1 magdak research  192021 Mar 30 13:45 fort.90
lrwxrwxrwx    1 magdak research      69 Mar 30 13:45 ftn05 -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_L12.24
-rw-rw-r--    1 magdak research    1866 Mar 30 13:45 tmptdf6
-rw-rw-r--    1 magdak research       0 Mar 30 13:45 tmptdfe
pwd
++ pwd
/tmp/tdf21312


#
# append fort.90 tdf output to unit 5 output
#
#exit 20180920
cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90 > /$disk/$sat/output/TDFout/$outfile
++ cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90
cat: tmpcon6: No such file or directory
cat: tmpcone: No such file or directory
chmod 777 /$disk/$sat/output/TDFout/$outfile
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.GISL2_24.tdf
#rm -f $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${outfile}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${FILEQL}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "qldata.2012120501.${sat}_12.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
######printf "${SV}_${YY}.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
gzip -9 -f /$disk/$sat/output/TDFout/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.GISL2_24.tdf

#
# move tdf output to $disk and Unitree
#

mv fort.41 /$disk/$sat/d_base/data/TDF/${outfile}
++ mv fort.41 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.GISL2_24.tdf
chmod 777 /$disk/$sat/d_base/data/TDF/${outfile}
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.GISL2_24.tdf
gzip -9  -f /$disk/$sat/d_base/data/TDF/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.GISL2_24.tdf

#markd because was conflict with link for qldata-merit data
#cd /$disk/$sat/d_base/data/MRT2/
#rm ${YY}.${sat}.mr2.Z
#ln -s $infile.Z  ${sat}_${YY}.mrt2.Z
#ln -s $infile.Z  ${YY}.${sat}.mr2.Z
#chmod 777 ${YY}.${sat}.mr2.Z

cd /$disk/$sat/d_base/data/TDF
++ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF

#gzip -S .Z -f $outfile

#if [ "$data_format" = "0" -o "$data_format" = "2" -o "$data_format" = "9"  ]; then

echo $SV $YY
++ echo L2 24
L2 24
Date=`date +%y%m%d`
date +%y%m%d
+++ date +%y%m%d
++ Date=240330

####to be changed
#rm ${SV}_$YY.tdf_crd.Z
#rm ${SV}_$YY.tdf.Z
#ln -s $outfile.Z ${SV}_$YY.tdf_crd.Z
#ln -s $outfile.Z ${SV}_$YY.tdf.Z
#chmod 777 ${SV}_$YY.tdf_crd.Z

#fi


cd ..
++ cd ..
\rm -r /$LOCALDSK/tdf$$
++ rm -r /tmp/tdf21312
+ read sat SAT_DIR_S
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ mkdir temp17794
+ mkdir /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/ETA1
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/ETA1
+ cat
+ sed -e '1,$s/PP/23/g' -e '1,$s/pppp/2023/g' -e '1,$s/yyyy/2024/g' -e '1,$s/zzzz/2025/g' -e '1,$s/SAT/etalon1/g' -e '1,$s/MONTHC/03/g' input1
+ cp /umbc/research/magdak/.netrc_NO_EDC_LOG /umbc/research/magdak/.netrc
+ /usr/bin/ftp -p edc.dgfi.tum.de
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
+ cp /umbc/research/magdak/.netrc_EDC_LOG /umbc/research/magdak/.netrc
+ rm etalon1_202403.np2
+ cat etalon1_20240301.np2 etalon1_20240302.np2 etalon1_20240303.np2 etalon1_20240304.np2 etalon1_20240305.np2 etalon1_20240306.np2 etalon1_20240307.np2 etalon1_20240308.np2
+ cat etalon1_202401.np2 etalon1_202402.np2
+ cat etalon1_202312.np2
+ cat etalon1_202501.np2
cat: etalon1_202501.np2: No such file or directory
+ cp year.M1 ../.
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794
+ sed 's/^H/h/g' year.M1
+ sed s/h9H1/h1/ year.M1A
+ grep -v -e h9 -e '^30' year.M1C
+ grep -v -e h9 -e '^30' year.00C
grep: year.00C: No such file or directory
+ cat year.M1B year.00B
+ sed 's/^C/c/' year.ALL2
+ grep '^h2' year.ALL
+ cut -c1-18
+ sort -u -o strng1
+ cp year.ALL crddata.2024240323.ETA1
+ printf h9
+ cat H9
+ FILE=crddata.2024240323.ETA1
+ gzip -9 -f crddata.2024240323.ETA1
+ rm ../crddata.2024240323.ETA1.gz
rm: cannot remove ‘../crddata.2024240323.ETA1.gz’: No such file or directory
+ cp crddata.2024240323.ETA1.gz ../crddata.2024240323.ETA1.gz
+ cp year.ALL0 year.ALL ../.
cp: cannot stat ‘year.ALL0’: No such file or directory
+ chmod 777 ../crddata.2024240323.ETA1.gz
+ cd ..
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ OLD_FILE=crddata.2024240322.ETA1
+ FLAG=NO
+ sum crddata.2024240323.ETA1.gz
+ sum crddata.2024240322.ETA1.gz
sum: crddata.2024240322.ETA1.gz: No such file or directory
+ read nbts nblks nfl
+ read obts oblks ofl
+ '[141' ']'
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2: line 212: : No such file or directory
+ echo ' OLD QL file: '
+ cat old_sum_mkc
+ echo '  '
  
+ echo ' NEW QL file: '
+ cat new_sum_mkc
+ rm 2mail
+ rm -r temp17794
+ export FLAG OLD_FILE
+ echo crddata.2024240323.ETA1
crddata.2024240323.ETA1
+ echo MLTSAT
MLTSAT
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ gzip -d -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA1.gz
+ sed -e 's/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 0 2 0/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 2 2 0/' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA1
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA1
+ rm //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ /umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/CRD2_2_MRT_X_221204.x -i //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA1 -o //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
Convert CRD Fullrate to Merit II Format: version 2.01b 12/23/2028
crd_in = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA1]
cstg_out = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata]
+ '[' ETA1 = GISL1 ']'
+ '[' ETA1 = GISL2 ']'
+ '[' ETA1 = ETA1 ']'
+ no=8900103
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA1.gz
gzip: /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA1.gz: No such file or directory
+ '[' MLTSAT = BLITS ']'
+ grep '^8900103' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/QLNP_2_TDFINP_CRD MLTSAT /umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ cp o.QLNP_2_TDFINP /tmp/magdak/o.QLNP_2_TDFINP_
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/SORT_DATA_BY_RELEASE_FLAG_P2 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT

#     SORT_DATA_BY_RELEASE_FLAG


SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
+ SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
SCR_PARM=2
+ SCR_PARM=2
SCR_LIST="disk"
+ SCR_LIST=disk
SCR_VERS=120711.0
+ SCR_VERS=120711.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi
expr $#
++ expr 2
+ '[' 2 -lt 2 ']'

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:46:08'

echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT '
 #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT 
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 120711.0 '
 #  Version 120711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:46:08 '
 #  Run Date DATE: 03/30/24  TIME: 13:46:08 
echo " # "
+ echo ' # '
 # 
disk=$1
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS
SAT_DIR=$2
+ SAT_DIR=MLTSAT
cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS TESTs
+ cp /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS TESTs
#cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS $disk/$SAT_DIR/d_base/data/MRT2/ALL_q
#COLLECT in separately file different release data
grep '41$' TESTs > 41
+ grep '41$' TESTs
grep '42$' TESTs > 42
+ grep '42$' TESTs
grep '43$' TESTs > 43
+ grep '43$' TESTs
grep '44$' TESTs > 44
+ grep '44$' TESTs

#remove name of the file from files
sed -e "s/TESTs://" 41 > 41a
+ sed -e s/TESTs:// 41
sed -e "s/TESTs://" 42 > 42a
+ sed -e s/TESTs:// 42
sed -e "s/TESTs://" 43 > 43a
+ sed -e s/TESTs:// 43
sed -e "s/TESTs://" 44 > 44a
+ sed -e s/TESTs:// 44

#cut files column 1-43
cut -c1-43 41a > 41aa
+ cut -c1-43 41a
cut -c1-43 42a > 42aa
+ cut -c1-43 42a
cut -c1-43 43a > 43aa
+ cut -c1-43 43a
cut -c1-43 44a > 44aa
+ cut -c1-43 44a

sed -e "s/ /0/g"  41aa > 41b
+ sed -e 's/ /0/g' 41aa
sed -e "s/ /0/g"  42aa > 42b
+ sed -e 's/ /0/g' 42aa
sed -e "s/ /0/g"  43aa > 43b
+ sed -e 's/ /0/g' 43aa
sed -e "s/ /0/g"  44aa > 44b
+ sed -e 's/ /0/g' 44aa

rm 41c 42c 43c  41d 42d 41e 4?_0
+ rm 41c 42c 43c 41d 42d 41e '4?_0'
rm: cannot remove ‘4?_0’: No such file or directory
#Check that data  and keep data only the higher release flag

if [ -s 44b  ]
then
while read line4
do
grep -v $line4 41b > 41c
cp 41c 41b
grep -v $line4 42b > 42c
cp 42c 42b
grep -v $line4 43b > 43c
cp 43c 43b
grep  $line4 44a >> 44_0

done < 44b
else
cp 41b 41c
cp 42b 42c
cp 43b 43c
fi
+ '[' -s 44b ']'
+ cp 41b 41c
+ cp 42b 42c
+ cp 43b 43c
#exit 2
if [ -s 43c  ]
then
while read line3
do
grep -v $line3 41c > 41d
cp 41d 41c
grep -v $line3 42c > 42d
cp 42d 42c
grep  $line3 43a >> 43_0
done < 43c
else
cp 41c 41d
cp 42c 42d
fi
+ '[' -s 43c ']'
+ cp 41c 41d
+ cp 42c 42d

if [ -s 42d  ]
then
while read line2
do
grep -v $line2 41d > 41e
cp 41e 41d
grep  $line2 42a >> 42_0
done < 42d
else
cp 41d 41e
fi
+ '[' -s 42d ']'
+ cp 41d 41e

if [ -s 41e  ]
then
while read line1
do
grep  $line1 41a >> 41_0
done < 41e
fi
+ '[' -s 41e ']'

#Remove from data file data which has reles flag bigger than "0"
cat 4?_0 > TD
+ cat '4?_0'
cat: 4?_0: No such file or directory
cut -c1-43 TD > TDD
+ cut -c1-43 TD
sort -u TDD > TS
+ sort -u TDD

cp TESTs T0
+ cp TESTs T0
if [ -s TS  ]
then
while read line0
do
grep -v $line0 T0 > T1
cp T1  T0
done < TS
fi
+ '[' -s TS ']'

#Add to data file data with the higer release flag and sort by time

cat TD >> T0
+ cat TD
sort -k1,43 T0 > TSS
+ sort -k1,43 T0


cp TSS /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS
+ cp TSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS


exit 0
+ exit 0
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.ETA1.mr2
+ grep -v '\-10030' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.ETA1.mr2
+ grep -v '\-1\-130' t10
+ cp t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.ETA1.mr2
+ rm -f //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.ETA1.mr2
+ '[' ETA1 = GISL1 ']'
+ '[' ETA1 = GISL2 ']'
+ '[' ETA1 = ETA1 ']'
+ DSK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ SV=E1
+ TAG=E1
+ FILEQL=qldata.2024240323.ETA1_24.tdf
+ export YY SV FILEQL SAT_DIR_S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.ETA1.mr2 crddata.2024240323.ETA1_24.tdf
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 1: !/bin/ksh: No such file or directory
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 4: #set: command not found

#  TDF_2_GDNBIN
#                                                               ecp       020318
#                                                               ecp       940310
#                                                               rob olson 950525
#
# Usage: TDF_2_GDNBIN data_format disk sat infile outfile [concar] 2> script_out &
#
# this shell script runs the TDF on various data formats.  if concar
# has ANY value (ie if there are 6 command line arguments), then
# this script ftp's the "CONOGBed" members listed in memlist from the
# IBM PDS given by infile, and first runs CONCAR on them
# before running the TDF.  otherwise, the
# location of infile on $disk depends on the data format selected.
# output from this script is netpushed to Unitree.
#
# NOTE:  1) the first command line argument is the GEODYN II
#           data format indicator
#        2) lines 161,177: if concar is to be run, verify path to memlist,
#           and note that the order of member names in memlist is the order
#           in which the files will be concatenated for concar input
#        3) line 225: use the polar motion tables you plan to use
#           when running GEODYN II
#        4) line 232: verify version of tdf executable
#        5) unit 90 output is placed in
#           /$disk/$sat/output/TDFout/$outfile
#        6) tdf binary output is placed in /$disk/$sat/d_base/data/TDF/$outfile
#  ecp   7) this new version allows for a "SAT" dependence in the dir path,
#           e.g. IGS92, IGS93, tp, lre, L1, etc.. It also picks the proper
#           "metric99" and "concarnm" control files depending on what
#           data format you specify with "data_format".
#        8) It seems that the "memlist" option has been disabled in this
#           version, but the member names are assumed to have the following
#           format depending again on the "data_format":
#               GPS (metric fmt) and PCE:  Dddd
#               Binary (e.g. SLR data) :   the entire name is specified in "doy"
#                                          the input in file "infile" of the
#                                          subtdf script.
#
#QSUB -s /bin/sh
#QSUB -r tdf_it!
#QSUB -q medium -eo
#QSUB -lM 15.0MW -lm 15.0MW
#QSUB -lT 2400 -lt 202395
#QSUB -A g926d
#QSUB -me

LOCALDSK=tmp
++ LOCALDSK=tmp

#
# interactive or batch ?
#
if [ $ENVIRONMENT ]; then
   if [ $ENVIRONMENT = "BATCH" ]; then
      if [ $wrapper ]; then
         read data_format disk sat infile outfile concar < /tmp/$USER/tdf.batch.$doy
      else
         read data_format disk sat infile outfile concar < $MAIN_PATH/INFILES/INF_OPS_D_CRD/tdf.batch
      fi
   else
      echo ENVIRONMENT = $ENVIRONMENT ?
      exit 99
   fi
else
 
SCR_NAME=TDF_2_GDNBIN
SCR_PARM=5
SCR_LIST="data_format disk sat infile outfile"
SCR_VERS=040220.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`

echo " # "
echo " #  $SCR_NAME $* "
echo " # "
echo " #  Version $SCR_VERS "
echo " # "
echo " #  Run Date $DateTime "
echo " # "

#  if [ `expr $#` -lt 5 -o `expr $#` -gt 6 ]; then
#     echo "Usage: tdf data_format disk sat infile outfile [concar] 2> script_out &\007"
#     exit 1
#  fi

   data_format=$1
   disk=$2
   sat=$3
   infile=$4
   outfile=$5
   concar=$6
fi
++ '[' ']'
++ SCR_NAME=TDF_2_GDNBIN
++ SCR_PARM=5
++ SCR_LIST='data_format disk sat infile outfile'
++ SCR_VERS=040220.0
expr $#
+++ expr 5
++ '[' 5 -lt 5 ']'
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ DateTime='DATE: 03/30/24  TIME: 13:46:08'
++ echo ' # '
 # 
++ echo ' #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.ETA1.mr2 crddata.2024240323.ETA1_24.tdf '
 #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.ETA1.mr2 crddata.2024240323.ETA1_24.tdf 
++ echo ' # '
 # 
++ echo ' #  Version 040220.0 '
 #  Version 040220.0 
++ echo ' # '
 # 
++ echo ' #  Run Date DATE: 03/30/24  TIME: 13:46:08 '
 #  Run Date DATE: 03/30/24  TIME: 13:46:08 
++ echo ' # '
 # 
++ data_format=9
++ disk=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
++ sat=MLTSAT
++ infile=crddata.2024240323.ETA1.mr2
++ outfile=crddata.2024240323.ETA1_24.tdf
++ concar=

dir=`dirname $outfile`
dirname $outfile
+++ dirname crddata.2024240323.ETA1_24.tdf
++ dir=.

#
# determine the data format to be used
#
case $data_format in
   0) unit=22 ;;       #  Geodyn Binary
   2) unit=24 ;;       #  MERIT II SLR data
   3) unit=26 ;;       #  GEOS-3 Card image - 80 byte fmt
   4) unit=28 ;;       #  Extended Geodyn Binary (Altimetry)
   5) unit=30 ;;       #  PCE
   6) unit=32 ;;       #  Extended GEOS-3 Card image - 120 byte fmt
   7) unit=34 ;;       #  GPS Metric type fmt
   8) unit=36 ;;       #  VLBI Binary fmt
  10) unit=38 ;;
   9) unit=24 ;; ### mkc???  Merit-X SLR Data from CRD reformatter
   *) echo "tdf: Invalid Data Format Indicator: use 0-10 !!\007"; exit 1 ;;
esac
++ case $data_format in
++ unit=24

if   [ "$data_format" = "7" ]; then

   tdfcards=metric99.mtr
   concarnm=concarnm.mtr
   files=$infile

elif [ "$data_format" = "5" ]; then

   tdfcards=metric99.pce
   files=D$doy

elif [ "$data_format" = "0" ]; then

   tdfcards=metric99.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "2" ]; then

   tdfcards=merit2.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "9" ]; then

if [ "$SAT_DIR_S" = "ETA1" -o "$SAT_DIR_S" = "ETA2" ]; then
   tdfcards=merit9_E12.$YY
elif [ "$SAT_DIR_S" = "GISL1" -o "$SAT_DIR_S" = "GISL2" ]; then
   tdfcards=merit9_L12.$YY
elif [ "$SAT_DIR_S" = "LARES" -o "$SAT_DIR_S" = "STARL" -o "$SAT_DIR_S" = "AJISI" -o "$SAT_DIR_S" = "STELLA" ]; then
   tdfcards=merit9_AS.$YY
else
tdfcards=merit9.$YY
fi
 ### orginal independet fro any satellites  tdfcards=merit9.$YY
   concarnm=concarnm.bin
   files=$infile
fi
++ '[' 9 = 7 ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ '[' ETA1 = ETA1 -o ETA1 = ETA2 ']'
++ tdfcards=merit9_E12.24
++ concarnm=concarnm.bin
++ files=crddata.2024240323.ETA1.mr2

#
# make sure you have everything you need
#
if [ ! -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current ]; then
   echo $MAIN_PATH/MISSIONS/d_base/tabs/iers.current doesn\'t exist !
   exit 99
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current ']'
if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ]; then
   echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards doesn\'t exist !
   exit 98
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_E12.24 ']'
if [ $concar ]; then

   if [ ! -f $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ]; then
      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm doesn\'t exist !
      exit 97
   fi


#   if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist ]; then
#      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist doesn\'t exist !
#      exit 96
#   fi

elif [ "$data_format" = "7" -a ! -s /$disk/$sat/d_base/data/tdfphase.$infile.Z ]; then
   echo /$disk/$sat/d_base/data/tdfphase.$infile.Z doesn\'t exist !
   exit 99
fi
++ '[' ']'
++ '[' 9 = 7 -a '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/tdfphase.crddata.2024240323.ETA1.mr2.Z ']'

###if [ ! -d /$disk/$sat ]; then
###   mkdir /$disk/$sat
###fi
###
###if [ ! -d /$disk/$sat/d_base ]; then
###   mkdir /$disk/$sat/d_base
###fi
###
###if [ ! -d /$disk/$sat/d_base/data ]; the/\$MAIN_PATH/$MAIN_PATH
###   mkdir /$disk/$sat/d_base/data
###fi
###
###if [ ! -d /$disk/$sat/d_base/data/TDF ]; then
###   mkdir /$disk/$sat/d_base/data/TDF
###fi
###
###if [ ! -d /$disk/$sat/output/TDFout ]; then
###   mkdir /$disk/$sat/output/TDFout
###fi
###
###if [ "$dir" != "." ]; then
###   if [ ! -d /$disk/$sat/d_base/data/$dir ]; then
###      mkdir /$disk/$sat/d_base/data/$dir
###   fi
###fi

mkdir /$LOCALDSK/tdf$$
++ mkdir /tmp/tdf21490
cd /$LOCALDSK/tdf$$
++ cd /tmp/tdf21490

if [ $concar ]; then

   #
   # netpull the CONOGBed files from gibbs
   #
   files=`awk '{printf("%s "),$1 }' $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist `

ftp gibbs << EOF!!
prompt
case
ascii
cd \'$infile\'
mget $files
EOF!!

   #
   # cat the files in the order specified in memlist.  if only
   # one file, just link to it
   #
   numfiles=`wc -l $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist | awk ' {print $1} ' `
   if [ "$numfiles" = "1" ]; then
      ln -s /tmp/tdf$$/$files ftn10
   else
      cat $files > ftn10
   fi

   #
   # get concar control card and run it
   #
   ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ftn04
   echo "***"
   echo "***           RUN CONCAR"
   echo "***"
   /space/users/epavlis/EXECUTABLES/concar 1>tmpcon6 2>tmpcone
   \rm ftn10 ftn04
fi
++ '[' ']'
#
#  get tdf supporting data files and run it
#
if [ $concar ]; then
   if [ -s ftn11 ]; then               # use concar output if run
      mv ftn11 fort.$unit
   else
      echo CONCAR TERMINATED ABNORMALLY - EXITING
      exit 95
   fi
elif [ "$data_format" = "5" ]; then   # cat together PCE data
   count=1
   while [ $count -le 32 ]
   do
      prn=$count
      if [ $count -lt 10 ]; then
         prn=0$count
      fi
      if [ -f /$disk/$sat/PCEC/PRN${prn}/$infile.Z ]; then
         zcat /$disk/$sat/PCEC/PRN${prn}/$infile.Z >> fort.$unit
      fi
      count=`expr $count + 1`
   done
#
elif [ "$data_format" = "7" ]; then   # cp Metric data

   zcat /$disk/$sat/d_base/data/tdfphase.$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "0" ]; then   # Binary data   (e.g. SLR)

   zcat /$disk/$sat/d_base/data/G2B/$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "2" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!

elif [ "$data_format" = "9" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!
fi
++ '[' ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 7 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ zcat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.ETA1.mr2.gz

ln -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current     fort.2
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current fort.2
#
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ftn05
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_E12.24 ftn05
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF

echo "***"
++ echo '***'
***
echo "***           RUN TDF"
++ echo '***           RUN TDF'
***           RUN TDF
echo "***"
++ echo '***'
***
#exit 20181220

#NEW TDF for CRD_2_MERIT long np data
#/umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/${TDF2GDN} 1>tmptdf6 2>tmptdfe
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST_100525.x
TDF2GDYN=tdf1006p0_i64_gFORT.x
++ TDF2GDYN=tdf1006p0_i64_gFORT.x
TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
++ TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
++ TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
TDF2GDYN=tdf1006p1_i64.x
++ TDF2GDYN=tdf1006p1_i64.x
TDF2GDYN=tdf1006p2_i64M_180927.x  ## for P2 version
++ TDF2GDYN=tdf1006p2_i64M_180927.x
#/umbc/research/epavlis/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
#
#$MAIN_PATH/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
/umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
++ /umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdf1006p2_i64M_180927.x




echo
++ echo

echo
++ echo


ls -al
++ ls -al
total 632
drwxrwxr-x    2 magdak research   4096 Mar 30 13:46 .
drwxrwxrwt. 135 root   root      28672 Mar 30 13:46 ..
lrwxrwxrwx    1 magdak research     65 Mar 30 13:46 FILIST.DF -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF
lrwxrwxrwx    1 magdak research     67 Mar 30 13:46 fort.2 -> /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current
-rw-rw-r--    1 magdak research 234992 Mar 30 13:46 fort.24
-rw-rw-r--    1 magdak research 304304 Mar 30 13:46 fort.41
-rw-rw-r--    1 magdak research  47470 Mar 30 13:46 fort.90
lrwxrwxrwx    1 magdak research     69 Mar 30 13:46 ftn05 -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_E12.24
-rw-rw-r--    1 magdak research   1866 Mar 30 13:46 tmptdf6
-rw-rw-r--    1 magdak research      0 Mar 30 13:46 tmptdfe
pwd
++ pwd
/tmp/tdf21490


#
# append fort.90 tdf output to unit 5 output
#
#exit 20180920
cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90 > /$disk/$sat/output/TDFout/$outfile
++ cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90
cat: tmpcon6: No such file or directory
cat: tmpcone: No such file or directory
chmod 777 /$disk/$sat/output/TDFout/$outfile
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.ETA1_24.tdf
#rm -f $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${outfile}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${FILEQL}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "qldata.2012120501.${sat}_12.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
######printf "${SV}_${YY}.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
gzip -9 -f /$disk/$sat/output/TDFout/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.ETA1_24.tdf

#
# move tdf output to $disk and Unitree
#

mv fort.41 /$disk/$sat/d_base/data/TDF/${outfile}
++ mv fort.41 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.ETA1_24.tdf
chmod 777 /$disk/$sat/d_base/data/TDF/${outfile}
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.ETA1_24.tdf
gzip -9  -f /$disk/$sat/d_base/data/TDF/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.ETA1_24.tdf

#markd because was conflict with link for qldata-merit data
#cd /$disk/$sat/d_base/data/MRT2/
#rm ${YY}.${sat}.mr2.Z
#ln -s $infile.Z  ${sat}_${YY}.mrt2.Z
#ln -s $infile.Z  ${YY}.${sat}.mr2.Z
#chmod 777 ${YY}.${sat}.mr2.Z

cd /$disk/$sat/d_base/data/TDF
++ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF

#gzip -S .Z -f $outfile

#if [ "$data_format" = "0" -o "$data_format" = "2" -o "$data_format" = "9"  ]; then

echo $SV $YY
++ echo E1 24
E1 24
Date=`date +%y%m%d`
date +%y%m%d
+++ date +%y%m%d
++ Date=240330

####to be changed
#rm ${SV}_$YY.tdf_crd.Z
#rm ${SV}_$YY.tdf.Z
#ln -s $outfile.Z ${SV}_$YY.tdf_crd.Z
#ln -s $outfile.Z ${SV}_$YY.tdf.Z
#chmod 777 ${SV}_$YY.tdf_crd.Z

#fi


cd ..
++ cd ..
\rm -r /$LOCALDSK/tdf$$
++ rm -r /tmp/tdf21490
+ read sat SAT_DIR_S
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ mkdir temp17794
+ mkdir /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/ETA2
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/ETA2
+ cat
+ sed -e '1,$s/PP/23/g' -e '1,$s/pppp/2023/g' -e '1,$s/yyyy/2024/g' -e '1,$s/zzzz/2025/g' -e '1,$s/SAT/etalon2/g' -e '1,$s/MONTHC/03/g' input1
+ cp /umbc/research/magdak/.netrc_NO_EDC_LOG /umbc/research/magdak/.netrc
+ /usr/bin/ftp -p edc.dgfi.tum.de
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
+ cp /umbc/research/magdak/.netrc_EDC_LOG /umbc/research/magdak/.netrc
+ rm etalon2_202403.np2
+ cat etalon2_20240301.np2 etalon2_20240302.np2 etalon2_20240303.np2 etalon2_20240304.np2 etalon2_20240305.np2 etalon2_20240306.np2
+ cat etalon2_202401.np2 etalon2_202402.np2
+ cat etalon2_202312.np2
+ cat etalon2_202501.np2
cat: etalon2_202501.np2: No such file or directory
+ cp year.M1 ../.
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794
+ sed 's/^H/h/g' year.M1
+ sed s/h9H1/h1/ year.M1A
+ grep -v -e h9 -e '^30' year.M1C
+ grep -v -e h9 -e '^30' year.00C
grep: year.00C: No such file or directory
+ cat year.M1B year.00B
+ sed 's/^C/c/' year.ALL2
+ grep '^h2' year.ALL
+ cut -c1-18
+ sort -u -o strng1
+ cp year.ALL crddata.2024240323.ETA2
+ printf h9
+ cat H9
+ FILE=crddata.2024240323.ETA2
+ gzip -9 -f crddata.2024240323.ETA2
+ rm ../crddata.2024240323.ETA2.gz
rm: cannot remove ‘../crddata.2024240323.ETA2.gz’: No such file or directory
+ cp crddata.2024240323.ETA2.gz ../crddata.2024240323.ETA2.gz
+ cp year.ALL0 year.ALL ../.
cp: cannot stat ‘year.ALL0’: No such file or directory
+ chmod 777 ../crddata.2024240323.ETA2.gz
+ cd ..
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ OLD_FILE=crddata.2024240322.ETA2
+ FLAG=NO
+ sum crddata.2024240323.ETA2.gz
+ sum crddata.2024240322.ETA2.gz
sum: crddata.2024240322.ETA2.gz: No such file or directory
+ read nbts nblks nfl
+ read obts oblks ofl
+ '[140' ']'
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2: line 212: : No such file or directory
+ echo ' OLD QL file: '
+ cat old_sum_mkc
+ echo '  '
  
+ echo ' NEW QL file: '
+ cat new_sum_mkc
+ rm 2mail
+ rm -r temp17794
+ export FLAG OLD_FILE
+ echo crddata.2024240323.ETA2
crddata.2024240323.ETA2
+ echo MLTSAT
MLTSAT
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ gzip -d -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA2.gz
+ sed -e 's/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 0 2 0/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 2 2 0/' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA2
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA2
+ rm //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ /umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/CRD2_2_MRT_X_221204.x -i //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA2 -o //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
Convert CRD Fullrate to Merit II Format: version 2.01b 12/23/2028
crd_in = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA2]
cstg_out = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata]
+ '[' ETA2 = GISL1 ']'
+ '[' ETA2 = GISL2 ']'
+ '[' ETA2 = ETA1 ']'
+ '[' ETA2 = ETA2 ']'
+ no=8903903
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA2.gz
gzip: /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.ETA2.gz: No such file or directory
+ '[' MLTSAT = BLITS ']'
+ grep '^8903903' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/QLNP_2_TDFINP_CRD MLTSAT /umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ cp o.QLNP_2_TDFINP /tmp/magdak/o.QLNP_2_TDFINP_
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/SORT_DATA_BY_RELEASE_FLAG_P2 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT

#     SORT_DATA_BY_RELEASE_FLAG


SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
+ SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
SCR_PARM=2
+ SCR_PARM=2
SCR_LIST="disk"
+ SCR_LIST=disk
SCR_VERS=120711.0
+ SCR_VERS=120711.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi
expr $#
++ expr 2
+ '[' 2 -lt 2 ']'

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:46:23'

echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT '
 #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT 
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 120711.0 '
 #  Version 120711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:46:23 '
 #  Run Date DATE: 03/30/24  TIME: 13:46:23 
echo " # "
+ echo ' # '
 # 
disk=$1
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS
SAT_DIR=$2
+ SAT_DIR=MLTSAT
cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS TESTs
+ cp /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS TESTs
#cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS $disk/$SAT_DIR/d_base/data/MRT2/ALL_q
#COLLECT in separately file different release data
grep '41$' TESTs > 41
+ grep '41$' TESTs
grep '42$' TESTs > 42
+ grep '42$' TESTs
grep '43$' TESTs > 43
+ grep '43$' TESTs
grep '44$' TESTs > 44
+ grep '44$' TESTs

#remove name of the file from files
sed -e "s/TESTs://" 41 > 41a
+ sed -e s/TESTs:// 41
sed -e "s/TESTs://" 42 > 42a
+ sed -e s/TESTs:// 42
sed -e "s/TESTs://" 43 > 43a
+ sed -e s/TESTs:// 43
sed -e "s/TESTs://" 44 > 44a
+ sed -e s/TESTs:// 44

#cut files column 1-43
cut -c1-43 41a > 41aa
+ cut -c1-43 41a
cut -c1-43 42a > 42aa
+ cut -c1-43 42a
cut -c1-43 43a > 43aa
+ cut -c1-43 43a
cut -c1-43 44a > 44aa
+ cut -c1-43 44a

sed -e "s/ /0/g"  41aa > 41b
+ sed -e 's/ /0/g' 41aa
sed -e "s/ /0/g"  42aa > 42b
+ sed -e 's/ /0/g' 42aa
sed -e "s/ /0/g"  43aa > 43b
+ sed -e 's/ /0/g' 43aa
sed -e "s/ /0/g"  44aa > 44b
+ sed -e 's/ /0/g' 44aa

rm 41c 42c 43c  41d 42d 41e 4?_0
+ rm 41c 42c 43c 41d 42d 41e '4?_0'
rm: cannot remove ‘4?_0’: No such file or directory
#Check that data  and keep data only the higher release flag

if [ -s 44b  ]
then
while read line4
do
grep -v $line4 41b > 41c
cp 41c 41b
grep -v $line4 42b > 42c
cp 42c 42b
grep -v $line4 43b > 43c
cp 43c 43b
grep  $line4 44a >> 44_0

done < 44b
else
cp 41b 41c
cp 42b 42c
cp 43b 43c
fi
+ '[' -s 44b ']'
+ cp 41b 41c
+ cp 42b 42c
+ cp 43b 43c
#exit 2
if [ -s 43c  ]
then
while read line3
do
grep -v $line3 41c > 41d
cp 41d 41c
grep -v $line3 42c > 42d
cp 42d 42c
grep  $line3 43a >> 43_0
done < 43c
else
cp 41c 41d
cp 42c 42d
fi
+ '[' -s 43c ']'
+ cp 41c 41d
+ cp 42c 42d

if [ -s 42d  ]
then
while read line2
do
grep -v $line2 41d > 41e
cp 41e 41d
grep  $line2 42a >> 42_0
done < 42d
else
cp 41d 41e
fi
+ '[' -s 42d ']'
+ cp 41d 41e

if [ -s 41e  ]
then
while read line1
do
grep  $line1 41a >> 41_0
done < 41e
fi
+ '[' -s 41e ']'

#Remove from data file data which has reles flag bigger than "0"
cat 4?_0 > TD
+ cat '4?_0'
cat: 4?_0: No such file or directory
cut -c1-43 TD > TDD
+ cut -c1-43 TD
sort -u TDD > TS
+ sort -u TDD

cp TESTs T0
+ cp TESTs T0
if [ -s TS  ]
then
while read line0
do
grep -v $line0 T0 > T1
cp T1  T0
done < TS
fi
+ '[' -s TS ']'

#Add to data file data with the higer release flag and sort by time

cat TD >> T0
+ cat TD
sort -k1,43 T0 > TSS
+ sort -k1,43 T0


cp TSS /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS
+ cp TSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS


exit 0
+ exit 0
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.ETA2.mr2
+ grep -v '\-10030' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.ETA2.mr2
+ grep -v '\-1\-130' t10
+ cp t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.ETA2.mr2
+ rm -f //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.ETA2.mr2
+ '[' ETA2 = GISL1 ']'
+ '[' ETA2 = GISL2 ']'
+ '[' ETA2 = ETA1 ']'
+ '[' ETA2 = ETA2 ']'
+ DSK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ SV=E2
+ TAG=E2
+ FILEQL=qldata.2024240323.ETA2_24.tdf
+ export YY SV FILEQL SAT_DIR_S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.ETA2.mr2 crddata.2024240323.ETA2_24.tdf
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 1: !/bin/ksh: No such file or directory
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 4: #set: command not found

#  TDF_2_GDNBIN
#                                                               ecp       020318
#                                                               ecp       940310
#                                                               rob olson 950525
#
# Usage: TDF_2_GDNBIN data_format disk sat infile outfile [concar] 2> script_out &
#
# this shell script runs the TDF on various data formats.  if concar
# has ANY value (ie if there are 6 command line arguments), then
# this script ftp's the "CONOGBed" members listed in memlist from the
# IBM PDS given by infile, and first runs CONCAR on them
# before running the TDF.  otherwise, the
# location of infile on $disk depends on the data format selected.
# output from this script is netpushed to Unitree.
#
# NOTE:  1) the first command line argument is the GEODYN II
#           data format indicator
#        2) lines 161,177: if concar is to be run, verify path to memlist,
#           and note that the order of member names in memlist is the order
#           in which the files will be concatenated for concar input
#        3) line 225: use the polar motion tables you plan to use
#           when running GEODYN II
#        4) line 232: verify version of tdf executable
#        5) unit 90 output is placed in
#           /$disk/$sat/output/TDFout/$outfile
#        6) tdf binary output is placed in /$disk/$sat/d_base/data/TDF/$outfile
#  ecp   7) this new version allows for a "SAT" dependence in the dir path,
#           e.g. IGS92, IGS93, tp, lre, L1, etc.. It also picks the proper
#           "metric99" and "concarnm" control files depending on what
#           data format you specify with "data_format".
#        8) It seems that the "memlist" option has been disabled in this
#           version, but the member names are assumed to have the following
#           format depending again on the "data_format":
#               GPS (metric fmt) and PCE:  Dddd
#               Binary (e.g. SLR data) :   the entire name is specified in "doy"
#                                          the input in file "infile" of the
#                                          subtdf script.
#
#QSUB -s /bin/sh
#QSUB -r tdf_it!
#QSUB -q medium -eo
#QSUB -lM 15.0MW -lm 15.0MW
#QSUB -lT 2400 -lt 202395
#QSUB -A g926d
#QSUB -me

LOCALDSK=tmp
++ LOCALDSK=tmp

#
# interactive or batch ?
#
if [ $ENVIRONMENT ]; then
   if [ $ENVIRONMENT = "BATCH" ]; then
      if [ $wrapper ]; then
         read data_format disk sat infile outfile concar < /tmp/$USER/tdf.batch.$doy
      else
         read data_format disk sat infile outfile concar < $MAIN_PATH/INFILES/INF_OPS_D_CRD/tdf.batch
      fi
   else
      echo ENVIRONMENT = $ENVIRONMENT ?
      exit 99
   fi
else
 
SCR_NAME=TDF_2_GDNBIN
SCR_PARM=5
SCR_LIST="data_format disk sat infile outfile"
SCR_VERS=040220.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`

echo " # "
echo " #  $SCR_NAME $* "
echo " # "
echo " #  Version $SCR_VERS "
echo " # "
echo " #  Run Date $DateTime "
echo " # "

#  if [ `expr $#` -lt 5 -o `expr $#` -gt 6 ]; then
#     echo "Usage: tdf data_format disk sat infile outfile [concar] 2> script_out &\007"
#     exit 1
#  fi

   data_format=$1
   disk=$2
   sat=$3
   infile=$4
   outfile=$5
   concar=$6
fi
++ '[' ']'
++ SCR_NAME=TDF_2_GDNBIN
++ SCR_PARM=5
++ SCR_LIST='data_format disk sat infile outfile'
++ SCR_VERS=040220.0
expr $#
+++ expr 5
++ '[' 5 -lt 5 ']'
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ DateTime='DATE: 03/30/24  TIME: 13:46:24'
++ echo ' # '
 # 
++ echo ' #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.ETA2.mr2 crddata.2024240323.ETA2_24.tdf '
 #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.ETA2.mr2 crddata.2024240323.ETA2_24.tdf 
++ echo ' # '
 # 
++ echo ' #  Version 040220.0 '
 #  Version 040220.0 
++ echo ' # '
 # 
++ echo ' #  Run Date DATE: 03/30/24  TIME: 13:46:24 '
 #  Run Date DATE: 03/30/24  TIME: 13:46:24 
++ echo ' # '
 # 
++ data_format=9
++ disk=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
++ sat=MLTSAT
++ infile=crddata.2024240323.ETA2.mr2
++ outfile=crddata.2024240323.ETA2_24.tdf
++ concar=

dir=`dirname $outfile`
dirname $outfile
+++ dirname crddata.2024240323.ETA2_24.tdf
++ dir=.

#
# determine the data format to be used
#
case $data_format in
   0) unit=22 ;;       #  Geodyn Binary
   2) unit=24 ;;       #  MERIT II SLR data
   3) unit=26 ;;       #  GEOS-3 Card image - 80 byte fmt
   4) unit=28 ;;       #  Extended Geodyn Binary (Altimetry)
   5) unit=30 ;;       #  PCE
   6) unit=32 ;;       #  Extended GEOS-3 Card image - 120 byte fmt
   7) unit=34 ;;       #  GPS Metric type fmt
   8) unit=36 ;;       #  VLBI Binary fmt
  10) unit=38 ;;
   9) unit=24 ;; ### mkc???  Merit-X SLR Data from CRD reformatter
   *) echo "tdf: Invalid Data Format Indicator: use 0-10 !!\007"; exit 1 ;;
esac
++ case $data_format in
++ unit=24

if   [ "$data_format" = "7" ]; then

   tdfcards=metric99.mtr
   concarnm=concarnm.mtr
   files=$infile

elif [ "$data_format" = "5" ]; then

   tdfcards=metric99.pce
   files=D$doy

elif [ "$data_format" = "0" ]; then

   tdfcards=metric99.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "2" ]; then

   tdfcards=merit2.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "9" ]; then

if [ "$SAT_DIR_S" = "ETA1" -o "$SAT_DIR_S" = "ETA2" ]; then
   tdfcards=merit9_E12.$YY
elif [ "$SAT_DIR_S" = "GISL1" -o "$SAT_DIR_S" = "GISL2" ]; then
   tdfcards=merit9_L12.$YY
elif [ "$SAT_DIR_S" = "LARES" -o "$SAT_DIR_S" = "STARL" -o "$SAT_DIR_S" = "AJISI" -o "$SAT_DIR_S" = "STELLA" ]; then
   tdfcards=merit9_AS.$YY
else
tdfcards=merit9.$YY
fi
 ### orginal independet fro any satellites  tdfcards=merit9.$YY
   concarnm=concarnm.bin
   files=$infile
fi
++ '[' 9 = 7 ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ '[' ETA2 = ETA1 -o ETA2 = ETA2 ']'
++ tdfcards=merit9_E12.24
++ concarnm=concarnm.bin
++ files=crddata.2024240323.ETA2.mr2

#
# make sure you have everything you need
#
if [ ! -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current ]; then
   echo $MAIN_PATH/MISSIONS/d_base/tabs/iers.current doesn\'t exist !
   exit 99
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current ']'
if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ]; then
   echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards doesn\'t exist !
   exit 98
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_E12.24 ']'
if [ $concar ]; then

   if [ ! -f $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ]; then
      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm doesn\'t exist !
      exit 97
   fi


#   if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist ]; then
#      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist doesn\'t exist !
#      exit 96
#   fi

elif [ "$data_format" = "7" -a ! -s /$disk/$sat/d_base/data/tdfphase.$infile.Z ]; then
   echo /$disk/$sat/d_base/data/tdfphase.$infile.Z doesn\'t exist !
   exit 99
fi
++ '[' ']'
++ '[' 9 = 7 -a '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/tdfphase.crddata.2024240323.ETA2.mr2.Z ']'

###if [ ! -d /$disk/$sat ]; then
###   mkdir /$disk/$sat
###fi
###
###if [ ! -d /$disk/$sat/d_base ]; then
###   mkdir /$disk/$sat/d_base
###fi
###
###if [ ! -d /$disk/$sat/d_base/data ]; the/\$MAIN_PATH/$MAIN_PATH
###   mkdir /$disk/$sat/d_base/data
###fi
###
###if [ ! -d /$disk/$sat/d_base/data/TDF ]; then
###   mkdir /$disk/$sat/d_base/data/TDF
###fi
###
###if [ ! -d /$disk/$sat/output/TDFout ]; then
###   mkdir /$disk/$sat/output/TDFout
###fi
###
###if [ "$dir" != "." ]; then
###   if [ ! -d /$disk/$sat/d_base/data/$dir ]; then
###      mkdir /$disk/$sat/d_base/data/$dir
###   fi
###fi

mkdir /$LOCALDSK/tdf$$
++ mkdir /tmp/tdf21938
cd /$LOCALDSK/tdf$$
++ cd /tmp/tdf21938

if [ $concar ]; then

   #
   # netpull the CONOGBed files from gibbs
   #
   files=`awk '{printf("%s "),$1 }' $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist `

ftp gibbs << EOF!!
prompt
case
ascii
cd \'$infile\'
mget $files
EOF!!

   #
   # cat the files in the order specified in memlist.  if only
   # one file, just link to it
   #
   numfiles=`wc -l $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist | awk ' {print $1} ' `
   if [ "$numfiles" = "1" ]; then
      ln -s /tmp/tdf$$/$files ftn10
   else
      cat $files > ftn10
   fi

   #
   # get concar control card and run it
   #
   ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ftn04
   echo "***"
   echo "***           RUN CONCAR"
   echo "***"
   /space/users/epavlis/EXECUTABLES/concar 1>tmpcon6 2>tmpcone
   \rm ftn10 ftn04
fi
++ '[' ']'
#
#  get tdf supporting data files and run it
#
if [ $concar ]; then
   if [ -s ftn11 ]; then               # use concar output if run
      mv ftn11 fort.$unit
   else
      echo CONCAR TERMINATED ABNORMALLY - EXITING
      exit 95
   fi
elif [ "$data_format" = "5" ]; then   # cat together PCE data
   count=1
   while [ $count -le 32 ]
   do
      prn=$count
      if [ $count -lt 10 ]; then
         prn=0$count
      fi
      if [ -f /$disk/$sat/PCEC/PRN${prn}/$infile.Z ]; then
         zcat /$disk/$sat/PCEC/PRN${prn}/$infile.Z >> fort.$unit
      fi
      count=`expr $count + 1`
   done
#
elif [ "$data_format" = "7" ]; then   # cp Metric data

   zcat /$disk/$sat/d_base/data/tdfphase.$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "0" ]; then   # Binary data   (e.g. SLR)

   zcat /$disk/$sat/d_base/data/G2B/$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "2" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!

elif [ "$data_format" = "9" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!
fi
++ '[' ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 7 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ zcat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.ETA2.mr2.gz

ln -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current     fort.2
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current fort.2
#
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ftn05
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_E12.24 ftn05
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF

echo "***"
++ echo '***'
***
echo "***           RUN TDF"
++ echo '***           RUN TDF'
***           RUN TDF
echo "***"
++ echo '***'
***
#exit 20181220

#NEW TDF for CRD_2_MERIT long np data
#/umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/${TDF2GDN} 1>tmptdf6 2>tmptdfe
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST_100525.x
TDF2GDYN=tdf1006p0_i64_gFORT.x
++ TDF2GDYN=tdf1006p0_i64_gFORT.x
TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
++ TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
++ TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
TDF2GDYN=tdf1006p1_i64.x
++ TDF2GDYN=tdf1006p1_i64.x
TDF2GDYN=tdf1006p2_i64M_180927.x  ## for P2 version
++ TDF2GDYN=tdf1006p2_i64M_180927.x
#/umbc/research/epavlis/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
#
#$MAIN_PATH/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
/umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
++ /umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdf1006p2_i64M_180927.x




echo
++ echo

echo
++ echo


ls -al
++ ls -al
total 624
drwxrwxr-x    2 magdak research   4096 Mar 30 13:46 .
drwxrwxrwt. 136 root   root      28672 Mar 30 13:46 ..
lrwxrwxrwx    1 magdak research     65 Mar 30 13:46 FILIST.DF -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF
lrwxrwxrwx    1 magdak research     67 Mar 30 13:46 fort.2 -> /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current
-rw-rw-r--    1 magdak research 226784 Mar 30 13:46 fort.24
-rw-rw-r--    1 magdak research 304304 Mar 30 13:46 fort.41
-rw-rw-r--    1 magdak research  47992 Mar 30 13:46 fort.90
lrwxrwxrwx    1 magdak research     69 Mar 30 13:46 ftn05 -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_E12.24
-rw-rw-r--    1 magdak research   1866 Mar 30 13:46 tmptdf6
-rw-rw-r--    1 magdak research      0 Mar 30 13:46 tmptdfe
pwd
++ pwd
/tmp/tdf21938


#
# append fort.90 tdf output to unit 5 output
#
#exit 20180920
cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90 > /$disk/$sat/output/TDFout/$outfile
++ cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90
cat: tmpcon6: No such file or directory
cat: tmpcone: No such file or directory
chmod 777 /$disk/$sat/output/TDFout/$outfile
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.ETA2_24.tdf
#rm -f $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${outfile}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${FILEQL}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "qldata.2012120501.${sat}_12.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
######printf "${SV}_${YY}.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
gzip -9 -f /$disk/$sat/output/TDFout/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.ETA2_24.tdf

#
# move tdf output to $disk and Unitree
#

mv fort.41 /$disk/$sat/d_base/data/TDF/${outfile}
++ mv fort.41 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.ETA2_24.tdf
chmod 777 /$disk/$sat/d_base/data/TDF/${outfile}
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.ETA2_24.tdf
gzip -9  -f /$disk/$sat/d_base/data/TDF/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.ETA2_24.tdf

#markd because was conflict with link for qldata-merit data
#cd /$disk/$sat/d_base/data/MRT2/
#rm ${YY}.${sat}.mr2.Z
#ln -s $infile.Z  ${sat}_${YY}.mrt2.Z
#ln -s $infile.Z  ${YY}.${sat}.mr2.Z
#chmod 777 ${YY}.${sat}.mr2.Z

cd /$disk/$sat/d_base/data/TDF
++ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF

#gzip -S .Z -f $outfile

#if [ "$data_format" = "0" -o "$data_format" = "2" -o "$data_format" = "9"  ]; then

echo $SV $YY
++ echo E2 24
E2 24
Date=`date +%y%m%d`
date +%y%m%d
+++ date +%y%m%d
++ Date=240330

####to be changed
#rm ${SV}_$YY.tdf_crd.Z
#rm ${SV}_$YY.tdf.Z
#ln -s $outfile.Z ${SV}_$YY.tdf_crd.Z
#ln -s $outfile.Z ${SV}_$YY.tdf.Z
#chmod 777 ${SV}_$YY.tdf_crd.Z

#fi


cd ..
++ cd ..
\rm -r /$LOCALDSK/tdf$$
++ rm -r /tmp/tdf21938
+ read sat SAT_DIR_S
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ mkdir temp17794
+ mkdir /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/STARL
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/STARL
+ cat
+ sed -e '1,$s/PP/23/g' -e '1,$s/pppp/2023/g' -e '1,$s/yyyy/2024/g' -e '1,$s/zzzz/2025/g' -e '1,$s/SAT/starlette/g' -e '1,$s/MONTHC/03/g' input1
+ cp /umbc/research/magdak/.netrc_NO_EDC_LOG /umbc/research/magdak/.netrc
+ /usr/bin/ftp -p edc.dgfi.tum.de
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
+ cp /umbc/research/magdak/.netrc_EDC_LOG /umbc/research/magdak/.netrc
+ rm starlette_202403.np2
+ cat starlette_20240301.np2 starlette_20240302.np2 starlette_20240303.np2 starlette_20240304.np2 starlette_20240305.np2 starlette_20240306.np2 starlette_20240307.np2 starlette_20240308.np2 starlette_20240309.np2 starlette_20240310.np2 starlette_20240311.np2 starlette_20240312.np2 starlette_20240313.np2 starlette_20240314.np2 starlette_20240315.np2 starlette_20240316.np2
+ cat starlette_202401.np2 starlette_202402.np2
+ cat starlette_202312.np2
+ cat starlette_202501.np2
cat: starlette_202501.np2: No such file or directory
+ cp year.M1 ../.
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794
+ sed 's/^H/h/g' year.M1
+ sed s/h9H1/h1/ year.M1A
+ grep -v -e h9 -e '^30' year.M1C
+ grep -v -e h9 -e '^30' year.00C
grep: year.00C: No such file or directory
+ cat year.M1B year.00B
+ sed 's/^C/c/' year.ALL2
+ grep '^h2' year.ALL
+ sort -u -o strng1
+ cut -c1-18
+ cp year.ALL crddata.2024240323.STARL
+ printf h9
+ cat H9
+ FILE=crddata.2024240323.STARL
+ gzip -9 -f crddata.2024240323.STARL
+ rm ../crddata.2024240323.STARL.gz
rm: cannot remove ‘../crddata.2024240323.STARL.gz’: No such file or directory
+ cp crddata.2024240323.STARL.gz ../crddata.2024240323.STARL.gz
+ cp year.ALL0 year.ALL ../.
cp: cannot stat ‘year.ALL0’: No such file or directory
+ chmod 777 ../crddata.2024240323.STARL.gz
+ cd ..
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ OLD_FILE=crddata.2024240322.STARL
+ FLAG=NO
+ sum crddata.2024240323.STARL.gz
+ sum crddata.2024240322.STARL.gz
sum: crddata.2024240322.STARL.gz: No such file or directory
+ read nbts nblks nfl
+ read obts oblks ofl
+ '[1141' ']'
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2: line 212: : No such file or directory
+ echo ' OLD QL file: '
+ cat old_sum_mkc
+ echo '  '
  
+ echo ' NEW QL file: '
+ cat new_sum_mkc
+ rm 2mail
+ rm -r temp17794
+ export FLAG OLD_FILE
+ echo crddata.2024240323.STARL
crddata.2024240323.STARL
+ echo MLTSAT
MLTSAT
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ gzip -d -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STARL.gz
+ sed -e 's/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 0 2 0/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 2 2 0/' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STARL
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STARL
+ rm //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ /umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/CRD2_2_MRT_X_221204.x -i //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STARL -o //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
Convert CRD Fullrate to Merit II Format: version 2.01b 12/23/2028
crd_in = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STARL]
cstg_out = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata]
+ '[' STARL = GISL1 ']'
+ '[' STARL = GISL2 ']'
+ '[' STARL = ETA1 ']'
+ '[' STARL = ETA2 ']'
+ '[' STARL = STARL ']'
+ no=7501001
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STARL.gz
gzip: /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STARL.gz: No such file or directory
+ '[' MLTSAT = BLITS ']'
+ grep '^7501001' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/QLNP_2_TDFINP_CRD MLTSAT /umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ cp o.QLNP_2_TDFINP /tmp/magdak/o.QLNP_2_TDFINP_
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/SORT_DATA_BY_RELEASE_FLAG_P2 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT

#     SORT_DATA_BY_RELEASE_FLAG


SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
+ SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
SCR_PARM=2
+ SCR_PARM=2
SCR_LIST="disk"
+ SCR_LIST=disk
SCR_VERS=120711.0
+ SCR_VERS=120711.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi
expr $#
++ expr 2
+ '[' 2 -lt 2 ']'

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:46:52'

echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT '
 #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT 
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 120711.0 '
 #  Version 120711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:46:52 '
 #  Run Date DATE: 03/30/24  TIME: 13:46:52 
echo " # "
+ echo ' # '
 # 
disk=$1
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS
SAT_DIR=$2
+ SAT_DIR=MLTSAT
cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS TESTs
+ cp /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS TESTs
#cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS $disk/$SAT_DIR/d_base/data/MRT2/ALL_q
#COLLECT in separately file different release data
grep '41$' TESTs > 41
+ grep '41$' TESTs
grep '42$' TESTs > 42
+ grep '42$' TESTs
grep '43$' TESTs > 43
+ grep '43$' TESTs
grep '44$' TESTs > 44
+ grep '44$' TESTs

#remove name of the file from files
sed -e "s/TESTs://" 41 > 41a
+ sed -e s/TESTs:// 41
sed -e "s/TESTs://" 42 > 42a
+ sed -e s/TESTs:// 42
sed -e "s/TESTs://" 43 > 43a
+ sed -e s/TESTs:// 43
sed -e "s/TESTs://" 44 > 44a
+ sed -e s/TESTs:// 44

#cut files column 1-43
cut -c1-43 41a > 41aa
+ cut -c1-43 41a
cut -c1-43 42a > 42aa
+ cut -c1-43 42a
cut -c1-43 43a > 43aa
+ cut -c1-43 43a
cut -c1-43 44a > 44aa
+ cut -c1-43 44a

sed -e "s/ /0/g"  41aa > 41b
+ sed -e 's/ /0/g' 41aa
sed -e "s/ /0/g"  42aa > 42b
+ sed -e 's/ /0/g' 42aa
sed -e "s/ /0/g"  43aa > 43b
+ sed -e 's/ /0/g' 43aa
sed -e "s/ /0/g"  44aa > 44b
+ sed -e 's/ /0/g' 44aa

rm 41c 42c 43c  41d 42d 41e 4?_0
+ rm 41c 42c 43c 41d 42d 41e '4?_0'
rm: cannot remove ‘4?_0’: No such file or directory
#Check that data  and keep data only the higher release flag

if [ -s 44b  ]
then
while read line4
do
grep -v $line4 41b > 41c
cp 41c 41b
grep -v $line4 42b > 42c
cp 42c 42b
grep -v $line4 43b > 43c
cp 43c 43b
grep  $line4 44a >> 44_0

done < 44b
else
cp 41b 41c
cp 42b 42c
cp 43b 43c
fi
+ '[' -s 44b ']'
+ cp 41b 41c
+ cp 42b 42c
+ cp 43b 43c
#exit 2
if [ -s 43c  ]
then
while read line3
do
grep -v $line3 41c > 41d
cp 41d 41c
grep -v $line3 42c > 42d
cp 42d 42c
grep  $line3 43a >> 43_0
done < 43c
else
cp 41c 41d
cp 42c 42d
fi
+ '[' -s 43c ']'
+ cp 41c 41d
+ cp 42c 42d

if [ -s 42d  ]
then
while read line2
do
grep -v $line2 41d > 41e
cp 41e 41d
grep  $line2 42a >> 42_0
done < 42d
else
cp 41d 41e
fi
+ '[' -s 42d ']'
+ cp 41d 41e

if [ -s 41e  ]
then
while read line1
do
grep  $line1 41a >> 41_0
done < 41e
fi
+ '[' -s 41e ']'

#Remove from data file data which has reles flag bigger than "0"
cat 4?_0 > TD
+ cat '4?_0'
cat: 4?_0: No such file or directory
cut -c1-43 TD > TDD
+ cut -c1-43 TD
sort -u TDD > TS
+ sort -u TDD

cp TESTs T0
+ cp TESTs T0
if [ -s TS  ]
then
while read line0
do
grep -v $line0 T0 > T1
cp T1  T0
done < TS
fi
+ '[' -s TS ']'

#Add to data file data with the higer release flag and sort by time

cat TD >> T0
+ cat TD
sort -k1,43 T0 > TSS
+ sort -k1,43 T0


cp TSS /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS
+ cp TSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS


exit 0
+ exit 0
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.STARL.mr2
+ grep -v '\-10030' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.STARL.mr2
+ grep -v '\-1\-130' t10
+ cp t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.STARL.mr2
+ rm -f //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.STARL.mr2
+ '[' STARL = GISL1 ']'
+ '[' STARL = GISL2 ']'
+ '[' STARL = ETA1 ']'
+ '[' STARL = ETA2 ']'
+ '[' STARL = CHAMP ']'
+ '[' STARL = ERS1 ']'
+ '[' STARL = AJISI ']'
+ '[' STARL = STARL ']'
+ DSK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ SV=STR
+ TAG=STR
+ FILEQL=qldata.2024240323.STARL_24.tdf
+ export YY SV FILEQL SAT_DIR_S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.STARL.mr2 crddata.2024240323.STARL_24.tdf
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 1: !/bin/ksh: No such file or directory
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 4: #set: command not found

#  TDF_2_GDNBIN
#                                                               ecp       020318
#                                                               ecp       940310
#                                                               rob olson 950525
#
# Usage: TDF_2_GDNBIN data_format disk sat infile outfile [concar] 2> script_out &
#
# this shell script runs the TDF on various data formats.  if concar
# has ANY value (ie if there are 6 command line arguments), then
# this script ftp's the "CONOGBed" members listed in memlist from the
# IBM PDS given by infile, and first runs CONCAR on them
# before running the TDF.  otherwise, the
# location of infile on $disk depends on the data format selected.
# output from this script is netpushed to Unitree.
#
# NOTE:  1) the first command line argument is the GEODYN II
#           data format indicator
#        2) lines 161,177: if concar is to be run, verify path to memlist,
#           and note that the order of member names in memlist is the order
#           in which the files will be concatenated for concar input
#        3) line 225: use the polar motion tables you plan to use
#           when running GEODYN II
#        4) line 232: verify version of tdf executable
#        5) unit 90 output is placed in
#           /$disk/$sat/output/TDFout/$outfile
#        6) tdf binary output is placed in /$disk/$sat/d_base/data/TDF/$outfile
#  ecp   7) this new version allows for a "SAT" dependence in the dir path,
#           e.g. IGS92, IGS93, tp, lre, L1, etc.. It also picks the proper
#           "metric99" and "concarnm" control files depending on what
#           data format you specify with "data_format".
#        8) It seems that the "memlist" option has been disabled in this
#           version, but the member names are assumed to have the following
#           format depending again on the "data_format":
#               GPS (metric fmt) and PCE:  Dddd
#               Binary (e.g. SLR data) :   the entire name is specified in "doy"
#                                          the input in file "infile" of the
#                                          subtdf script.
#
#QSUB -s /bin/sh
#QSUB -r tdf_it!
#QSUB -q medium -eo
#QSUB -lM 15.0MW -lm 15.0MW
#QSUB -lT 2400 -lt 202395
#QSUB -A g926d
#QSUB -me

LOCALDSK=tmp
++ LOCALDSK=tmp

#
# interactive or batch ?
#
if [ $ENVIRONMENT ]; then
   if [ $ENVIRONMENT = "BATCH" ]; then
      if [ $wrapper ]; then
         read data_format disk sat infile outfile concar < /tmp/$USER/tdf.batch.$doy
      else
         read data_format disk sat infile outfile concar < $MAIN_PATH/INFILES/INF_OPS_D_CRD/tdf.batch
      fi
   else
      echo ENVIRONMENT = $ENVIRONMENT ?
      exit 99
   fi
else
 
SCR_NAME=TDF_2_GDNBIN
SCR_PARM=5
SCR_LIST="data_format disk sat infile outfile"
SCR_VERS=040220.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`

echo " # "
echo " #  $SCR_NAME $* "
echo " # "
echo " #  Version $SCR_VERS "
echo " # "
echo " #  Run Date $DateTime "
echo " # "

#  if [ `expr $#` -lt 5 -o `expr $#` -gt 6 ]; then
#     echo "Usage: tdf data_format disk sat infile outfile [concar] 2> script_out &\007"
#     exit 1
#  fi

   data_format=$1
   disk=$2
   sat=$3
   infile=$4
   outfile=$5
   concar=$6
fi
++ '[' ']'
++ SCR_NAME=TDF_2_GDNBIN
++ SCR_PARM=5
++ SCR_LIST='data_format disk sat infile outfile'
++ SCR_VERS=040220.0
expr $#
+++ expr 5
++ '[' 5 -lt 5 ']'
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ DateTime='DATE: 03/30/24  TIME: 13:46:54'
++ echo ' # '
 # 
++ echo ' #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.STARL.mr2 crddata.2024240323.STARL_24.tdf '
 #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.STARL.mr2 crddata.2024240323.STARL_24.tdf 
++ echo ' # '
 # 
++ echo ' #  Version 040220.0 '
 #  Version 040220.0 
++ echo ' # '
 # 
++ echo ' #  Run Date DATE: 03/30/24  TIME: 13:46:54 '
 #  Run Date DATE: 03/30/24  TIME: 13:46:54 
++ echo ' # '
 # 
++ data_format=9
++ disk=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
++ sat=MLTSAT
++ infile=crddata.2024240323.STARL.mr2
++ outfile=crddata.2024240323.STARL_24.tdf
++ concar=

dir=`dirname $outfile`
dirname $outfile
+++ dirname crddata.2024240323.STARL_24.tdf
++ dir=.

#
# determine the data format to be used
#
case $data_format in
   0) unit=22 ;;       #  Geodyn Binary
   2) unit=24 ;;       #  MERIT II SLR data
   3) unit=26 ;;       #  GEOS-3 Card image - 80 byte fmt
   4) unit=28 ;;       #  Extended Geodyn Binary (Altimetry)
   5) unit=30 ;;       #  PCE
   6) unit=32 ;;       #  Extended GEOS-3 Card image - 120 byte fmt
   7) unit=34 ;;       #  GPS Metric type fmt
   8) unit=36 ;;       #  VLBI Binary fmt
  10) unit=38 ;;
   9) unit=24 ;; ### mkc???  Merit-X SLR Data from CRD reformatter
   *) echo "tdf: Invalid Data Format Indicator: use 0-10 !!\007"; exit 1 ;;
esac
++ case $data_format in
++ unit=24

if   [ "$data_format" = "7" ]; then

   tdfcards=metric99.mtr
   concarnm=concarnm.mtr
   files=$infile

elif [ "$data_format" = "5" ]; then

   tdfcards=metric99.pce
   files=D$doy

elif [ "$data_format" = "0" ]; then

   tdfcards=metric99.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "2" ]; then

   tdfcards=merit2.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "9" ]; then

if [ "$SAT_DIR_S" = "ETA1" -o "$SAT_DIR_S" = "ETA2" ]; then
   tdfcards=merit9_E12.$YY
elif [ "$SAT_DIR_S" = "GISL1" -o "$SAT_DIR_S" = "GISL2" ]; then
   tdfcards=merit9_L12.$YY
elif [ "$SAT_DIR_S" = "LARES" -o "$SAT_DIR_S" = "STARL" -o "$SAT_DIR_S" = "AJISI" -o "$SAT_DIR_S" = "STELLA" ]; then
   tdfcards=merit9_AS.$YY
else
tdfcards=merit9.$YY
fi
 ### orginal independet fro any satellites  tdfcards=merit9.$YY
   concarnm=concarnm.bin
   files=$infile
fi
++ '[' 9 = 7 ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ '[' STARL = ETA1 -o STARL = ETA2 ']'
++ '[' STARL = GISL1 -o STARL = GISL2 ']'
++ '[' STARL = LARES -o STARL = STARL -o STARL = AJISI -o STARL = STELLA ']'
++ tdfcards=merit9_AS.24
++ concarnm=concarnm.bin
++ files=crddata.2024240323.STARL.mr2

#
# make sure you have everything you need
#
if [ ! -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current ]; then
   echo $MAIN_PATH/MISSIONS/d_base/tabs/iers.current doesn\'t exist !
   exit 99
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current ']'
if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ]; then
   echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards doesn\'t exist !
   exit 98
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24 ']'
if [ $concar ]; then

   if [ ! -f $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ]; then
      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm doesn\'t exist !
      exit 97
   fi


#   if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist ]; then
#      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist doesn\'t exist !
#      exit 96
#   fi

elif [ "$data_format" = "7" -a ! -s /$disk/$sat/d_base/data/tdfphase.$infile.Z ]; then
   echo /$disk/$sat/d_base/data/tdfphase.$infile.Z doesn\'t exist !
   exit 99
fi
++ '[' ']'
++ '[' 9 = 7 -a '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/tdfphase.crddata.2024240323.STARL.mr2.Z ']'

###if [ ! -d /$disk/$sat ]; then
###   mkdir /$disk/$sat
###fi
###
###if [ ! -d /$disk/$sat/d_base ]; then
###   mkdir /$disk/$sat/d_base
###fi
###
###if [ ! -d /$disk/$sat/d_base/data ]; the/\$MAIN_PATH/$MAIN_PATH
###   mkdir /$disk/$sat/d_base/data
###fi
###
###if [ ! -d /$disk/$sat/d_base/data/TDF ]; then
###   mkdir /$disk/$sat/d_base/data/TDF
###fi
###
###if [ ! -d /$disk/$sat/output/TDFout ]; then
###   mkdir /$disk/$sat/output/TDFout
###fi
###
###if [ "$dir" != "." ]; then
###   if [ ! -d /$disk/$sat/d_base/data/$dir ]; then
###      mkdir /$disk/$sat/d_base/data/$dir
###   fi
###fi

mkdir /$LOCALDSK/tdf$$
++ mkdir /tmp/tdf22151
cd /$LOCALDSK/tdf$$
++ cd /tmp/tdf22151

if [ $concar ]; then

   #
   # netpull the CONOGBed files from gibbs
   #
   files=`awk '{printf("%s "),$1 }' $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist `

ftp gibbs << EOF!!
prompt
case
ascii
cd \'$infile\'
mget $files
EOF!!

   #
   # cat the files in the order specified in memlist.  if only
   # one file, just link to it
   #
   numfiles=`wc -l $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist | awk ' {print $1} ' `
   if [ "$numfiles" = "1" ]; then
      ln -s /tmp/tdf$$/$files ftn10
   else
      cat $files > ftn10
   fi

   #
   # get concar control card and run it
   #
   ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ftn04
   echo "***"
   echo "***           RUN CONCAR"
   echo "***"
   /space/users/epavlis/EXECUTABLES/concar 1>tmpcon6 2>tmpcone
   \rm ftn10 ftn04
fi
++ '[' ']'
#
#  get tdf supporting data files and run it
#
if [ $concar ]; then
   if [ -s ftn11 ]; then               # use concar output if run
      mv ftn11 fort.$unit
   else
      echo CONCAR TERMINATED ABNORMALLY - EXITING
      exit 95
   fi
elif [ "$data_format" = "5" ]; then   # cat together PCE data
   count=1
   while [ $count -le 32 ]
   do
      prn=$count
      if [ $count -lt 10 ]; then
         prn=0$count
      fi
      if [ -f /$disk/$sat/PCEC/PRN${prn}/$infile.Z ]; then
         zcat /$disk/$sat/PCEC/PRN${prn}/$infile.Z >> fort.$unit
      fi
      count=`expr $count + 1`
   done
#
elif [ "$data_format" = "7" ]; then   # cp Metric data

   zcat /$disk/$sat/d_base/data/tdfphase.$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "0" ]; then   # Binary data   (e.g. SLR)

   zcat /$disk/$sat/d_base/data/G2B/$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "2" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!

elif [ "$data_format" = "9" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!
fi
++ '[' ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 7 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ zcat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.STARL.mr2.gz

ln -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current     fort.2
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current fort.2
#
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ftn05
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24 ftn05
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF

echo "***"
++ echo '***'
***
echo "***           RUN TDF"
++ echo '***           RUN TDF'
***           RUN TDF
echo "***"
++ echo '***'
***
#exit 20181220

#NEW TDF for CRD_2_MERIT long np data
#/umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/${TDF2GDN} 1>tmptdf6 2>tmptdfe
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST_100525.x
TDF2GDYN=tdf1006p0_i64_gFORT.x
++ TDF2GDYN=tdf1006p0_i64_gFORT.x
TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
++ TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
++ TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
TDF2GDYN=tdf1006p1_i64.x
++ TDF2GDYN=tdf1006p1_i64.x
TDF2GDYN=tdf1006p2_i64M_180927.x  ## for P2 version
++ TDF2GDYN=tdf1006p2_i64M_180927.x
#/umbc/research/epavlis/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
#
#$MAIN_PATH/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
/umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
++ /umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdf1006p2_i64M_180927.x




echo
++ echo

echo
++ echo


ls -al
++ ls -al
total 7252
drwxrwxr-x    2 magdak research    4096 Mar 30 13:46 .
drwxrwxrwt. 136 root   root       28672 Mar 30 13:46 ..
lrwxrwxrwx    1 magdak research      65 Mar 30 13:46 FILIST.DF -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF
lrwxrwxrwx    1 magdak research      67 Mar 30 13:46 fort.2 -> /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current
-rw-rw-r--    1 magdak research 3233648 Mar 30 13:46 fort.24
-rw-rw-r--    1 magdak research 3795792 Mar 30 13:46 fort.41
-rw-rw-r--    1 magdak research  339959 Mar 30 13:46 fort.90
lrwxrwxrwx    1 magdak research      68 Mar 30 13:46 ftn05 -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24
-rw-rw-r--    1 magdak research    1866 Mar 30 13:46 tmptdf6
-rw-rw-r--    1 magdak research       0 Mar 30 13:46 tmptdfe
pwd
++ pwd
/tmp/tdf22151


#
# append fort.90 tdf output to unit 5 output
#
#exit 20180920
cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90 > /$disk/$sat/output/TDFout/$outfile
++ cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90
cat: tmpcon6: No such file or directory
cat: tmpcone: No such file or directory
chmod 777 /$disk/$sat/output/TDFout/$outfile
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.STARL_24.tdf
#rm -f $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${outfile}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${FILEQL}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "qldata.2012120501.${sat}_12.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
######printf "${SV}_${YY}.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
gzip -9 -f /$disk/$sat/output/TDFout/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.STARL_24.tdf

#
# move tdf output to $disk and Unitree
#

mv fort.41 /$disk/$sat/d_base/data/TDF/${outfile}
++ mv fort.41 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.STARL_24.tdf
chmod 777 /$disk/$sat/d_base/data/TDF/${outfile}
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.STARL_24.tdf
gzip -9  -f /$disk/$sat/d_base/data/TDF/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.STARL_24.tdf

#markd because was conflict with link for qldata-merit data
#cd /$disk/$sat/d_base/data/MRT2/
#rm ${YY}.${sat}.mr2.Z
#ln -s $infile.Z  ${sat}_${YY}.mrt2.Z
#ln -s $infile.Z  ${YY}.${sat}.mr2.Z
#chmod 777 ${YY}.${sat}.mr2.Z

cd /$disk/$sat/d_base/data/TDF
++ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF

#gzip -S .Z -f $outfile

#if [ "$data_format" = "0" -o "$data_format" = "2" -o "$data_format" = "9"  ]; then

echo $SV $YY
++ echo STR 24
STR 24
Date=`date +%y%m%d`
date +%y%m%d
+++ date +%y%m%d
++ Date=240330

####to be changed
#rm ${SV}_$YY.tdf_crd.Z
#rm ${SV}_$YY.tdf.Z
#ln -s $outfile.Z ${SV}_$YY.tdf_crd.Z
#ln -s $outfile.Z ${SV}_$YY.tdf.Z
#chmod 777 ${SV}_$YY.tdf_crd.Z

#fi


cd ..
++ cd ..
\rm -r /$LOCALDSK/tdf$$
++ rm -r /tmp/tdf22151
+ read sat SAT_DIR_S
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ mkdir temp17794
+ mkdir /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/AJISI
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/AJISI
+ cat
+ sed -e '1,$s/PP/23/g' -e '1,$s/pppp/2023/g' -e '1,$s/yyyy/2024/g' -e '1,$s/zzzz/2025/g' -e '1,$s/SAT/ajisai/g' -e '1,$s/MONTHC/03/g' input1
+ cp /umbc/research/magdak/.netrc_NO_EDC_LOG /umbc/research/magdak/.netrc
+ /usr/bin/ftp -p edc.dgfi.tum.de
+ cp /umbc/research/magdak/.netrc_EDC_LOG /umbc/research/magdak/.netrc
+ rm ajisai_202403.np2
rm: cannot remove ‘ajisai_202403.np2’: No such file or directory
+ cat 'ajisai_202403??.np2'
cat: ajisai_202403??.np2: No such file or directory
+ cat 'ajisai_2024??.np2'
cat: ajisai_2024??.np2: No such file or directory
+ cat ajisai_202312.np2
cat: ajisai_202312.np2: No such file or directory
+ cat ajisai_202501.np2
cat: ajisai_202501.np2: No such file or directory
+ cp year.M1 ../.
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794
+ sed 's/^H/h/g' year.M1
+ sed s/h9H1/h1/ year.M1A
+ grep -v -e h9 -e '^30' year.M1C
+ grep -v -e h9 -e '^30' year.00C
grep: year.00C: No such file or directory
+ cat year.M1B year.00B
+ sed 's/^C/c/' year.ALL2
+ grep '^h2' year.ALL
+ sort -u -o strng1
+ cut -c1-18
+ cp year.ALL crddata.2024240323.AJISI
+ printf h9
+ cat H9
+ FILE=crddata.2024240323.AJISI
+ gzip -9 -f crddata.2024240323.AJISI
+ rm ../crddata.2024240323.AJISI.gz
rm: cannot remove ‘../crddata.2024240323.AJISI.gz’: No such file or directory
+ cp crddata.2024240323.AJISI.gz ../crddata.2024240323.AJISI.gz
+ cp year.ALL0 year.ALL ../.
cp: cannot stat ‘year.ALL0’: No such file or directory
+ chmod 777 ../crddata.2024240323.AJISI.gz
+ cd ..
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ OLD_FILE=crddata.2024240322.AJISI
+ FLAG=NO
+ sum crddata.2024240323.AJISI.gz
+ sum crddata.2024240322.AJISI.gz
sum: crddata.2024240322.AJISI.gz: No such file or directory
+ read nbts nblks nfl
+ read obts oblks ofl
+ '[1' ']'
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2: line 212: : No such file or directory
+ echo ' OLD QL file: '
+ cat old_sum_mkc
+ echo '  '
  
+ echo ' NEW QL file: '
+ cat new_sum_mkc
+ rm 2mail
+ rm -r temp17794
+ export FLAG OLD_FILE
+ echo crddata.2024240323.AJISI
crddata.2024240323.AJISI
+ echo MLTSAT
MLTSAT
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ gzip -d -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.AJISI.gz
+ sed -e 's/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 0 2 0/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 2 2 0/' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.AJISI
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.AJISI
+ rm //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ /umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/CRD2_2_MRT_X_221204.x -i //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.AJISI -o //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
Convert CRD Fullrate to Merit II Format: version 2.01b 12/23/2028
crd_in = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.AJISI]
cstg_out = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata]
+ '[' AJISI = GISL1 ']'
+ '[' AJISI = GISL2 ']'
+ '[' AJISI = ETA1 ']'
+ '[' AJISI = ETA2 ']'
+ '[' AJISI = STARL ']'
+ '[' AJISI = AJISI ']'
+ no=8606101
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.AJISI.gz
gzip: /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.AJISI.gz: No such file or directory
+ '[' MLTSAT = BLITS ']'
+ grep '^8606101' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/QLNP_2_TDFINP_CRD MLTSAT /umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ cp o.QLNP_2_TDFINP /tmp/magdak/o.QLNP_2_TDFINP_
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/SORT_DATA_BY_RELEASE_FLAG_P2 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT

#     SORT_DATA_BY_RELEASE_FLAG


SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
+ SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
SCR_PARM=2
+ SCR_PARM=2
SCR_LIST="disk"
+ SCR_LIST=disk
SCR_VERS=120711.0
+ SCR_VERS=120711.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi
expr $#
++ expr 2
+ '[' 2 -lt 2 ']'

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:46:56'

echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT '
 #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT 
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 120711.0 '
 #  Version 120711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:46:56 '
 #  Run Date DATE: 03/30/24  TIME: 13:46:56 
echo " # "
+ echo ' # '
 # 
disk=$1
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS
SAT_DIR=$2
+ SAT_DIR=MLTSAT
cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS TESTs
+ cp /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS TESTs
#cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS $disk/$SAT_DIR/d_base/data/MRT2/ALL_q
#COLLECT in separately file different release data
grep '41$' TESTs > 41
+ grep '41$' TESTs
grep '42$' TESTs > 42
+ grep '42$' TESTs
grep '43$' TESTs > 43
+ grep '43$' TESTs
grep '44$' TESTs > 44
+ grep '44$' TESTs

#remove name of the file from files
sed -e "s/TESTs://" 41 > 41a
+ sed -e s/TESTs:// 41
sed -e "s/TESTs://" 42 > 42a
+ sed -e s/TESTs:// 42
sed -e "s/TESTs://" 43 > 43a
+ sed -e s/TESTs:// 43
sed -e "s/TESTs://" 44 > 44a
+ sed -e s/TESTs:// 44

#cut files column 1-43
cut -c1-43 41a > 41aa
+ cut -c1-43 41a
cut -c1-43 42a > 42aa
+ cut -c1-43 42a
cut -c1-43 43a > 43aa
+ cut -c1-43 43a
cut -c1-43 44a > 44aa
+ cut -c1-43 44a

sed -e "s/ /0/g"  41aa > 41b
+ sed -e 's/ /0/g' 41aa
sed -e "s/ /0/g"  42aa > 42b
+ sed -e 's/ /0/g' 42aa
sed -e "s/ /0/g"  43aa > 43b
+ sed -e 's/ /0/g' 43aa
sed -e "s/ /0/g"  44aa > 44b
+ sed -e 's/ /0/g' 44aa

rm 41c 42c 43c  41d 42d 41e 4?_0
+ rm 41c 42c 43c 41d 42d 41e '4?_0'
rm: cannot remove ‘4?_0’: No such file or directory
#Check that data  and keep data only the higher release flag

if [ -s 44b  ]
then
while read line4
do
grep -v $line4 41b > 41c
cp 41c 41b
grep -v $line4 42b > 42c
cp 42c 42b
grep -v $line4 43b > 43c
cp 43c 43b
grep  $line4 44a >> 44_0

done < 44b
else
cp 41b 41c
cp 42b 42c
cp 43b 43c
fi
+ '[' -s 44b ']'
+ cp 41b 41c
+ cp 42b 42c
+ cp 43b 43c
#exit 2
if [ -s 43c  ]
then
while read line3
do
grep -v $line3 41c > 41d
cp 41d 41c
grep -v $line3 42c > 42d
cp 42d 42c
grep  $line3 43a >> 43_0
done < 43c
else
cp 41c 41d
cp 42c 42d
fi
+ '[' -s 43c ']'
+ cp 41c 41d
+ cp 42c 42d

if [ -s 42d  ]
then
while read line2
do
grep -v $line2 41d > 41e
cp 41e 41d
grep  $line2 42a >> 42_0
done < 42d
else
cp 41d 41e
fi
+ '[' -s 42d ']'
+ cp 41d 41e

if [ -s 41e  ]
then
while read line1
do
grep  $line1 41a >> 41_0
done < 41e
fi
+ '[' -s 41e ']'

#Remove from data file data which has reles flag bigger than "0"
cat 4?_0 > TD
+ cat '4?_0'
cat: 4?_0: No such file or directory
cut -c1-43 TD > TDD
+ cut -c1-43 TD
sort -u TDD > TS
+ sort -u TDD

cp TESTs T0
+ cp TESTs T0
if [ -s TS  ]
then
while read line0
do
grep -v $line0 T0 > T1
cp T1  T0
done < TS
fi
+ '[' -s TS ']'

#Add to data file data with the higer release flag and sort by time

cat TD >> T0
+ cat TD
sort -k1,43 T0 > TSS
+ sort -k1,43 T0


cp TSS /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS
+ cp TSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS


exit 0
+ exit 0
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.AJISI.mr2
+ grep -v '\-10030' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.AJISI.mr2
+ grep -v '\-1\-130' t10
+ cp t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.AJISI.mr2
+ rm -f //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.AJISI.mr2
+ '[' AJISI = GISL1 ']'
+ '[' AJISI = GISL2 ']'
+ '[' AJISI = ETA1 ']'
+ '[' AJISI = ETA2 ']'
+ '[' AJISI = CHAMP ']'
+ '[' AJISI = ERS1 ']'
+ '[' AJISI = AJISI ']'
+ DSK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ SV=AJI
+ TAG=AJI
+ FILEQL=qldata.2024240323.AJISI_24.tdf
+ export YY SV FILEQL SAT_DIR_S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.AJISI.mr2 crddata.2024240323.AJISI_24.tdf
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 1: !/bin/ksh: No such file or directory
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 4: #set: command not found

#  TDF_2_GDNBIN
#                                                               ecp       020318
#                                                               ecp       940310
#                                                               rob olson 950525
#
# Usage: TDF_2_GDNBIN data_format disk sat infile outfile [concar] 2> script_out &
#
# this shell script runs the TDF on various data formats.  if concar
# has ANY value (ie if there are 6 command line arguments), then
# this script ftp's the "CONOGBed" members listed in memlist from the
# IBM PDS given by infile, and first runs CONCAR on them
# before running the TDF.  otherwise, the
# location of infile on $disk depends on the data format selected.
# output from this script is netpushed to Unitree.
#
# NOTE:  1) the first command line argument is the GEODYN II
#           data format indicator
#        2) lines 161,177: if concar is to be run, verify path to memlist,
#           and note that the order of member names in memlist is the order
#           in which the files will be concatenated for concar input
#        3) line 225: use the polar motion tables you plan to use
#           when running GEODYN II
#        4) line 232: verify version of tdf executable
#        5) unit 90 output is placed in
#           /$disk/$sat/output/TDFout/$outfile
#        6) tdf binary output is placed in /$disk/$sat/d_base/data/TDF/$outfile
#  ecp   7) this new version allows for a "SAT" dependence in the dir path,
#           e.g. IGS92, IGS93, tp, lre, L1, etc.. It also picks the proper
#           "metric99" and "concarnm" control files depending on what
#           data format you specify with "data_format".
#        8) It seems that the "memlist" option has been disabled in this
#           version, but the member names are assumed to have the following
#           format depending again on the "data_format":
#               GPS (metric fmt) and PCE:  Dddd
#               Binary (e.g. SLR data) :   the entire name is specified in "doy"
#                                          the input in file "infile" of the
#                                          subtdf script.
#
#QSUB -s /bin/sh
#QSUB -r tdf_it!
#QSUB -q medium -eo
#QSUB -lM 15.0MW -lm 15.0MW
#QSUB -lT 2400 -lt 202395
#QSUB -A g926d
#QSUB -me

LOCALDSK=tmp
++ LOCALDSK=tmp

#
# interactive or batch ?
#
if [ $ENVIRONMENT ]; then
   if [ $ENVIRONMENT = "BATCH" ]; then
      if [ $wrapper ]; then
         read data_format disk sat infile outfile concar < /tmp/$USER/tdf.batch.$doy
      else
         read data_format disk sat infile outfile concar < $MAIN_PATH/INFILES/INF_OPS_D_CRD/tdf.batch
      fi
   else
      echo ENVIRONMENT = $ENVIRONMENT ?
      exit 99
   fi
else
 
SCR_NAME=TDF_2_GDNBIN
SCR_PARM=5
SCR_LIST="data_format disk sat infile outfile"
SCR_VERS=040220.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`

echo " # "
echo " #  $SCR_NAME $* "
echo " # "
echo " #  Version $SCR_VERS "
echo " # "
echo " #  Run Date $DateTime "
echo " # "

#  if [ `expr $#` -lt 5 -o `expr $#` -gt 6 ]; then
#     echo "Usage: tdf data_format disk sat infile outfile [concar] 2> script_out &\007"
#     exit 1
#  fi

   data_format=$1
   disk=$2
   sat=$3
   infile=$4
   outfile=$5
   concar=$6
fi
++ '[' ']'
++ SCR_NAME=TDF_2_GDNBIN
++ SCR_PARM=5
++ SCR_LIST='data_format disk sat infile outfile'
++ SCR_VERS=040220.0
expr $#
+++ expr 5
++ '[' 5 -lt 5 ']'
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ DateTime='DATE: 03/30/24  TIME: 13:46:56'
++ echo ' # '
 # 
++ echo ' #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.AJISI.mr2 crddata.2024240323.AJISI_24.tdf '
 #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.AJISI.mr2 crddata.2024240323.AJISI_24.tdf 
++ echo ' # '
 # 
++ echo ' #  Version 040220.0 '
 #  Version 040220.0 
++ echo ' # '
 # 
++ echo ' #  Run Date DATE: 03/30/24  TIME: 13:46:56 '
 #  Run Date DATE: 03/30/24  TIME: 13:46:56 
++ echo ' # '
 # 
++ data_format=9
++ disk=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
++ sat=MLTSAT
++ infile=crddata.2024240323.AJISI.mr2
++ outfile=crddata.2024240323.AJISI_24.tdf
++ concar=

dir=`dirname $outfile`
dirname $outfile
+++ dirname crddata.2024240323.AJISI_24.tdf
++ dir=.

#
# determine the data format to be used
#
case $data_format in
   0) unit=22 ;;       #  Geodyn Binary
   2) unit=24 ;;       #  MERIT II SLR data
   3) unit=26 ;;       #  GEOS-3 Card image - 80 byte fmt
   4) unit=28 ;;       #  Extended Geodyn Binary (Altimetry)
   5) unit=30 ;;       #  PCE
   6) unit=32 ;;       #  Extended GEOS-3 Card image - 120 byte fmt
   7) unit=34 ;;       #  GPS Metric type fmt
   8) unit=36 ;;       #  VLBI Binary fmt
  10) unit=38 ;;
   9) unit=24 ;; ### mkc???  Merit-X SLR Data from CRD reformatter
   *) echo "tdf: Invalid Data Format Indicator: use 0-10 !!\007"; exit 1 ;;
esac
++ case $data_format in
++ unit=24

if   [ "$data_format" = "7" ]; then

   tdfcards=metric99.mtr
   concarnm=concarnm.mtr
   files=$infile

elif [ "$data_format" = "5" ]; then

   tdfcards=metric99.pce
   files=D$doy

elif [ "$data_format" = "0" ]; then

   tdfcards=metric99.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "2" ]; then

   tdfcards=merit2.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "9" ]; then

if [ "$SAT_DIR_S" = "ETA1" -o "$SAT_DIR_S" = "ETA2" ]; then
   tdfcards=merit9_E12.$YY
elif [ "$SAT_DIR_S" = "GISL1" -o "$SAT_DIR_S" = "GISL2" ]; then
   tdfcards=merit9_L12.$YY
elif [ "$SAT_DIR_S" = "LARES" -o "$SAT_DIR_S" = "STARL" -o "$SAT_DIR_S" = "AJISI" -o "$SAT_DIR_S" = "STELLA" ]; then
   tdfcards=merit9_AS.$YY
else
tdfcards=merit9.$YY
fi
 ### orginal independet fro any satellites  tdfcards=merit9.$YY
   concarnm=concarnm.bin
   files=$infile
fi
++ '[' 9 = 7 ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ '[' AJISI = ETA1 -o AJISI = ETA2 ']'
++ '[' AJISI = GISL1 -o AJISI = GISL2 ']'
++ '[' AJISI = LARES -o AJISI = STARL -o AJISI = AJISI -o AJISI = STELLA ']'
++ tdfcards=merit9_AS.24
++ concarnm=concarnm.bin
++ files=crddata.2024240323.AJISI.mr2

#
# make sure you have everything you need
#
if [ ! -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current ]; then
   echo $MAIN_PATH/MISSIONS/d_base/tabs/iers.current doesn\'t exist !
   exit 99
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current ']'
if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ]; then
   echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards doesn\'t exist !
   exit 98
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24 ']'
if [ $concar ]; then

   if [ ! -f $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ]; then
      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm doesn\'t exist !
      exit 97
   fi


#   if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist ]; then
#      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist doesn\'t exist !
#      exit 96
#   fi

elif [ "$data_format" = "7" -a ! -s /$disk/$sat/d_base/data/tdfphase.$infile.Z ]; then
   echo /$disk/$sat/d_base/data/tdfphase.$infile.Z doesn\'t exist !
   exit 99
fi
++ '[' ']'
++ '[' 9 = 7 -a '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/tdfphase.crddata.2024240323.AJISI.mr2.Z ']'

###if [ ! -d /$disk/$sat ]; then
###   mkdir /$disk/$sat
###fi
###
###if [ ! -d /$disk/$sat/d_base ]; then
###   mkdir /$disk/$sat/d_base
###fi
###
###if [ ! -d /$disk/$sat/d_base/data ]; the/\$MAIN_PATH/$MAIN_PATH
###   mkdir /$disk/$sat/d_base/data
###fi
###
###if [ ! -d /$disk/$sat/d_base/data/TDF ]; then
###   mkdir /$disk/$sat/d_base/data/TDF
###fi
###
###if [ ! -d /$disk/$sat/output/TDFout ]; then
###   mkdir /$disk/$sat/output/TDFout
###fi
###
###if [ "$dir" != "." ]; then
###   if [ ! -d /$disk/$sat/d_base/data/$dir ]; then
###      mkdir /$disk/$sat/d_base/data/$dir
###   fi
###fi

mkdir /$LOCALDSK/tdf$$
++ mkdir /tmp/tdf22317
cd /$LOCALDSK/tdf$$
++ cd /tmp/tdf22317

if [ $concar ]; then

   #
   # netpull the CONOGBed files from gibbs
   #
   files=`awk '{printf("%s "),$1 }' $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist `

ftp gibbs << EOF!!
prompt
case
ascii
cd \'$infile\'
mget $files
EOF!!

   #
   # cat the files in the order specified in memlist.  if only
   # one file, just link to it
   #
   numfiles=`wc -l $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist | awk ' {print $1} ' `
   if [ "$numfiles" = "1" ]; then
      ln -s /tmp/tdf$$/$files ftn10
   else
      cat $files > ftn10
   fi

   #
   # get concar control card and run it
   #
   ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ftn04
   echo "***"
   echo "***           RUN CONCAR"
   echo "***"
   /space/users/epavlis/EXECUTABLES/concar 1>tmpcon6 2>tmpcone
   \rm ftn10 ftn04
fi
++ '[' ']'
#
#  get tdf supporting data files and run it
#
if [ $concar ]; then
   if [ -s ftn11 ]; then               # use concar output if run
      mv ftn11 fort.$unit
   else
      echo CONCAR TERMINATED ABNORMALLY - EXITING
      exit 95
   fi
elif [ "$data_format" = "5" ]; then   # cat together PCE data
   count=1
   while [ $count -le 32 ]
   do
      prn=$count
      if [ $count -lt 10 ]; then
         prn=0$count
      fi
      if [ -f /$disk/$sat/PCEC/PRN${prn}/$infile.Z ]; then
         zcat /$disk/$sat/PCEC/PRN${prn}/$infile.Z >> fort.$unit
      fi
      count=`expr $count + 1`
   done
#
elif [ "$data_format" = "7" ]; then   # cp Metric data

   zcat /$disk/$sat/d_base/data/tdfphase.$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "0" ]; then   # Binary data   (e.g. SLR)

   zcat /$disk/$sat/d_base/data/G2B/$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "2" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!

elif [ "$data_format" = "9" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!
fi
++ '[' ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 7 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ zcat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.AJISI.mr2.gz

ln -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current     fort.2
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current fort.2
#
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ftn05
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24 ftn05
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF

echo "***"
++ echo '***'
***
echo "***           RUN TDF"
++ echo '***           RUN TDF'
***           RUN TDF
echo "***"
++ echo '***'
***
#exit 20181220

#NEW TDF for CRD_2_MERIT long np data
#/umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/${TDF2GDN} 1>tmptdf6 2>tmptdfe
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST_100525.x
TDF2GDYN=tdf1006p0_i64_gFORT.x
++ TDF2GDYN=tdf1006p0_i64_gFORT.x
TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
++ TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
++ TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
TDF2GDYN=tdf1006p1_i64.x
++ TDF2GDYN=tdf1006p1_i64.x
TDF2GDYN=tdf1006p2_i64M_180927.x  ## for P2 version
++ TDF2GDYN=tdf1006p2_i64M_180927.x
#/umbc/research/epavlis/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
#
#$MAIN_PATH/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
/umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
++ /umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdf1006p2_i64M_180927.x




echo
++ echo

echo
++ echo


ls -al
++ ls -al
total 72
drwxrwxr-x    2 magdak research  4096 Mar 30 13:46 .
drwxrwxrwt. 136 root   root     28672 Mar 30 13:46 ..
lrwxrwxrwx    1 magdak research    65 Mar 30 13:46 FILIST.DF -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF
lrwxrwxrwx    1 magdak research    67 Mar 30 13:46 fort.2 -> /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current
-rw-rw-r--    1 magdak research     0 Mar 30 13:46 fort.24
-rw-rw-r--    1 magdak research 16016 Mar 30 13:46 fort.41
-rw-rw-r--    1 magdak research    26 Mar 30 13:46 fort.90
lrwxrwxrwx    1 magdak research    68 Mar 30 13:46 ftn05 -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24
-rw-rw-r--    1 magdak research  1866 Mar 30 13:46 tmptdf6
-rw-rw-r--    1 magdak research     0 Mar 30 13:46 tmptdfe
pwd
++ pwd
/tmp/tdf22317


#
# append fort.90 tdf output to unit 5 output
#
#exit 20180920
cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90 > /$disk/$sat/output/TDFout/$outfile
++ cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90
cat: tmpcon6: No such file or directory
cat: tmpcone: No such file or directory
chmod 777 /$disk/$sat/output/TDFout/$outfile
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.AJISI_24.tdf
#rm -f $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${outfile}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${FILEQL}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "qldata.2012120501.${sat}_12.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
######printf "${SV}_${YY}.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
gzip -9 -f /$disk/$sat/output/TDFout/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.AJISI_24.tdf

#
# move tdf output to $disk and Unitree
#

mv fort.41 /$disk/$sat/d_base/data/TDF/${outfile}
++ mv fort.41 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.AJISI_24.tdf
chmod 777 /$disk/$sat/d_base/data/TDF/${outfile}
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.AJISI_24.tdf
gzip -9  -f /$disk/$sat/d_base/data/TDF/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.AJISI_24.tdf

#markd because was conflict with link for qldata-merit data
#cd /$disk/$sat/d_base/data/MRT2/
#rm ${YY}.${sat}.mr2.Z
#ln -s $infile.Z  ${sat}_${YY}.mrt2.Z
#ln -s $infile.Z  ${YY}.${sat}.mr2.Z
#chmod 777 ${YY}.${sat}.mr2.Z

cd /$disk/$sat/d_base/data/TDF
++ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF

#gzip -S .Z -f $outfile

#if [ "$data_format" = "0" -o "$data_format" = "2" -o "$data_format" = "9"  ]; then

echo $SV $YY
++ echo AJI 24
AJI 24
Date=`date +%y%m%d`
date +%y%m%d
+++ date +%y%m%d
++ Date=240330

####to be changed
#rm ${SV}_$YY.tdf_crd.Z
#rm ${SV}_$YY.tdf.Z
#ln -s $outfile.Z ${SV}_$YY.tdf_crd.Z
#ln -s $outfile.Z ${SV}_$YY.tdf.Z
#chmod 777 ${SV}_$YY.tdf_crd.Z

#fi


cd ..
++ cd ..
\rm -r /$LOCALDSK/tdf$$
++ rm -r /tmp/tdf22317
+ read sat SAT_DIR_S
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ mkdir temp17794
+ mkdir /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/LARES
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/LARES
+ cat
+ sed -e '1,$s/PP/23/g' -e '1,$s/pppp/2023/g' -e '1,$s/yyyy/2024/g' -e '1,$s/zzzz/2025/g' -e '1,$s/SAT/lares/g' -e '1,$s/MONTHC/03/g' input1
+ cp /umbc/research/magdak/.netrc_NO_EDC_LOG /umbc/research/magdak/.netrc
+ /usr/bin/ftp -p edc.dgfi.tum.de
+ cp /umbc/research/magdak/.netrc_EDC_LOG /umbc/research/magdak/.netrc
+ rm lares_202403.np2
+ cat 'lares_202403??.np2'
cat: lares_202403??.np2: No such file or directory
+ cat lares_202401.np2 lares_202402.np2
+ cat lares_202312.np2
+ cat lares_202501.np2
cat: lares_202501.np2: No such file or directory
+ cp year.M1 ../.
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794
+ sed 's/^H/h/g' year.M1
+ sed s/h9H1/h1/ year.M1A
+ grep -v -e h9 -e '^30' year.M1C
+ grep -v -e h9 -e '^30' year.00C
grep: year.00C: No such file or directory
+ cat year.M1B year.00B
+ sed 's/^C/c/' year.ALL2
+ grep '^h2' year.ALL
+ sort -u -o strng1
+ cut -c1-18
+ cp year.ALL crddata.2024240323.LARES
+ printf h9
+ cat H9
+ FILE=crddata.2024240323.LARES
+ gzip -9 -f crddata.2024240323.LARES
+ rm ../crddata.2024240323.LARES.gz
rm: cannot remove ‘../crddata.2024240323.LARES.gz’: No such file or directory
+ cp crddata.2024240323.LARES.gz ../crddata.2024240323.LARES.gz
+ cp year.ALL0 year.ALL ../.
cp: cannot stat ‘year.ALL0’: No such file or directory
+ chmod 777 ../crddata.2024240323.LARES.gz
+ cd ..
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ OLD_FILE=crddata.2024240322.LARES
+ FLAG=NO
+ sum crddata.2024240323.LARES.gz
+ sum crddata.2024240322.LARES.gz
sum: crddata.2024240322.LARES.gz: No such file or directory
+ read nbts nblks nfl
+ read obts oblks ofl
+ '[851' ']'
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2: line 212: : No such file or directory
+ echo ' OLD QL file: '
+ cat old_sum_mkc
+ echo '  '
  
+ echo ' NEW QL file: '
+ cat new_sum_mkc
+ rm 2mail
+ rm -r temp17794
+ export FLAG OLD_FILE
+ echo crddata.2024240323.LARES
crddata.2024240323.LARES
+ echo MLTSAT
MLTSAT
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ gzip -d -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES.gz
+ sed -e 's/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 0 2 0/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 2 2 0/' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES
+ rm //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ /umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/CRD2_2_MRT_X_221204.x -i //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES -o //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
Convert CRD Fullrate to Merit II Format: version 2.01b 12/23/2028
crd_in = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES]
cstg_out = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata]
+ '[' LARES = GISL1 ']'
+ '[' LARES = GISL2 ']'
+ '[' LARES = ETA1 ']'
+ '[' LARES = ETA2 ']'
+ '[' LARES = STARL ']'
+ '[' LARES = AJISI ']'
+ '[' LARES = LARES ']'
+ no=1200601
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES.gz
gzip: /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES.gz: No such file or directory
+ '[' MLTSAT = BLITS ']'
+ grep '^1200601' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/QLNP_2_TDFINP_CRD MLTSAT /umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ cp o.QLNP_2_TDFINP /tmp/magdak/o.QLNP_2_TDFINP_
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/SORT_DATA_BY_RELEASE_FLAG_P2 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT

#     SORT_DATA_BY_RELEASE_FLAG


SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
+ SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
SCR_PARM=2
+ SCR_PARM=2
SCR_LIST="disk"
+ SCR_LIST=disk
SCR_VERS=120711.0
+ SCR_VERS=120711.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi
expr $#
++ expr 2
+ '[' 2 -lt 2 ']'

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:47:12'

echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT '
 #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT 
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 120711.0 '
 #  Version 120711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:47:12 '
 #  Run Date DATE: 03/30/24  TIME: 13:47:12 
echo " # "
+ echo ' # '
 # 
disk=$1
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS
SAT_DIR=$2
+ SAT_DIR=MLTSAT
cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS TESTs
+ cp /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS TESTs
#cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS $disk/$SAT_DIR/d_base/data/MRT2/ALL_q
#COLLECT in separately file different release data
grep '41$' TESTs > 41
+ grep '41$' TESTs
grep '42$' TESTs > 42
+ grep '42$' TESTs
grep '43$' TESTs > 43
+ grep '43$' TESTs
grep '44$' TESTs > 44
+ grep '44$' TESTs

#remove name of the file from files
sed -e "s/TESTs://" 41 > 41a
+ sed -e s/TESTs:// 41
sed -e "s/TESTs://" 42 > 42a
+ sed -e s/TESTs:// 42
sed -e "s/TESTs://" 43 > 43a
+ sed -e s/TESTs:// 43
sed -e "s/TESTs://" 44 > 44a
+ sed -e s/TESTs:// 44

#cut files column 1-43
cut -c1-43 41a > 41aa
+ cut -c1-43 41a
cut -c1-43 42a > 42aa
+ cut -c1-43 42a
cut -c1-43 43a > 43aa
+ cut -c1-43 43a
cut -c1-43 44a > 44aa
+ cut -c1-43 44a

sed -e "s/ /0/g"  41aa > 41b
+ sed -e 's/ /0/g' 41aa
sed -e "s/ /0/g"  42aa > 42b
+ sed -e 's/ /0/g' 42aa
sed -e "s/ /0/g"  43aa > 43b
+ sed -e 's/ /0/g' 43aa
sed -e "s/ /0/g"  44aa > 44b
+ sed -e 's/ /0/g' 44aa

rm 41c 42c 43c  41d 42d 41e 4?_0
+ rm 41c 42c 43c 41d 42d 41e '4?_0'
rm: cannot remove ‘4?_0’: No such file or directory
#Check that data  and keep data only the higher release flag

if [ -s 44b  ]
then
while read line4
do
grep -v $line4 41b > 41c
cp 41c 41b
grep -v $line4 42b > 42c
cp 42c 42b
grep -v $line4 43b > 43c
cp 43c 43b
grep  $line4 44a >> 44_0

done < 44b
else
cp 41b 41c
cp 42b 42c
cp 43b 43c
fi
+ '[' -s 44b ']'
+ cp 41b 41c
+ cp 42b 42c
+ cp 43b 43c
#exit 2
if [ -s 43c  ]
then
while read line3
do
grep -v $line3 41c > 41d
cp 41d 41c
grep -v $line3 42c > 42d
cp 42d 42c
grep  $line3 43a >> 43_0
done < 43c
else
cp 41c 41d
cp 42c 42d
fi
+ '[' -s 43c ']'
+ cp 41c 41d
+ cp 42c 42d

if [ -s 42d  ]
then
while read line2
do
grep -v $line2 41d > 41e
cp 41e 41d
grep  $line2 42a >> 42_0
done < 42d
else
cp 41d 41e
fi
+ '[' -s 42d ']'
+ cp 41d 41e

if [ -s 41e  ]
then
while read line1
do
grep  $line1 41a >> 41_0
done < 41e
fi
+ '[' -s 41e ']'

#Remove from data file data which has reles flag bigger than "0"
cat 4?_0 > TD
+ cat '4?_0'
cat: 4?_0: No such file or directory
cut -c1-43 TD > TDD
+ cut -c1-43 TD
sort -u TDD > TS
+ sort -u TDD

cp TESTs T0
+ cp TESTs T0
if [ -s TS  ]
then
while read line0
do
grep -v $line0 T0 > T1
cp T1  T0
done < TS
fi
+ '[' -s TS ']'

#Add to data file data with the higer release flag and sort by time

cat TD >> T0
+ cat TD
sort -k1,43 T0 > TSS
+ sort -k1,43 T0


cp TSS /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS
+ cp TSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS


exit 0
+ exit 0
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.LARES.mr2
+ grep -v '\-10030' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.LARES.mr2
+ grep -v '\-1\-130' t10
+ cp t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.LARES.mr2
+ rm -f //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.LARES.mr2
+ '[' LARES = GISL1 ']'
+ '[' LARES = GISL2 ']'
+ '[' LARES = ETA1 ']'
+ '[' LARES = ETA2 ']'
+ '[' LARES = CHAMP ']'
+ '[' LARES = ERS1 ']'
+ '[' LARES = AJISI ']'
+ '[' LARES = STARL ']'
+ '[' LARES = BLITS ']'
+ '[' LARES = LARES ']'
+ DSK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ SV=LARES
+ TAG=LARES
+ FILEQL=qldata.2024240323.LARES_24.tdf
+ export YY SV FILEQL SAT_DIR_S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.LARES.mr2 crddata.2024240323.LARES_24.tdf
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 1: !/bin/ksh: No such file or directory
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 4: #set: command not found

#  TDF_2_GDNBIN
#                                                               ecp       020318
#                                                               ecp       940310
#                                                               rob olson 950525
#
# Usage: TDF_2_GDNBIN data_format disk sat infile outfile [concar] 2> script_out &
#
# this shell script runs the TDF on various data formats.  if concar
# has ANY value (ie if there are 6 command line arguments), then
# this script ftp's the "CONOGBed" members listed in memlist from the
# IBM PDS given by infile, and first runs CONCAR on them
# before running the TDF.  otherwise, the
# location of infile on $disk depends on the data format selected.
# output from this script is netpushed to Unitree.
#
# NOTE:  1) the first command line argument is the GEODYN II
#           data format indicator
#        2) lines 161,177: if concar is to be run, verify path to memlist,
#           and note that the order of member names in memlist is the order
#           in which the files will be concatenated for concar input
#        3) line 225: use the polar motion tables you plan to use
#           when running GEODYN II
#        4) line 232: verify version of tdf executable
#        5) unit 90 output is placed in
#           /$disk/$sat/output/TDFout/$outfile
#        6) tdf binary output is placed in /$disk/$sat/d_base/data/TDF/$outfile
#  ecp   7) this new version allows for a "SAT" dependence in the dir path,
#           e.g. IGS92, IGS93, tp, lre, L1, etc.. It also picks the proper
#           "metric99" and "concarnm" control files depending on what
#           data format you specify with "data_format".
#        8) It seems that the "memlist" option has been disabled in this
#           version, but the member names are assumed to have the following
#           format depending again on the "data_format":
#               GPS (metric fmt) and PCE:  Dddd
#               Binary (e.g. SLR data) :   the entire name is specified in "doy"
#                                          the input in file "infile" of the
#                                          subtdf script.
#
#QSUB -s /bin/sh
#QSUB -r tdf_it!
#QSUB -q medium -eo
#QSUB -lM 15.0MW -lm 15.0MW
#QSUB -lT 2400 -lt 202395
#QSUB -A g926d
#QSUB -me

LOCALDSK=tmp
++ LOCALDSK=tmp

#
# interactive or batch ?
#
if [ $ENVIRONMENT ]; then
   if [ $ENVIRONMENT = "BATCH" ]; then
      if [ $wrapper ]; then
         read data_format disk sat infile outfile concar < /tmp/$USER/tdf.batch.$doy
      else
         read data_format disk sat infile outfile concar < $MAIN_PATH/INFILES/INF_OPS_D_CRD/tdf.batch
      fi
   else
      echo ENVIRONMENT = $ENVIRONMENT ?
      exit 99
   fi
else
 
SCR_NAME=TDF_2_GDNBIN
SCR_PARM=5
SCR_LIST="data_format disk sat infile outfile"
SCR_VERS=040220.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`

echo " # "
echo " #  $SCR_NAME $* "
echo " # "
echo " #  Version $SCR_VERS "
echo " # "
echo " #  Run Date $DateTime "
echo " # "

#  if [ `expr $#` -lt 5 -o `expr $#` -gt 6 ]; then
#     echo "Usage: tdf data_format disk sat infile outfile [concar] 2> script_out &\007"
#     exit 1
#  fi

   data_format=$1
   disk=$2
   sat=$3
   infile=$4
   outfile=$5
   concar=$6
fi
++ '[' ']'
++ SCR_NAME=TDF_2_GDNBIN
++ SCR_PARM=5
++ SCR_LIST='data_format disk sat infile outfile'
++ SCR_VERS=040220.0
expr $#
+++ expr 5
++ '[' 5 -lt 5 ']'
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ DateTime='DATE: 03/30/24  TIME: 13:47:13'
++ echo ' # '
 # 
++ echo ' #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.LARES.mr2 crddata.2024240323.LARES_24.tdf '
 #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.LARES.mr2 crddata.2024240323.LARES_24.tdf 
++ echo ' # '
 # 
++ echo ' #  Version 040220.0 '
 #  Version 040220.0 
++ echo ' # '
 # 
++ echo ' #  Run Date DATE: 03/30/24  TIME: 13:47:13 '
 #  Run Date DATE: 03/30/24  TIME: 13:47:13 
++ echo ' # '
 # 
++ data_format=9
++ disk=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
++ sat=MLTSAT
++ infile=crddata.2024240323.LARES.mr2
++ outfile=crddata.2024240323.LARES_24.tdf
++ concar=

dir=`dirname $outfile`
dirname $outfile
+++ dirname crddata.2024240323.LARES_24.tdf
++ dir=.

#
# determine the data format to be used
#
case $data_format in
   0) unit=22 ;;       #  Geodyn Binary
   2) unit=24 ;;       #  MERIT II SLR data
   3) unit=26 ;;       #  GEOS-3 Card image - 80 byte fmt
   4) unit=28 ;;       #  Extended Geodyn Binary (Altimetry)
   5) unit=30 ;;       #  PCE
   6) unit=32 ;;       #  Extended GEOS-3 Card image - 120 byte fmt
   7) unit=34 ;;       #  GPS Metric type fmt
   8) unit=36 ;;       #  VLBI Binary fmt
  10) unit=38 ;;
   9) unit=24 ;; ### mkc???  Merit-X SLR Data from CRD reformatter
   *) echo "tdf: Invalid Data Format Indicator: use 0-10 !!\007"; exit 1 ;;
esac
++ case $data_format in
++ unit=24

if   [ "$data_format" = "7" ]; then

   tdfcards=metric99.mtr
   concarnm=concarnm.mtr
   files=$infile

elif [ "$data_format" = "5" ]; then

   tdfcards=metric99.pce
   files=D$doy

elif [ "$data_format" = "0" ]; then

   tdfcards=metric99.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "2" ]; then

   tdfcards=merit2.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "9" ]; then

if [ "$SAT_DIR_S" = "ETA1" -o "$SAT_DIR_S" = "ETA2" ]; then
   tdfcards=merit9_E12.$YY
elif [ "$SAT_DIR_S" = "GISL1" -o "$SAT_DIR_S" = "GISL2" ]; then
   tdfcards=merit9_L12.$YY
elif [ "$SAT_DIR_S" = "LARES" -o "$SAT_DIR_S" = "STARL" -o "$SAT_DIR_S" = "AJISI" -o "$SAT_DIR_S" = "STELLA" ]; then
   tdfcards=merit9_AS.$YY
else
tdfcards=merit9.$YY
fi
 ### orginal independet fro any satellites  tdfcards=merit9.$YY
   concarnm=concarnm.bin
   files=$infile
fi
++ '[' 9 = 7 ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ '[' LARES = ETA1 -o LARES = ETA2 ']'
++ '[' LARES = GISL1 -o LARES = GISL2 ']'
++ '[' LARES = LARES -o LARES = STARL -o LARES = AJISI -o LARES = STELLA ']'
++ tdfcards=merit9_AS.24
++ concarnm=concarnm.bin
++ files=crddata.2024240323.LARES.mr2

#
# make sure you have everything you need
#
if [ ! -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current ]; then
   echo $MAIN_PATH/MISSIONS/d_base/tabs/iers.current doesn\'t exist !
   exit 99
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current ']'
if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ]; then
   echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards doesn\'t exist !
   exit 98
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24 ']'
if [ $concar ]; then

   if [ ! -f $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ]; then
      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm doesn\'t exist !
      exit 97
   fi


#   if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist ]; then
#      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist doesn\'t exist !
#      exit 96
#   fi

elif [ "$data_format" = "7" -a ! -s /$disk/$sat/d_base/data/tdfphase.$infile.Z ]; then
   echo /$disk/$sat/d_base/data/tdfphase.$infile.Z doesn\'t exist !
   exit 99
fi
++ '[' ']'
++ '[' 9 = 7 -a '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/tdfphase.crddata.2024240323.LARES.mr2.Z ']'

###if [ ! -d /$disk/$sat ]; then
###   mkdir /$disk/$sat
###fi
###
###if [ ! -d /$disk/$sat/d_base ]; then
###   mkdir /$disk/$sat/d_base
###fi
###
###if [ ! -d /$disk/$sat/d_base/data ]; the/\$MAIN_PATH/$MAIN_PATH
###   mkdir /$disk/$sat/d_base/data
###fi
###
###if [ ! -d /$disk/$sat/d_base/data/TDF ]; then
###   mkdir /$disk/$sat/d_base/data/TDF
###fi
###
###if [ ! -d /$disk/$sat/output/TDFout ]; then
###   mkdir /$disk/$sat/output/TDFout
###fi
###
###if [ "$dir" != "." ]; then
###   if [ ! -d /$disk/$sat/d_base/data/$dir ]; then
###      mkdir /$disk/$sat/d_base/data/$dir
###   fi
###fi

mkdir /$LOCALDSK/tdf$$
++ mkdir /tmp/tdf22495
cd /$LOCALDSK/tdf$$
++ cd /tmp/tdf22495

if [ $concar ]; then

   #
   # netpull the CONOGBed files from gibbs
   #
   files=`awk '{printf("%s "),$1 }' $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist `

ftp gibbs << EOF!!
prompt
case
ascii
cd \'$infile\'
mget $files
EOF!!

   #
   # cat the files in the order specified in memlist.  if only
   # one file, just link to it
   #
   numfiles=`wc -l $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist | awk ' {print $1} ' `
   if [ "$numfiles" = "1" ]; then
      ln -s /tmp/tdf$$/$files ftn10
   else
      cat $files > ftn10
   fi

   #
   # get concar control card and run it
   #
   ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ftn04
   echo "***"
   echo "***           RUN CONCAR"
   echo "***"
   /space/users/epavlis/EXECUTABLES/concar 1>tmpcon6 2>tmpcone
   \rm ftn10 ftn04
fi
++ '[' ']'
#
#  get tdf supporting data files and run it
#
if [ $concar ]; then
   if [ -s ftn11 ]; then               # use concar output if run
      mv ftn11 fort.$unit
   else
      echo CONCAR TERMINATED ABNORMALLY - EXITING
      exit 95
   fi
elif [ "$data_format" = "5" ]; then   # cat together PCE data
   count=1
   while [ $count -le 32 ]
   do
      prn=$count
      if [ $count -lt 10 ]; then
         prn=0$count
      fi
      if [ -f /$disk/$sat/PCEC/PRN${prn}/$infile.Z ]; then
         zcat /$disk/$sat/PCEC/PRN${prn}/$infile.Z >> fort.$unit
      fi
      count=`expr $count + 1`
   done
#
elif [ "$data_format" = "7" ]; then   # cp Metric data

   zcat /$disk/$sat/d_base/data/tdfphase.$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "0" ]; then   # Binary data   (e.g. SLR)

   zcat /$disk/$sat/d_base/data/G2B/$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "2" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!

elif [ "$data_format" = "9" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!
fi
++ '[' ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 7 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ zcat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.LARES.mr2.gz

ln -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current     fort.2
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current fort.2
#
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ftn05
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24 ftn05
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF

echo "***"
++ echo '***'
***
echo "***           RUN TDF"
++ echo '***           RUN TDF'
***           RUN TDF
echo "***"
++ echo '***'
***
#exit 20181220

#NEW TDF for CRD_2_MERIT long np data
#/umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/${TDF2GDN} 1>tmptdf6 2>tmptdfe
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST_100525.x
TDF2GDYN=tdf1006p0_i64_gFORT.x
++ TDF2GDYN=tdf1006p0_i64_gFORT.x
TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
++ TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
++ TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
TDF2GDYN=tdf1006p1_i64.x
++ TDF2GDYN=tdf1006p1_i64.x
TDF2GDYN=tdf1006p2_i64M_180927.x  ## for P2 version
++ TDF2GDYN=tdf1006p2_i64M_180927.x
#/umbc/research/epavlis/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
#
#$MAIN_PATH/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
/umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
++ /umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdf1006p2_i64M_180927.x




echo
++ echo

echo
++ echo


ls -al
++ ls -al
total 5584
drwxrwxr-x    2 magdak research    4096 Mar 30 13:47 .
drwxrwxrwt. 136 root   root       28672 Mar 30 13:47 ..
lrwxrwxrwx    1 magdak research      65 Mar 30 13:47 FILIST.DF -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF
lrwxrwxrwx    1 magdak research      67 Mar 30 13:47 fort.2 -> /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current
-rw-rw-r--    1 magdak research 2508152 Mar 30 13:47 fort.24
-rw-rw-r--    1 magdak research 2914912 Mar 30 13:47 fort.41
-rw-rw-r--    1 magdak research  235294 Mar 30 13:47 fort.90
lrwxrwxrwx    1 magdak research      68 Mar 30 13:47 ftn05 -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24
-rw-rw-r--    1 magdak research    1866 Mar 30 13:47 tmptdf6
-rw-rw-r--    1 magdak research       0 Mar 30 13:47 tmptdfe
pwd
++ pwd
/tmp/tdf22495


#
# append fort.90 tdf output to unit 5 output
#
#exit 20180920
cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90 > /$disk/$sat/output/TDFout/$outfile
++ cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90
cat: tmpcon6: No such file or directory
cat: tmpcone: No such file or directory
chmod 777 /$disk/$sat/output/TDFout/$outfile
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.LARES_24.tdf
#rm -f $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${outfile}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${FILEQL}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "qldata.2012120501.${sat}_12.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
######printf "${SV}_${YY}.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
gzip -9 -f /$disk/$sat/output/TDFout/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.LARES_24.tdf

#
# move tdf output to $disk and Unitree
#

mv fort.41 /$disk/$sat/d_base/data/TDF/${outfile}
++ mv fort.41 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.LARES_24.tdf
chmod 777 /$disk/$sat/d_base/data/TDF/${outfile}
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.LARES_24.tdf
gzip -9  -f /$disk/$sat/d_base/data/TDF/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.LARES_24.tdf

#markd because was conflict with link for qldata-merit data
#cd /$disk/$sat/d_base/data/MRT2/
#rm ${YY}.${sat}.mr2.Z
#ln -s $infile.Z  ${sat}_${YY}.mrt2.Z
#ln -s $infile.Z  ${YY}.${sat}.mr2.Z
#chmod 777 ${YY}.${sat}.mr2.Z

cd /$disk/$sat/d_base/data/TDF
++ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF

#gzip -S .Z -f $outfile

#if [ "$data_format" = "0" -o "$data_format" = "2" -o "$data_format" = "9"  ]; then

echo $SV $YY
++ echo LARES 24
LARES 24
Date=`date +%y%m%d`
date +%y%m%d
+++ date +%y%m%d
++ Date=240330

####to be changed
#rm ${SV}_$YY.tdf_crd.Z
#rm ${SV}_$YY.tdf.Z
#ln -s $outfile.Z ${SV}_$YY.tdf_crd.Z
#ln -s $outfile.Z ${SV}_$YY.tdf.Z
#chmod 777 ${SV}_$YY.tdf_crd.Z

#fi


cd ..
++ cd ..
\rm -r /$LOCALDSK/tdf$$
++ rm -r /tmp/tdf22495
+ read sat SAT_DIR_S
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ mkdir temp17794
+ mkdir /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/STELLA
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/STELLA
+ cat
+ sed -e '1,$s/PP/23/g' -e '1,$s/pppp/2023/g' -e '1,$s/yyyy/2024/g' -e '1,$s/zzzz/2025/g' -e '1,$s/SAT/stella/g' -e '1,$s/MONTHC/03/g' input1
+ cp /umbc/research/magdak/.netrc_NO_EDC_LOG /umbc/research/magdak/.netrc
+ /usr/bin/ftp -p edc.dgfi.tum.de
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
No control connection for command: No such file or directory
+ cp /umbc/research/magdak/.netrc_EDC_LOG /umbc/research/magdak/.netrc
+ rm stella_202403.np2
+ cat stella_20240301.np2
+ cat stella_202401.np2 stella_202402.np2
+ cat stella_202312.np2
+ cat stella_202501.np2
cat: stella_202501.np2: No such file or directory
+ cp year.M1 ../.
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794
+ sed 's/^H/h/g' year.M1
+ sed s/h9H1/h1/ year.M1A
+ grep -v -e h9 -e '^30' year.M1C
+ grep -v -e h9 -e '^30' year.00C
grep: year.00C: No such file or directory
+ cat year.M1B year.00B
+ sed 's/^C/c/' year.ALL2
+ grep '^h2' year.ALL
+ cut -c1-18
+ sort -u -o strng1
+ cp year.ALL crddata.2024240323.STELLA
+ printf h9
+ cat H9
+ FILE=crddata.2024240323.STELLA
+ gzip -9 -f crddata.2024240323.STELLA
+ rm ../crddata.2024240323.STELLA.gz
rm: cannot remove ‘../crddata.2024240323.STELLA.gz’: No such file or directory
+ cp crddata.2024240323.STELLA.gz ../crddata.2024240323.STELLA.gz
+ cp year.ALL0 year.ALL ../.
cp: cannot stat ‘year.ALL0’: No such file or directory
+ chmod 777 ../crddata.2024240323.STELLA.gz
+ cd ..
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ OLD_FILE=crddata.2024240322.STELLA
+ FLAG=NO
+ sum crddata.2024240323.STELLA.gz
+ sum crddata.2024240322.STELLA.gz
sum: crddata.2024240322.STELLA.gz: No such file or directory
+ read nbts nblks nfl
+ read obts oblks ofl
+ '[607' ']'
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2: line 212: : No such file or directory
+ echo ' OLD QL file: '
+ cat old_sum_mkc
+ echo '  '
  
+ echo ' NEW QL file: '
+ cat new_sum_mkc
+ rm 2mail
+ rm -r temp17794
+ export FLAG OLD_FILE
+ echo crddata.2024240323.STELLA
crddata.2024240323.STELLA
+ echo MLTSAT
MLTSAT
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ gzip -d -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STELLA.gz
+ sed -e 's/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 0 2 0/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 2 2 0/' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STELLA
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STELLA
+ rm //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ /umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/CRD2_2_MRT_X_221204.x -i //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STELLA -o //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
Convert CRD Fullrate to Merit II Format: version 2.01b 12/23/2028
crd_in = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STELLA]
cstg_out = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata]
+ '[' STELLA = GISL1 ']'
+ '[' STELLA = GISL2 ']'
+ '[' STELLA = ETA1 ']'
+ '[' STELLA = ETA2 ']'
+ '[' STELLA = STARL ']'
+ '[' STELLA = AJISI ']'
+ '[' STELLA = LARES ']'
+ '[' STELLA = LARES2 ']'
+ '[' STELLA = BLITS ']'
+ '[' STELLA = STELLA ']'
+ no=9306102
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STELLA.gz
gzip: /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.STELLA.gz: No such file or directory
+ '[' MLTSAT = BLITS ']'
+ grep '^9306102' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/QLNP_2_TDFINP_CRD MLTSAT /umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ cp o.QLNP_2_TDFINP /tmp/magdak/o.QLNP_2_TDFINP_
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/SORT_DATA_BY_RELEASE_FLAG_P2 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT

#     SORT_DATA_BY_RELEASE_FLAG


SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
+ SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
SCR_PARM=2
+ SCR_PARM=2
SCR_LIST="disk"
+ SCR_LIST=disk
SCR_VERS=120711.0
+ SCR_VERS=120711.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi
expr $#
++ expr 2
+ '[' 2 -lt 2 ']'

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:47:30'

echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT '
 #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT 
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 120711.0 '
 #  Version 120711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:47:30 '
 #  Run Date DATE: 03/30/24  TIME: 13:47:30 
echo " # "
+ echo ' # '
 # 
disk=$1
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS
SAT_DIR=$2
+ SAT_DIR=MLTSAT
cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS TESTs
+ cp /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS TESTs
#cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS $disk/$SAT_DIR/d_base/data/MRT2/ALL_q
#COLLECT in separately file different release data
grep '41$' TESTs > 41
+ grep '41$' TESTs
grep '42$' TESTs > 42
+ grep '42$' TESTs
grep '43$' TESTs > 43
+ grep '43$' TESTs
grep '44$' TESTs > 44
+ grep '44$' TESTs

#remove name of the file from files
sed -e "s/TESTs://" 41 > 41a
+ sed -e s/TESTs:// 41
sed -e "s/TESTs://" 42 > 42a
+ sed -e s/TESTs:// 42
sed -e "s/TESTs://" 43 > 43a
+ sed -e s/TESTs:// 43
sed -e "s/TESTs://" 44 > 44a
+ sed -e s/TESTs:// 44

#cut files column 1-43
cut -c1-43 41a > 41aa
+ cut -c1-43 41a
cut -c1-43 42a > 42aa
+ cut -c1-43 42a
cut -c1-43 43a > 43aa
+ cut -c1-43 43a
cut -c1-43 44a > 44aa
+ cut -c1-43 44a

sed -e "s/ /0/g"  41aa > 41b
+ sed -e 's/ /0/g' 41aa
sed -e "s/ /0/g"  42aa > 42b
+ sed -e 's/ /0/g' 42aa
sed -e "s/ /0/g"  43aa > 43b
+ sed -e 's/ /0/g' 43aa
sed -e "s/ /0/g"  44aa > 44b
+ sed -e 's/ /0/g' 44aa

rm 41c 42c 43c  41d 42d 41e 4?_0
+ rm 41c 42c 43c 41d 42d 41e '4?_0'
rm: cannot remove ‘4?_0’: No such file or directory
#Check that data  and keep data only the higher release flag

if [ -s 44b  ]
then
while read line4
do
grep -v $line4 41b > 41c
cp 41c 41b
grep -v $line4 42b > 42c
cp 42c 42b
grep -v $line4 43b > 43c
cp 43c 43b
grep  $line4 44a >> 44_0

done < 44b
else
cp 41b 41c
cp 42b 42c
cp 43b 43c
fi
+ '[' -s 44b ']'
+ cp 41b 41c
+ cp 42b 42c
+ cp 43b 43c
#exit 2
if [ -s 43c  ]
then
while read line3
do
grep -v $line3 41c > 41d
cp 41d 41c
grep -v $line3 42c > 42d
cp 42d 42c
grep  $line3 43a >> 43_0
done < 43c
else
cp 41c 41d
cp 42c 42d
fi
+ '[' -s 43c ']'
+ cp 41c 41d
+ cp 42c 42d

if [ -s 42d  ]
then
while read line2
do
grep -v $line2 41d > 41e
cp 41e 41d
grep  $line2 42a >> 42_0
done < 42d
else
cp 41d 41e
fi
+ '[' -s 42d ']'
+ cp 41d 41e

if [ -s 41e  ]
then
while read line1
do
grep  $line1 41a >> 41_0
done < 41e
fi
+ '[' -s 41e ']'

#Remove from data file data which has reles flag bigger than "0"
cat 4?_0 > TD
+ cat '4?_0'
cat: 4?_0: No such file or directory
cut -c1-43 TD > TDD
+ cut -c1-43 TD
sort -u TDD > TS
+ sort -u TDD

cp TESTs T0
+ cp TESTs T0
if [ -s TS  ]
then
while read line0
do
grep -v $line0 T0 > T1
cp T1  T0
done < TS
fi
+ '[' -s TS ']'

#Add to data file data with the higer release flag and sort by time

cat TD >> T0
+ cat TD
sort -k1,43 T0 > TSS
+ sort -k1,43 T0


cp TSS /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS
+ cp TSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS


exit 0
+ exit 0
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.STELLA.mr2
+ grep -v '\-10030' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.STELLA.mr2
+ grep -v '\-1\-130' t10
+ cp t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.STELLA.mr2
+ rm -f //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.STELLA.mr2
+ '[' STELLA = GISL1 ']'
+ '[' STELLA = GISL2 ']'
+ '[' STELLA = ETA1 ']'
+ '[' STELLA = ETA2 ']'
+ '[' STELLA = CHAMP ']'
+ '[' STELLA = ERS1 ']'
+ '[' STELLA = AJISI ']'
+ '[' STELLA = STARL ']'
+ '[' STELLA = BLITS ']'
+ '[' STELLA = LARES ']'
+ '[' STELLA = LARES2 ']'
+ '[' STELLA = STELLA ']'
+ DSK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ SV=STELLA
+ TAG=STELLA
+ FILEQL=qldata.2024240323.STELLA_24.tdf
+ export YY SV FILEQL SAT_DIR_S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.STELLA.mr2 crddata.2024240323.STELLA_24.tdf
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 1: !/bin/ksh: No such file or directory
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 4: #set: command not found

#  TDF_2_GDNBIN
#                                                               ecp       020318
#                                                               ecp       940310
#                                                               rob olson 950525
#
# Usage: TDF_2_GDNBIN data_format disk sat infile outfile [concar] 2> script_out &
#
# this shell script runs the TDF on various data formats.  if concar
# has ANY value (ie if there are 6 command line arguments), then
# this script ftp's the "CONOGBed" members listed in memlist from the
# IBM PDS given by infile, and first runs CONCAR on them
# before running the TDF.  otherwise, the
# location of infile on $disk depends on the data format selected.
# output from this script is netpushed to Unitree.
#
# NOTE:  1) the first command line argument is the GEODYN II
#           data format indicator
#        2) lines 161,177: if concar is to be run, verify path to memlist,
#           and note that the order of member names in memlist is the order
#           in which the files will be concatenated for concar input
#        3) line 225: use the polar motion tables you plan to use
#           when running GEODYN II
#        4) line 232: verify version of tdf executable
#        5) unit 90 output is placed in
#           /$disk/$sat/output/TDFout/$outfile
#        6) tdf binary output is placed in /$disk/$sat/d_base/data/TDF/$outfile
#  ecp   7) this new version allows for a "SAT" dependence in the dir path,
#           e.g. IGS92, IGS93, tp, lre, L1, etc.. It also picks the proper
#           "metric99" and "concarnm" control files depending on what
#           data format you specify with "data_format".
#        8) It seems that the "memlist" option has been disabled in this
#           version, but the member names are assumed to have the following
#           format depending again on the "data_format":
#               GPS (metric fmt) and PCE:  Dddd
#               Binary (e.g. SLR data) :   the entire name is specified in "doy"
#                                          the input in file "infile" of the
#                                          subtdf script.
#
#QSUB -s /bin/sh
#QSUB -r tdf_it!
#QSUB -q medium -eo
#QSUB -lM 15.0MW -lm 15.0MW
#QSUB -lT 2400 -lt 202395
#QSUB -A g926d
#QSUB -me

LOCALDSK=tmp
++ LOCALDSK=tmp

#
# interactive or batch ?
#
if [ $ENVIRONMENT ]; then
   if [ $ENVIRONMENT = "BATCH" ]; then
      if [ $wrapper ]; then
         read data_format disk sat infile outfile concar < /tmp/$USER/tdf.batch.$doy
      else
         read data_format disk sat infile outfile concar < $MAIN_PATH/INFILES/INF_OPS_D_CRD/tdf.batch
      fi
   else
      echo ENVIRONMENT = $ENVIRONMENT ?
      exit 99
   fi
else
 
SCR_NAME=TDF_2_GDNBIN
SCR_PARM=5
SCR_LIST="data_format disk sat infile outfile"
SCR_VERS=040220.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`

echo " # "
echo " #  $SCR_NAME $* "
echo " # "
echo " #  Version $SCR_VERS "
echo " # "
echo " #  Run Date $DateTime "
echo " # "

#  if [ `expr $#` -lt 5 -o `expr $#` -gt 6 ]; then
#     echo "Usage: tdf data_format disk sat infile outfile [concar] 2> script_out &\007"
#     exit 1
#  fi

   data_format=$1
   disk=$2
   sat=$3
   infile=$4
   outfile=$5
   concar=$6
fi
++ '[' ']'
++ SCR_NAME=TDF_2_GDNBIN
++ SCR_PARM=5
++ SCR_LIST='data_format disk sat infile outfile'
++ SCR_VERS=040220.0
expr $#
+++ expr 5
++ '[' 5 -lt 5 ']'
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ DateTime='DATE: 03/30/24  TIME: 13:47:31'
++ echo ' # '
 # 
++ echo ' #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.STELLA.mr2 crddata.2024240323.STELLA_24.tdf '
 #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.STELLA.mr2 crddata.2024240323.STELLA_24.tdf 
++ echo ' # '
 # 
++ echo ' #  Version 040220.0 '
 #  Version 040220.0 
++ echo ' # '
 # 
++ echo ' #  Run Date DATE: 03/30/24  TIME: 13:47:31 '
 #  Run Date DATE: 03/30/24  TIME: 13:47:31 
++ echo ' # '
 # 
++ data_format=9
++ disk=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
++ sat=MLTSAT
++ infile=crddata.2024240323.STELLA.mr2
++ outfile=crddata.2024240323.STELLA_24.tdf
++ concar=

dir=`dirname $outfile`
dirname $outfile
+++ dirname crddata.2024240323.STELLA_24.tdf
++ dir=.

#
# determine the data format to be used
#
case $data_format in
   0) unit=22 ;;       #  Geodyn Binary
   2) unit=24 ;;       #  MERIT II SLR data
   3) unit=26 ;;       #  GEOS-3 Card image - 80 byte fmt
   4) unit=28 ;;       #  Extended Geodyn Binary (Altimetry)
   5) unit=30 ;;       #  PCE
   6) unit=32 ;;       #  Extended GEOS-3 Card image - 120 byte fmt
   7) unit=34 ;;       #  GPS Metric type fmt
   8) unit=36 ;;       #  VLBI Binary fmt
  10) unit=38 ;;
   9) unit=24 ;; ### mkc???  Merit-X SLR Data from CRD reformatter
   *) echo "tdf: Invalid Data Format Indicator: use 0-10 !!\007"; exit 1 ;;
esac
++ case $data_format in
++ unit=24

if   [ "$data_format" = "7" ]; then

   tdfcards=metric99.mtr
   concarnm=concarnm.mtr
   files=$infile

elif [ "$data_format" = "5" ]; then

   tdfcards=metric99.pce
   files=D$doy

elif [ "$data_format" = "0" ]; then

   tdfcards=metric99.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "2" ]; then

   tdfcards=merit2.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "9" ]; then

if [ "$SAT_DIR_S" = "ETA1" -o "$SAT_DIR_S" = "ETA2" ]; then
   tdfcards=merit9_E12.$YY
elif [ "$SAT_DIR_S" = "GISL1" -o "$SAT_DIR_S" = "GISL2" ]; then
   tdfcards=merit9_L12.$YY
elif [ "$SAT_DIR_S" = "LARES" -o "$SAT_DIR_S" = "STARL" -o "$SAT_DIR_S" = "AJISI" -o "$SAT_DIR_S" = "STELLA" ]; then
   tdfcards=merit9_AS.$YY
else
tdfcards=merit9.$YY
fi
 ### orginal independet fro any satellites  tdfcards=merit9.$YY
   concarnm=concarnm.bin
   files=$infile
fi
++ '[' 9 = 7 ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ '[' STELLA = ETA1 -o STELLA = ETA2 ']'
++ '[' STELLA = GISL1 -o STELLA = GISL2 ']'
++ '[' STELLA = LARES -o STELLA = STARL -o STELLA = AJISI -o STELLA = STELLA ']'
++ tdfcards=merit9_AS.24
++ concarnm=concarnm.bin
++ files=crddata.2024240323.STELLA.mr2

#
# make sure you have everything you need
#
if [ ! -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current ]; then
   echo $MAIN_PATH/MISSIONS/d_base/tabs/iers.current doesn\'t exist !
   exit 99
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current ']'
if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ]; then
   echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards doesn\'t exist !
   exit 98
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24 ']'
if [ $concar ]; then

   if [ ! -f $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ]; then
      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm doesn\'t exist !
      exit 97
   fi


#   if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist ]; then
#      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist doesn\'t exist !
#      exit 96
#   fi

elif [ "$data_format" = "7" -a ! -s /$disk/$sat/d_base/data/tdfphase.$infile.Z ]; then
   echo /$disk/$sat/d_base/data/tdfphase.$infile.Z doesn\'t exist !
   exit 99
fi
++ '[' ']'
++ '[' 9 = 7 -a '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/tdfphase.crddata.2024240323.STELLA.mr2.Z ']'

###if [ ! -d /$disk/$sat ]; then
###   mkdir /$disk/$sat
###fi
###
###if [ ! -d /$disk/$sat/d_base ]; then
###   mkdir /$disk/$sat/d_base
###fi
###
###if [ ! -d /$disk/$sat/d_base/data ]; the/\$MAIN_PATH/$MAIN_PATH
###   mkdir /$disk/$sat/d_base/data
###fi
###
###if [ ! -d /$disk/$sat/d_base/data/TDF ]; then
###   mkdir /$disk/$sat/d_base/data/TDF
###fi
###
###if [ ! -d /$disk/$sat/output/TDFout ]; then
###   mkdir /$disk/$sat/output/TDFout
###fi
###
###if [ "$dir" != "." ]; then
###   if [ ! -d /$disk/$sat/d_base/data/$dir ]; then
###      mkdir /$disk/$sat/d_base/data/$dir
###   fi
###fi

mkdir /$LOCALDSK/tdf$$
++ mkdir /tmp/tdf22676
cd /$LOCALDSK/tdf$$
++ cd /tmp/tdf22676

if [ $concar ]; then

   #
   # netpull the CONOGBed files from gibbs
   #
   files=`awk '{printf("%s "),$1 }' $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist `

ftp gibbs << EOF!!
prompt
case
ascii
cd \'$infile\'
mget $files
EOF!!

   #
   # cat the files in the order specified in memlist.  if only
   # one file, just link to it
   #
   numfiles=`wc -l $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist | awk ' {print $1} ' `
   if [ "$numfiles" = "1" ]; then
      ln -s /tmp/tdf$$/$files ftn10
   else
      cat $files > ftn10
   fi

   #
   # get concar control card and run it
   #
   ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ftn04
   echo "***"
   echo "***           RUN CONCAR"
   echo "***"
   /space/users/epavlis/EXECUTABLES/concar 1>tmpcon6 2>tmpcone
   \rm ftn10 ftn04
fi
++ '[' ']'
#
#  get tdf supporting data files and run it
#
if [ $concar ]; then
   if [ -s ftn11 ]; then               # use concar output if run
      mv ftn11 fort.$unit
   else
      echo CONCAR TERMINATED ABNORMALLY - EXITING
      exit 95
   fi
elif [ "$data_format" = "5" ]; then   # cat together PCE data
   count=1
   while [ $count -le 32 ]
   do
      prn=$count
      if [ $count -lt 10 ]; then
         prn=0$count
      fi
      if [ -f /$disk/$sat/PCEC/PRN${prn}/$infile.Z ]; then
         zcat /$disk/$sat/PCEC/PRN${prn}/$infile.Z >> fort.$unit
      fi
      count=`expr $count + 1`
   done
#
elif [ "$data_format" = "7" ]; then   # cp Metric data

   zcat /$disk/$sat/d_base/data/tdfphase.$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "0" ]; then   # Binary data   (e.g. SLR)

   zcat /$disk/$sat/d_base/data/G2B/$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "2" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!

elif [ "$data_format" = "9" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!
fi
++ '[' ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 7 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ zcat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.STELLA.mr2.gz

ln -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current     fort.2
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current fort.2
#
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ftn05
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24 ftn05
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF

echo "***"
++ echo '***'
***
echo "***           RUN TDF"
++ echo '***           RUN TDF'
***           RUN TDF
echo "***"
++ echo '***'
***
#exit 20181220

#NEW TDF for CRD_2_MERIT long np data
#/umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/${TDF2GDN} 1>tmptdf6 2>tmptdfe
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST_100525.x
TDF2GDYN=tdf1006p0_i64_gFORT.x
++ TDF2GDYN=tdf1006p0_i64_gFORT.x
TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
++ TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
++ TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
TDF2GDYN=tdf1006p1_i64.x
++ TDF2GDYN=tdf1006p1_i64.x
TDF2GDYN=tdf1006p2_i64M_180927.x  ## for P2 version
++ TDF2GDYN=tdf1006p2_i64M_180927.x
#/umbc/research/epavlis/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
#
#$MAIN_PATH/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
/umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
++ /umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdf1006p2_i64M_180927.x




echo
++ echo

echo
++ echo


ls -al
++ ls -al
total 3716
drwxrwxr-x    2 magdak research    4096 Mar 30 13:47 .
drwxrwxrwt. 136 root   root       28672 Mar 30 13:47 ..
lrwxrwxrwx    1 magdak research      65 Mar 30 13:47 FILIST.DF -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF
lrwxrwxrwx    1 magdak research      67 Mar 30 13:47 fort.2 -> /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current
-rw-rw-r--    1 magdak research 1617736 Mar 30 13:47 fort.24
-rw-rw-r--    1 magdak research 1937936 Mar 30 13:47 fort.41
-rw-rw-r--    1 magdak research  192411 Mar 30 13:47 fort.90
lrwxrwxrwx    1 magdak research      68 Mar 30 13:47 ftn05 -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9_AS.24
-rw-rw-r--    1 magdak research    1866 Mar 30 13:47 tmptdf6
-rw-rw-r--    1 magdak research       0 Mar 30 13:47 tmptdfe
pwd
++ pwd
/tmp/tdf22676


#
# append fort.90 tdf output to unit 5 output
#
#exit 20180920
cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90 > /$disk/$sat/output/TDFout/$outfile
++ cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90
cat: tmpcon6: No such file or directory
cat: tmpcone: No such file or directory
chmod 777 /$disk/$sat/output/TDFout/$outfile
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.STELLA_24.tdf
#rm -f $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${outfile}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${FILEQL}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "qldata.2012120501.${sat}_12.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
######printf "${SV}_${YY}.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
gzip -9 -f /$disk/$sat/output/TDFout/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.STELLA_24.tdf

#
# move tdf output to $disk and Unitree
#

mv fort.41 /$disk/$sat/d_base/data/TDF/${outfile}
++ mv fort.41 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.STELLA_24.tdf
chmod 777 /$disk/$sat/d_base/data/TDF/${outfile}
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.STELLA_24.tdf
gzip -9  -f /$disk/$sat/d_base/data/TDF/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.STELLA_24.tdf

#markd because was conflict with link for qldata-merit data
#cd /$disk/$sat/d_base/data/MRT2/
#rm ${YY}.${sat}.mr2.Z
#ln -s $infile.Z  ${sat}_${YY}.mrt2.Z
#ln -s $infile.Z  ${YY}.${sat}.mr2.Z
#chmod 777 ${YY}.${sat}.mr2.Z

cd /$disk/$sat/d_base/data/TDF
++ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF

#gzip -S .Z -f $outfile

#if [ "$data_format" = "0" -o "$data_format" = "2" -o "$data_format" = "9"  ]; then

echo $SV $YY
++ echo STELLA 24
STELLA 24
Date=`date +%y%m%d`
date +%y%m%d
+++ date +%y%m%d
++ Date=240330

####to be changed
#rm ${SV}_$YY.tdf_crd.Z
#rm ${SV}_$YY.tdf.Z
#ln -s $outfile.Z ${SV}_$YY.tdf_crd.Z
#ln -s $outfile.Z ${SV}_$YY.tdf.Z
#chmod 777 ${SV}_$YY.tdf_crd.Z

#fi


cd ..
++ cd ..
\rm -r /$LOCALDSK/tdf$$
++ rm -r /tmp/tdf22676
+ read sat SAT_DIR_S
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ mkdir temp17794
+ mkdir /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/LARES2
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794/LARES2
+ cat
+ sed -e '1,$s/PP/23/g' -e '1,$s/pppp/2023/g' -e '1,$s/yyyy/2024/g' -e '1,$s/zzzz/2025/g' -e '1,$s/SAT/lares2/g' -e '1,$s/MONTHC/03/g' input1
+ cp /umbc/research/magdak/.netrc_NO_EDC_LOG /umbc/research/magdak/.netrc
+ /usr/bin/ftp -p edc.dgfi.tum.de
+ cp /umbc/research/magdak/.netrc_EDC_LOG /umbc/research/magdak/.netrc
+ rm lares2_202403.np2
+ cat 'lares2_202403??.np2'
cat: lares2_202403??.np2: No such file or directory
+ cat lares2_202401.np2 lares2_202402.np2
+ cat lares2_202312.np2
+ cat lares2_202501.np2
cat: lares2_202501.np2: No such file or directory
+ cp year.M1 ../.
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp17794
+ sed 's/^H/h/g' year.M1
+ sed s/h9H1/h1/ year.M1A
+ grep -v -e h9 -e '^30' year.M1C
+ grep -v -e h9 -e '^30' year.00C
grep: year.00C: No such file or directory
+ cat year.M1B year.00B
+ sed 's/^C/c/' year.ALL2
+ grep '^h2' year.ALL
+ sort -u -o strng1
+ cut -c1-18
+ cp year.ALL crddata.2024240323.LARES2
+ printf h9
+ cat H9
+ FILE=crddata.2024240323.LARES2
+ gzip -9 -f crddata.2024240323.LARES2
+ rm ../crddata.2024240323.LARES2.gz
rm: cannot remove ‘../crddata.2024240323.LARES2.gz’: No such file or directory
+ cp crddata.2024240323.LARES2.gz ../crddata.2024240323.LARES2.gz
+ cp year.ALL0 year.ALL ../.
cp: cannot stat ‘year.ALL0’: No such file or directory
+ chmod 777 ../crddata.2024240323.LARES2.gz
+ cd ..
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ OLD_FILE=crddata.2024240322.LARES2
+ FLAG=NO
+ sum crddata.2024240323.LARES2.gz
+ sum crddata.2024240322.LARES2.gz
sum: crddata.2024240322.LARES2.gz: No such file or directory
+ read nbts nblks nfl
+ read obts oblks ofl
+ '[693' ']'
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/MLTSAT_2_TDF_ARC_CRD_EDC_P2_CRD2: line 212: : No such file or directory
+ echo ' OLD QL file: '
+ cat old_sum_mkc
+ echo '  '
  
+ echo ' NEW QL file: '
+ cat new_sum_mkc
+ rm 2mail
+ rm -r temp17794
+ export FLAG OLD_FILE
+ echo crddata.2024240323.LARES2
crddata.2024240323.LARES2
+ echo MLTSAT
MLTSAT
+ pwd
/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD
+ gzip -d -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES2.gz
+ sed -e 's/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 0 2 0/40 950 0 IDAA 0 0 0.000 167670.00 0.00 0.00 0.0 0.0 0.00 2 2 0/' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES2
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES2
+ rm //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ /umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/CRD2_2_MRT_X_221204.x -i //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES2 -o //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
Convert CRD Fullrate to Merit II Format: version 2.01b 12/23/2028
crd_in = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES2]
cstg_out = [//umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata]
+ '[' LARES2 = GISL1 ']'
+ '[' LARES2 = GISL2 ']'
+ '[' LARES2 = ETA1 ']'
+ '[' LARES2 = ETA2 ']'
+ '[' LARES2 = STARL ']'
+ '[' LARES2 = AJISI ']'
+ '[' LARES2 = LARES ']'
+ '[' LARES2 = LARES2 ']'
+ no=2208001
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES2.gz
gzip: /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.2024240323.LARES2.gz: No such file or directory
+ '[' MLTSAT = BLITS ']'
+ grep '^2208001' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/QLNP_2_TDFINP_CRD MLTSAT /umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ cp o.QLNP_2_TDFINP /tmp/magdak/o.QLNP_2_TDFINP_
+ sort -u //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/SORT_DATA_BY_RELEASE_FLAG_P2 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT

#     SORT_DATA_BY_RELEASE_FLAG


SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
+ SCR_NAME=SORT_DATA_BY_RELEASE_FLAG
SCR_PARM=2
+ SCR_PARM=2
SCR_LIST="disk"
+ SCR_LIST=disk
SCR_VERS=120711.0
+ SCR_VERS=120711.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi
expr $#
++ expr 2
+ '[' 2 -lt 2 ']'

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+ DateTime='DATE: 03/30/24  TIME: 13:47:43'

echo " # "
+ echo ' # '
 # 
echo " #  $SCR_NAME $* "
+ echo ' #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT '
 #  SORT_DATA_BY_RELEASE_FLAG /umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT 
echo " # "
+ echo ' # '
 # 
echo " #  Version $SCR_VERS "
+ echo ' #  Version 120711.0 '
 #  Version 120711.0 
echo " # "
+ echo ' # '
 # 
echo " #  Run Date $DateTime "
+ echo ' #  Run Date DATE: 03/30/24  TIME: 13:47:43 '
 #  Run Date DATE: 03/30/24  TIME: 13:47:43 
echo " # "
+ echo ' # '
 # 
disk=$1
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS
SAT_DIR=$2
+ SAT_DIR=MLTSAT
cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS TESTs
+ cp /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS TESTs
#cp $disk/$SAT_DIR/d_base/data/MRT2/crddata2SS $disk/$SAT_DIR/d_base/data/MRT2/ALL_q
#COLLECT in separately file different release data
grep '41$' TESTs > 41
+ grep '41$' TESTs
grep '42$' TESTs > 42
+ grep '42$' TESTs
grep '43$' TESTs > 43
+ grep '43$' TESTs
grep '44$' TESTs > 44
+ grep '44$' TESTs

#remove name of the file from files
sed -e "s/TESTs://" 41 > 41a
+ sed -e s/TESTs:// 41
sed -e "s/TESTs://" 42 > 42a
+ sed -e s/TESTs:// 42
sed -e "s/TESTs://" 43 > 43a
+ sed -e s/TESTs:// 43
sed -e "s/TESTs://" 44 > 44a
+ sed -e s/TESTs:// 44

#cut files column 1-43
cut -c1-43 41a > 41aa
+ cut -c1-43 41a
cut -c1-43 42a > 42aa
+ cut -c1-43 42a
cut -c1-43 43a > 43aa
+ cut -c1-43 43a
cut -c1-43 44a > 44aa
+ cut -c1-43 44a

sed -e "s/ /0/g"  41aa > 41b
+ sed -e 's/ /0/g' 41aa
sed -e "s/ /0/g"  42aa > 42b
+ sed -e 's/ /0/g' 42aa
sed -e "s/ /0/g"  43aa > 43b
+ sed -e 's/ /0/g' 43aa
sed -e "s/ /0/g"  44aa > 44b
+ sed -e 's/ /0/g' 44aa

rm 41c 42c 43c  41d 42d 41e 4?_0
+ rm 41c 42c 43c 41d 42d 41e '4?_0'
rm: cannot remove ‘4?_0’: No such file or directory
#Check that data  and keep data only the higher release flag

if [ -s 44b  ]
then
while read line4
do
grep -v $line4 41b > 41c
cp 41c 41b
grep -v $line4 42b > 42c
cp 42c 42b
grep -v $line4 43b > 43c
cp 43c 43b
grep  $line4 44a >> 44_0

done < 44b
else
cp 41b 41c
cp 42b 42c
cp 43b 43c
fi
+ '[' -s 44b ']'
+ cp 41b 41c
+ cp 42b 42c
+ cp 43b 43c
#exit 2
if [ -s 43c  ]
then
while read line3
do
grep -v $line3 41c > 41d
cp 41d 41c
grep -v $line3 42c > 42d
cp 42d 42c
grep  $line3 43a >> 43_0
done < 43c
else
cp 41c 41d
cp 42c 42d
fi
+ '[' -s 43c ']'
+ cp 41c 41d
+ cp 42c 42d

if [ -s 42d  ]
then
while read line2
do
grep -v $line2 41d > 41e
cp 41e 41d
grep  $line2 42a >> 42_0
done < 42d
else
cp 41d 41e
fi
+ '[' -s 42d ']'
+ cp 41d 41e

if [ -s 41e  ]
then
while read line1
do
grep  $line1 41a >> 41_0
done < 41e
fi
+ '[' -s 41e ']'

#Remove from data file data which has reles flag bigger than "0"
cat 4?_0 > TD
+ cat '4?_0'
cat: 4?_0: No such file or directory
cut -c1-43 TD > TDD
+ cut -c1-43 TD
sort -u TDD > TS
+ sort -u TDD

cp TESTs T0
+ cp TESTs T0
if [ -s TS  ]
then
while read line0
do
grep -v $line0 T0 > T1
cp T1  T0
done < TS
fi
+ '[' -s TS ']'

#Add to data file data with the higer release flag and sort by time

cat TD >> T0
+ cat TD
sort -k1,43 T0 > TSS
+ sort -k1,43 T0


cp TSS /$disk/$SAT_DIR/d_base/data/MRT2/crddata2SS
+ cp TSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS


exit 0
+ exit 0
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS
+ uniq -w43 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA
+ cp //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.LARES2.mr2
+ grep -v '\-10030' //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.LARES2.mr2
+ grep -v '\-1\-130' t10
+ cp t0 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.LARES2.mr2
+ rm -f //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2S //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SS //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSA //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata2SSS
+ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.LARES2.mr2
+ '[' LARES2 = GISL1 ']'
+ '[' LARES2 = GISL2 ']'
+ '[' LARES2 = ETA1 ']'
+ '[' LARES2 = ETA2 ']'
+ '[' LARES2 = CHAMP ']'
+ '[' LARES2 = ERS1 ']'
+ '[' LARES2 = AJISI ']'
+ '[' LARES2 = STARL ']'
+ '[' LARES2 = BLITS ']'
+ '[' LARES2 = LARES ']'
+ '[' LARES2 = LARES2 ']'
+ DSK=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
+ SV=LARES2
+ TAG=LARES2
+ FILEQL=qldata.2024240323.LARES2_24.tdf
+ export YY SV FILEQL SAT_DIR_S
+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.LARES2.mr2 crddata.2024240323.LARES2_24.tdf
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 1: !/bin/ksh: No such file or directory
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/TDF_2_GDNBIN_CRD_P2_MLTSAT_CRD2: line 4: #set: command not found

#  TDF_2_GDNBIN
#                                                               ecp       020318
#                                                               ecp       940310
#                                                               rob olson 950525
#
# Usage: TDF_2_GDNBIN data_format disk sat infile outfile [concar] 2> script_out &
#
# this shell script runs the TDF on various data formats.  if concar
# has ANY value (ie if there are 6 command line arguments), then
# this script ftp's the "CONOGBed" members listed in memlist from the
# IBM PDS given by infile, and first runs CONCAR on them
# before running the TDF.  otherwise, the
# location of infile on $disk depends on the data format selected.
# output from this script is netpushed to Unitree.
#
# NOTE:  1) the first command line argument is the GEODYN II
#           data format indicator
#        2) lines 161,177: if concar is to be run, verify path to memlist,
#           and note that the order of member names in memlist is the order
#           in which the files will be concatenated for concar input
#        3) line 225: use the polar motion tables you plan to use
#           when running GEODYN II
#        4) line 232: verify version of tdf executable
#        5) unit 90 output is placed in
#           /$disk/$sat/output/TDFout/$outfile
#        6) tdf binary output is placed in /$disk/$sat/d_base/data/TDF/$outfile
#  ecp   7) this new version allows for a "SAT" dependence in the dir path,
#           e.g. IGS92, IGS93, tp, lre, L1, etc.. It also picks the proper
#           "metric99" and "concarnm" control files depending on what
#           data format you specify with "data_format".
#        8) It seems that the "memlist" option has been disabled in this
#           version, but the member names are assumed to have the following
#           format depending again on the "data_format":
#               GPS (metric fmt) and PCE:  Dddd
#               Binary (e.g. SLR data) :   the entire name is specified in "doy"
#                                          the input in file "infile" of the
#                                          subtdf script.
#
#QSUB -s /bin/sh
#QSUB -r tdf_it!
#QSUB -q medium -eo
#QSUB -lM 15.0MW -lm 15.0MW
#QSUB -lT 2400 -lt 202395
#QSUB -A g926d
#QSUB -me

LOCALDSK=tmp
++ LOCALDSK=tmp

#
# interactive or batch ?
#
if [ $ENVIRONMENT ]; then
   if [ $ENVIRONMENT = "BATCH" ]; then
      if [ $wrapper ]; then
         read data_format disk sat infile outfile concar < /tmp/$USER/tdf.batch.$doy
      else
         read data_format disk sat infile outfile concar < $MAIN_PATH/INFILES/INF_OPS_D_CRD/tdf.batch
      fi
   else
      echo ENVIRONMENT = $ENVIRONMENT ?
      exit 99
   fi
else
 
SCR_NAME=TDF_2_GDNBIN
SCR_PARM=5
SCR_LIST="data_format disk sat infile outfile"
SCR_VERS=040220.0


if [ `expr $#` -lt $SCR_PARM ]; then
   echo "Usage: $SCR_NAME ${SCR_LIST}\007"
   exit 101
fi

DateTime=`date '+DATE: %m/%d/%y  TIME: %H:%M:%S'`

echo " # "
echo " #  $SCR_NAME $* "
echo " # "
echo " #  Version $SCR_VERS "
echo " # "
echo " #  Run Date $DateTime "
echo " # "

#  if [ `expr $#` -lt 5 -o `expr $#` -gt 6 ]; then
#     echo "Usage: tdf data_format disk sat infile outfile [concar] 2> script_out &\007"
#     exit 1
#  fi

   data_format=$1
   disk=$2
   sat=$3
   infile=$4
   outfile=$5
   concar=$6
fi
++ '[' ']'
++ SCR_NAME=TDF_2_GDNBIN
++ SCR_PARM=5
++ SCR_LIST='data_format disk sat infile outfile'
++ SCR_VERS=040220.0
expr $#
+++ expr 5
++ '[' 5 -lt 5 ']'
date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
+++ date '+DATE: %m/%d/%y  TIME: %H:%M:%S'
++ DateTime='DATE: 03/30/24  TIME: 13:47:44'
++ echo ' # '
 # 
++ echo ' #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.LARES2.mr2 crddata.2024240323.LARES2_24.tdf '
 #  TDF_2_GDNBIN 9 umbc/epavlis/data01/LOCAL/magdak/MISSIONS MLTSAT crddata.2024240323.LARES2.mr2 crddata.2024240323.LARES2_24.tdf 
++ echo ' # '
 # 
++ echo ' #  Version 040220.0 '
 #  Version 040220.0 
++ echo ' # '
 # 
++ echo ' #  Run Date DATE: 03/30/24  TIME: 13:47:44 '
 #  Run Date DATE: 03/30/24  TIME: 13:47:44 
++ echo ' # '
 # 
++ data_format=9
++ disk=umbc/epavlis/data01/LOCAL/magdak/MISSIONS
++ sat=MLTSAT
++ infile=crddata.2024240323.LARES2.mr2
++ outfile=crddata.2024240323.LARES2_24.tdf
++ concar=

dir=`dirname $outfile`
dirname $outfile
+++ dirname crddata.2024240323.LARES2_24.tdf
++ dir=.

#
# determine the data format to be used
#
case $data_format in
   0) unit=22 ;;       #  Geodyn Binary
   2) unit=24 ;;       #  MERIT II SLR data
   3) unit=26 ;;       #  GEOS-3 Card image - 80 byte fmt
   4) unit=28 ;;       #  Extended Geodyn Binary (Altimetry)
   5) unit=30 ;;       #  PCE
   6) unit=32 ;;       #  Extended GEOS-3 Card image - 120 byte fmt
   7) unit=34 ;;       #  GPS Metric type fmt
   8) unit=36 ;;       #  VLBI Binary fmt
  10) unit=38 ;;
   9) unit=24 ;; ### mkc???  Merit-X SLR Data from CRD reformatter
   *) echo "tdf: Invalid Data Format Indicator: use 0-10 !!\007"; exit 1 ;;
esac
++ case $data_format in
++ unit=24

if   [ "$data_format" = "7" ]; then

   tdfcards=metric99.mtr
   concarnm=concarnm.mtr
   files=$infile

elif [ "$data_format" = "5" ]; then

   tdfcards=metric99.pce
   files=D$doy

elif [ "$data_format" = "0" ]; then

   tdfcards=metric99.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "2" ]; then

   tdfcards=merit2.$YY
   concarnm=concarnm.bin
   files=$infile

elif [ "$data_format" = "9" ]; then

if [ "$SAT_DIR_S" = "ETA1" -o "$SAT_DIR_S" = "ETA2" ]; then
   tdfcards=merit9_E12.$YY
elif [ "$SAT_DIR_S" = "GISL1" -o "$SAT_DIR_S" = "GISL2" ]; then
   tdfcards=merit9_L12.$YY
elif [ "$SAT_DIR_S" = "LARES" -o "$SAT_DIR_S" = "STARL" -o "$SAT_DIR_S" = "AJISI" -o "$SAT_DIR_S" = "STELLA" ]; then
   tdfcards=merit9_AS.$YY
else
tdfcards=merit9.$YY
fi
 ### orginal independet fro any satellites  tdfcards=merit9.$YY
   concarnm=concarnm.bin
   files=$infile
fi
++ '[' 9 = 7 ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ '[' LARES2 = ETA1 -o LARES2 = ETA2 ']'
++ '[' LARES2 = GISL1 -o LARES2 = GISL2 ']'
++ '[' LARES2 = LARES -o LARES2 = STARL -o LARES2 = AJISI -o LARES2 = STELLA ']'
++ tdfcards=merit9.24
++ concarnm=concarnm.bin
++ files=crddata.2024240323.LARES2.mr2

#
# make sure you have everything you need
#
if [ ! -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current ]; then
   echo $MAIN_PATH/MISSIONS/d_base/tabs/iers.current doesn\'t exist !
   exit 99
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current ']'
if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ]; then
   echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards doesn\'t exist !
   exit 98
fi
++ '[' '!' -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9.24 ']'
if [ $concar ]; then

   if [ ! -f $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ]; then
      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm doesn\'t exist !
      exit 97
   fi


#   if [ ! -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist ]; then
#      echo $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist doesn\'t exist !
#      exit 96
#   fi

elif [ "$data_format" = "7" -a ! -s /$disk/$sat/d_base/data/tdfphase.$infile.Z ]; then
   echo /$disk/$sat/d_base/data/tdfphase.$infile.Z doesn\'t exist !
   exit 99
fi
++ '[' ']'
++ '[' 9 = 7 -a '!' -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/tdfphase.crddata.2024240323.LARES2.mr2.Z ']'

###if [ ! -d /$disk/$sat ]; then
###   mkdir /$disk/$sat
###fi
###
###if [ ! -d /$disk/$sat/d_base ]; then
###   mkdir /$disk/$sat/d_base
###fi
###
###if [ ! -d /$disk/$sat/d_base/data ]; the/\$MAIN_PATH/$MAIN_PATH
###   mkdir /$disk/$sat/d_base/data
###fi
###
###if [ ! -d /$disk/$sat/d_base/data/TDF ]; then
###   mkdir /$disk/$sat/d_base/data/TDF
###fi
###
###if [ ! -d /$disk/$sat/output/TDFout ]; then
###   mkdir /$disk/$sat/output/TDFout
###fi
###
###if [ "$dir" != "." ]; then
###   if [ ! -d /$disk/$sat/d_base/data/$dir ]; then
###      mkdir /$disk/$sat/d_base/data/$dir
###   fi
###fi

mkdir /$LOCALDSK/tdf$$
++ mkdir /tmp/tdf22851
cd /$LOCALDSK/tdf$$
++ cd /tmp/tdf22851

if [ $concar ]; then

   #
   # netpull the CONOGBed files from gibbs
   #
   files=`awk '{printf("%s "),$1 }' $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist `

ftp gibbs << EOF!!
prompt
case
ascii
cd \'$infile\'
mget $files
EOF!!

   #
   # cat the files in the order specified in memlist.  if only
   # one file, just link to it
   #
   numfiles=`wc -l $MAIN_PATH/INFILES/INF_OPS_D_CRD/memlist | awk ' {print $1} ' `
   if [ "$numfiles" = "1" ]; then
      ln -s /tmp/tdf$$/$files ftn10
   else
      cat $files > ftn10
   fi

   #
   # get concar control card and run it
   #
   ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$concarnm ftn04
   echo "***"
   echo "***           RUN CONCAR"
   echo "***"
   /space/users/epavlis/EXECUTABLES/concar 1>tmpcon6 2>tmpcone
   \rm ftn10 ftn04
fi
++ '[' ']'
#
#  get tdf supporting data files and run it
#
if [ $concar ]; then
   if [ -s ftn11 ]; then               # use concar output if run
      mv ftn11 fort.$unit
   else
      echo CONCAR TERMINATED ABNORMALLY - EXITING
      exit 95
   fi
elif [ "$data_format" = "5" ]; then   # cat together PCE data
   count=1
   while [ $count -le 32 ]
   do
      prn=$count
      if [ $count -lt 10 ]; then
         prn=0$count
      fi
      if [ -f /$disk/$sat/PCEC/PRN${prn}/$infile.Z ]; then
         zcat /$disk/$sat/PCEC/PRN${prn}/$infile.Z >> fort.$unit
      fi
      count=`expr $count + 1`
   done
#
elif [ "$data_format" = "7" ]; then   # cp Metric data

   zcat /$disk/$sat/d_base/data/tdfphase.$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "0" ]; then   # Binary data   (e.g. SLR)

   zcat /$disk/$sat/d_base/data/G2B/$infile.Z > fort.$unit  # USE THIS ONE EXCEPT FOR EP

elif [ "$data_format" = "2" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!

elif [ "$data_format" = "9" ]; then   # MERIT II data   (SLR)

   zcat /$disk/$sat/d_base/data/MRT2/$infile.gz > fort.$unit  # USE THIS ONE FOR SLR ONLY!
fi
++ '[' ']'
++ '[' 9 = 5 ']'
++ '[' 9 = 7 ']'
++ '[' 9 = 0 ']'
++ '[' 9 = 2 ']'
++ '[' 9 = 9 ']'
++ zcat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.2024240323.LARES2.mr2.gz

ln -s $MAIN_PATH/MISSIONS/d_base/tabs/iers.current     fort.2
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current fort.2
#
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/$tdfcards ftn05
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9.24 ftn05
ln -s $MAIN_PATH/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF
++ ln -s /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF FILIST.DF

echo "***"
++ echo '***'
***
echo "***           RUN TDF"
++ echo '***           RUN TDF'
***           RUN TDF
echo "***"
++ echo '***'
***
#exit 20181220

#NEW TDF for CRD_2_MERIT long np data
#/umbc/epavlis/data01/LOCAL/magdak/EXECUTABLES/${TDF2GDN} 1>tmptdf6 2>tmptdfe
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
#TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST_100525.x
TDF2GDYN=tdf1006p0_i64_gFORT.x
++ TDF2GDYN=tdf1006p0_i64_gFORT.x
TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
++ TDF2GDYN=tdf0901p0_i64.sun_CRD_TEST.x
TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
++ TDF2GDYN=tdf1006p0_i64_gfort_mkc.x
TDF2GDYN=tdf1006p1_i64.x
++ TDF2GDYN=tdf1006p1_i64.x
TDF2GDYN=tdf1006p2_i64M_180927.x  ## for P2 version
++ TDF2GDYN=tdf1006p2_i64M_180927.x
#/umbc/research/epavlis/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
#
#$MAIN_PATH/EXECUTABLES/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
/umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/${TDF2GDYN} 1>tmptdf6 2>tmptdfe
++ /umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdf1006p2_i64M_180927.x




echo
++ echo

echo
++ echo


ls -al
++ ls -al
total 3848
drwxrwxr-x    2 magdak research    4096 Mar 30 13:47 .
drwxrwxrwt. 136 root   root       28672 Mar 30 13:47 ..
lrwxrwxrwx    1 magdak research      65 Mar 30 13:47 FILIST.DF -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/FILIST.DF
lrwxrwxrwx    1 magdak research      67 Mar 30 13:47 fort.2 -> /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/d_base/tabs/iers.current
-rw-rw-r--    1 magdak research 1672000 Mar 30 13:47 fort.24
-rw-rw-r--    1 magdak research 2002000 Mar 30 13:47 fort.41
-rw-rw-r--    1 magdak research  207270 Mar 30 13:47 fort.90
lrwxrwxrwx    1 magdak research      65 Mar 30 13:47 ftn05 -> /umbc/epavlis/data01/LOCAL/magdak/INFILES/INF_OPS_D_CRD/merit9.24
-rw-rw-r--    1 magdak research    1732 Mar 30 13:47 tmptdf6
-rw-rw-r--    1 magdak research       0 Mar 30 13:47 tmptdfe
pwd
++ pwd
/tmp/tdf22851


#
# append fort.90 tdf output to unit 5 output
#
#exit 20180920
cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90 > /$disk/$sat/output/TDFout/$outfile
++ cat tmpcon6 tmpcone tmptdf6 tmptdfe fort.90
cat: tmpcon6: No such file or directory
cat: tmpcone: No such file or directory
chmod 777 /$disk/$sat/output/TDFout/$outfile
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.LARES2_24.tdf
#rm -f $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${outfile}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "${FILEQL}\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
#printf "qldata.2012120501.${sat}_12.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
######printf "${SV}_${YY}.tdf\n" >> $MAIN_PATH/INFILES/TDFMERGER/${SV}_CRD
gzip -9 -f /$disk/$sat/output/TDFout/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.2024240323.LARES2_24.tdf

#
# move tdf output to $disk and Unitree
#

mv fort.41 /$disk/$sat/d_base/data/TDF/${outfile}
++ mv fort.41 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.LARES2_24.tdf
chmod 777 /$disk/$sat/d_base/data/TDF/${outfile}
++ chmod 777 /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.LARES2_24.tdf
gzip -9  -f /$disk/$sat/d_base/data/TDF/$outfile
++ gzip -9 -f /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.LARES2_24.tdf

#markd because was conflict with link for qldata-merit data
#cd /$disk/$sat/d_base/data/MRT2/
#rm ${YY}.${sat}.mr2.Z
#ln -s $infile.Z  ${sat}_${YY}.mrt2.Z
#ln -s $infile.Z  ${YY}.${sat}.mr2.Z
#chmod 777 ${YY}.${sat}.mr2.Z

cd /$disk/$sat/d_base/data/TDF
++ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF

#gzip -S .Z -f $outfile

#if [ "$data_format" = "0" -o "$data_format" = "2" -o "$data_format" = "9"  ]; then

echo $SV $YY
++ echo LARES2 24
LARES2 24
Date=`date +%y%m%d`
date +%y%m%d
+++ date +%y%m%d
++ Date=240330

####to be changed
#rm ${SV}_$YY.tdf_crd.Z
#rm ${SV}_$YY.tdf.Z
#ln -s $outfile.Z ${SV}_$YY.tdf_crd.Z
#ln -s $outfile.Z ${SV}_$YY.tdf.Z
#chmod 777 ${SV}_$YY.tdf_crd.Z

#fi


cd ..
++ cd ..
\rm -r /$LOCALDSK/tdf$$
++ rm -r /tmp/tdf22851
+ read sat SAT_DIR_S
#exit 200214
#> o.L1_${YY}_CRD_P2  2>&1
cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/
+ cd /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/
ls -1 crddata.${NEW_ARC}.*.tdf.gz > TDF_LIST0
+ ls -1 crddata.2024240323.AJISI_24.tdf.gz crddata.2024240323.ETA1_24.tdf.gz crddata.2024240323.ETA2_24.tdf.gz crddata.2024240323.GISL1_24.tdf.gz crddata.2024240323.GISL2_24.tdf.gz crddata.2024240323.LARES2_24.tdf.gz crddata.2024240323.LARES_24.tdf.gz crddata.2024240323.STARL_24.tdf.gz crddata.2024240323.STELLA_24.tdf.gz
+ 1> TDF_LIST0
sed -e "s/.gz//" TDF_LIST0 > TDF_LIST
+ sed -e s/.gz// TDF_LIST0
+ 1> TDF_LIST
$SCRIPTS/tdfmerger_MLTSAT_CRD2 $YY MLTSAT


+ /umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/tdfmerger_MLTSAT_CRD2 24 MLTSAT

#  infile=$1
#  outfile=$2
 YY=$1
+ YY=24
 SSAT=$2
+ SSAT=MLTSAT
MAIN_PATH=/umbc/epavlis/data01/LOCAL/magdak
+ MAIN_PATH=/umbc/epavlis/data01/LOCAL/magdak
  disk=$MAIN_PATH/MISSIONS/$SSAT
+ disk=/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT
Date=`date +%y%m%d`
date +%y%m%d
++ date +%y%m%d
+ Date=240330

mkdir /$disk/d_base/data/TDF/mrg$$
+ mkdir //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/mrg22875
cd /$disk/d_base/data/TDF/mrg$$
+ cd //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/mrg22875
cp $disk/d_base/data/TDF/TDF_LIST tdfmrg.in
+ cp /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/TDF_LIST tdfmrg.in



while read file
do

#cp /$disk/d_base/data/TDF/$file /$disk/d_base/data/TDF/mrg$$/$file
zcat /$disk/d_base/data/TDF/${file}.gz > /$disk/d_base/data/TDF/mrg$$/$file

done <tdfmrg.in
+ read file
+ zcat //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.AJISI_24.tdf.gz
+ read file
+ zcat //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.ETA1_24.tdf.gz
+ read file
+ zcat //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.ETA2_24.tdf.gz
+ read file
+ zcat //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.GISL1_24.tdf.gz
+ read file
+ zcat //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.GISL2_24.tdf.gz
+ read file
+ zcat //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.LARES2_24.tdf.gz
+ read file
+ zcat //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.LARES_24.tdf.gz
+ read file
+ zcat //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.STARL_24.tdf.gz
+ read file
+ zcat //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.2024240323.STELLA_24.tdf.gz
+ read file

#exit 00
echo "***"
+ echo '***'
***
echo "***           RUN merger"
+ echo '***           RUN merger'
***           RUN merger
echo "***"
+ echo '***'
***




#$MAIN_PATH/EXECUTABLES/tdfmerger.x
/umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdfmerger.x
+ /umbc/research/epavlis/EXECUTABLES/PE2_EXECi64/tdfmerger.x

#exit 2012
#
ls -la
+ ls -la
total 26152
drwxrwxr-x 2 magdak  research     4096 Mar 30 13:47 .
drwxrwxrwx 3 epavlis research   110592 Mar 30 13:47 ..
-rw-rw-r-- 1 magdak  research    16016 Mar 30 13:47 crddata.2024240323.AJISI_24.tdf
-rw-rw-r-- 1 magdak  research   304304 Mar 30 13:47 crddata.2024240323.ETA1_24.tdf
-rw-rw-r-- 1 magdak  research   304304 Mar 30 13:47 crddata.2024240323.ETA2_24.tdf
-rw-rw-r-- 1 magdak  research    16016 Mar 30 13:47 crddata.2024240323.GISL1_24.tdf
-rw-rw-r-- 1 magdak  research  2050048 Mar 30 13:47 crddata.2024240323.GISL2_24.tdf
-rw-rw-r-- 1 magdak  research  2002000 Mar 30 13:47 crddata.2024240323.LARES2_24.tdf
-rw-rw-r-- 1 magdak  research  2914912 Mar 30 13:47 crddata.2024240323.LARES_24.tdf
-rw-rw-r-- 1 magdak  research  3795792 Mar 30 13:47 crddata.2024240323.STARL_24.tdf
-rw-rw-r-- 1 magdak  research  1937936 Mar 30 13:47 crddata.2024240323.STELLA_24.tdf
-rw-rw-r-- 1 magdak  research      288 Mar 30 13:47 tdfmrg.in
-rw-rw-r-- 1 magdak  research     1010 Mar 30 13:47 tdfmrg.ou6
-rw-rw-r-- 1 magdak  research 13261248 Mar 30 13:47 tdfmrg.out

#mv tdfmrg.ou6 tdfmrg.$Date    
#
mv tdfmrg.out /$disk/d_base/data/TDF/MLTSAT_${YY}.tdf
+ mv tdfmrg.out //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/MLTSAT_24.tdf
mv tdfmrg.ou6 /$disk/d_base/data/TDF/MLTSAT_output_$YY
+ mv tdfmrg.ou6 //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/MLTSAT_output_24
gzip -9  -f /$disk/d_base/data/TDF/MLTSAT_${YY}.tdf
+ gzip -9 -f //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/MLTSAT_24.tdf
#rm -f  ${sat}_${YY}.tdf.Z
#ln -s   crd+qc_data.$YY.$sat  L1_12.tdf.Z

#ln -s ql_crd_data.$NEW_ARC.$sat.Z  ${sat}_${YY}_QL_CRD.tdf.Z
#ln -s ql_crd_data.$NEW_ARC.$sat.Z  ${sat}_${YY}.tdf.Z


cd ..
+ cd ..
\rm -r /$disk/d_base/data/TDF/mrg$$
+ rm -r //umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/mrg22875
while read file
do
rm /$disk/d_base/data/TDF/${file}.gz
done <tdfmrg.in
/umbc/epavlis/data01/LOCAL/magdak/scripts/OPS_DATA_CRD/MLTSAT/tdfmerger_MLTSAT_CRD2: line 64: tdfmrg.in: No such file or directory


exit 0
+ exit 0
\rm /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.${Date_NEW_ARC}.*
+ rm '/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.240323.*'
rm: cannot remove ‘/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.240323.*’: No such file or directory
\rm /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MTR2/crddata.${Date_NEW_ARC}.*.mr2.gz
+ rm '/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MTR2/crddata.240323.*.mr2.gz'
rm: cannot remove ‘/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MTR2/crddata.240323.*.mr2.gz’: No such file or directory
\rm /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.${Date_NEW_ARC}.*.tdf.gz

+ rm '/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.240323.*.tdf.gz'
rm: cannot remove ‘/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.240323.*.tdf.gz’: No such file or directory
cat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/MLTSAT_output_$YY > MAIL1
+ cat /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/MLTSAT_output_24
+ 1> MAIL1
mailx -s "MLTSAT DATA DONE PERSEUS2 EDC"  magdak@umbc.edu < MAIL1
+ mailx -s 'MLTSAT DATA DONE PERSEUS2 EDC' magdak@umbc.edu
+ 0< MAIL1
#mailx -s "MLTSAT DATA DONE PERSEUS2 EDC"  epavlis@umbc.edu < MAIL1

cd /tmp/
+ cd /tmp/
\rm -r getSLR$$

+ rm -r getSLR17778
  \rm -r /tmp/getSLR*
+ rm -r '/tmp/getSLR*'
rm: cannot remove ‘/tmp/getSLR*’: No such file or directory
rm -rf /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp*


+ rm -rf '/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/temp*'
 OLD_ARC=${OYEAR}${Date_OLD_ARC}
+ OLD_ARC=2024240322
  NEXT_DATE=$(date +%y%m%d -d "$Date_OLD_ARC - 2 day")
+ date +%y%m%d -d '240322 - 2 day'
+ NEXT_DATE=240320
  L_DATE=$(date +%m%d -d "$Date_OLD_ARC - 2 day")
+ date +%m%d -d '240322 - 2 day'
+ L_DATE=0320
 if [ "$L_DATE" -ne "1231" ]; then
rm  /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.*${NEXT_DATE}*${YEARC}.tdf_${CENTER}.gz 
rm  /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.*${NEXT_DATE}.tdf_${CENTER}.gz 
rm  /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.*${NEXT_DATE}.tdf_${CENTER}.gz 
rm  /umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.*${NEXT_DATE}.tdf_${CENTER}.gz 
fi

+ [ 0320 -ne 1231 ]
+ rm '/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.*240320*.tdf_.gz'
rm: cannot remove ‘/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/output/TDFout/crddata.*240320*.tdf_.gz’: No such file or directory
+ rm '/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.*240320.tdf_.gz'
rm: cannot remove ‘/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/TDF/crddata.*240320.tdf_.gz’: No such file or directory
+ rm '/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.*240320.tdf_.gz'
rm: cannot remove ‘/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/CRD/crddata.*240320.tdf_.gz’: No such file or directory
+ rm '/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.*240320.tdf_.gz'
rm: cannot remove ‘/umbc/epavlis/data01/LOCAL/magdak/MISSIONS/MLTSAT/d_base/data/MRT2/crddata.*240320.tdf_.gz’: No such file or directory
exit 0
+ exit 0
